(self.webpackChunkyoroi=self.webpackChunkyoroi||[]).push([[9147],{18718:(e,t,o)=>{"use strict";o.d(t,{r:()=>d});var n,l,r,a,i,s=o(67294);function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},c.apply(this,arguments)}function d(e){return s.createElement("svg",c({width:128,height:168,viewBox:"0 0 128 168",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=s.createElement("path",{d:"M116.023 1.513l7.551 4.102-5.252 7.501.249 68.963c.031 8.886-5.61 19.231-12.623 23.104l-46.821 25.889c-.22 1.907-.505 3.988-.868 6.256a32.764 32.764 0 01-2.08 7.316L58.367 143l-2.089 8.886-9.506 15.758-7.862-4.443a2.168 2.168 0 01-.483-.266c-.837-.575-1.086-1.657-.577-2.511a30.496 30.496 0 002.72-6.805c.91-3.13-1.004-7.765-2.6-10.849l-17.05 9.427-6.786 9.694-8.642-4.295c-3.147-1.207-5.236-4.762-5.236-10.093L0 75.97c-.031-8.886 5.61-19.23 12.623-23.104l92.959-51.398c2.626-1.459 5.072-1.792 7.106-1.17a20.43 20.43 0 013.335 1.215z",fill:"url(#tx-submitted_inline_svg__paint0_linear_1736_20356)"})),l||(l=s.createElement("path",{opacity:.8,d:"M127.743 15.197c0-8.885-5.735-12.958-12.732-9.085l-92.96 51.405C15.04 61.39 9.399 71.735 9.43 80.621l.257 71.525c0 8.886 5.735 12.959 12.732 9.086l28.714-15.876c.776 4.486.22 9.089-1.605 13.292a80.633 80.633 0 01-3.398 6.435c-.45.79-.282 1.769.408 2.383.69.614 1.73.709 2.53.231 6.7-4.147 16.036-12.152 18.147-25.318.374-2.333.663-4.443.88-6.406l47.283-26.147c7.013-3.873 12.654-14.217 12.623-23.103l-.257-71.525z",fill:"#52FCFF"})),r||(r=s.createElement("path",{d:"M72.177 52.903C53.947 63.346 39.17 85.776 39.17 103s14.778 22.722 33.008 12.278c18.23-10.444 33.008-32.874 33.008-50.099 0-17.224-14.778-22.722-33.008-12.277z",fill:"url(#tx-submitted_inline_svg__paint1_linear_1736_20356)"})),a||(a=s.createElement("path",{d:"M69.19 100.106l-8.627-6.216c-1.018-.734-1.16-2.362-.45-3.685.745-1.39 2.246-2.041 3.368-1.232l6.534 4.708 13.584-29.056c.667-1.422 2.113-2.193 3.294-1.52 1.105.627 1.352 2.232.709 3.608L72.65 98.69c-.32.687-.834 1.244-1.417 1.526l-.058.028c-.677.314-1.414.273-1.985-.139z",fill:"#fff"})),i||(i=s.createElement("defs",null,s.createElement("linearGradient",{id:"tx-submitted_inline_svg__paint0_linear_1736_20356",x1:0,y1:167.645,x2:123.574,y2:167.645,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#17D1AA"}),s.createElement("stop",{offset:.15,stopColor:"#1ACBAF"}),s.createElement("stop",{offset:.37,stopColor:"#21B8BC"}),s.createElement("stop",{offset:.62,stopColor:"#2E9BD3"}),s.createElement("stop",{offset:.89,stopColor:"#3F71F1"}),s.createElement("stop",{offset:1,stopColor:"#475FFF"})),s.createElement("linearGradient",{id:"tx-submitted_inline_svg__paint1_linear_1736_20356",x1:109.445,y1:129.583,x2:109.445,y2:47.227,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#1D45BA"}),s.createElement("stop",{offset:.42,stopColor:"#1D47BA"}),s.createElement("stop",{offset:.572,stopColor:"#1D4EB9"}),s.createElement("stop",{offset:.68,stopColor:"#1C59B8"}),s.createElement("stop",{offset:.767,stopColor:"#1B6AB6"}),s.createElement("stop",{offset:.842,stopColor:"#1A80B3"}),s.createElement("stop",{offset:.908,stopColor:"#199CB0"}),s.createElement("stop",{offset:.966,stopColor:"#18BBAD"}),s.createElement("stop",{offset:1,stopColor:"#17D1AA"})))))}o.p},49147:(e,t,o)=>{"use strict";o.r(t),o.d(t,{LIMIT_PRICE_WARNING_THRESHOLD:()=>Ct,PRICE_IMPACT_HIGH_RISK:()=>wt,PRICE_IMPACT_MODERATE_RISK:()=>_t,default:()=>kt});var n=o(59340),l=o.n(n),r=o(99226),a=o(23972),i=o(31041),s=o(67294),c=o(89560),d=o(71928),p=o(6951),u=o(65116),x=o(9074),m=o(26439),f=o(48521);function g({slippageValue:e,walletAddress:t,priceImpactState:o,onRemoteOrderDataResolved:n,defaultTokenInfo:l,getTokenInfo:g,onError:h}){const{orderData:y}=(0,i.ZD)(),{selectedPoolCalculation:{pool:v}}=y,{sellTokenInfo:j,buyTokenInfo:b,sellQuantity:_,buyQuantity:w}=(0,c.LL)(),{formattedFeeQuantity:C}=(0,d.n)(l),k="market"===y.type,I=(0,x.E)(),{createOrderData:Z}=(0,i.WC)({onSuccess:e=>{n(e).catch((e=>{console.error("Failed to handle remote order resolution",e),h()}))},onError:e=>{console.error("useSwapCreateOrder fail",e),h()}});return(0,s.useEffect)((()=>{var e;p.ampli.swapOrderSelected({...(0,u.th)(j,b),from_amount:_.displayValue,to_amount:w.displayValue,order_type:y.type,pool_source:null==v?void 0:v.provider,slippage_tolerance:y.slippage,swap_fees:Number(C)}),null!=t?Z((k?i.vp:i.lN)(y.amounts.sell,y.amounts.buy,null===(e=y.selectedPoolCalculation)||void 0===e?void 0:e.pool,y.slippage,t)):alert("Wallet address is not available")}),[]),(0,f.jsxs)(r.Z,{width:"100%",mx:"auto",maxWidth:"506px",display:"flex",flexDirection:"column",gap:"24px",children:[(0,f.jsx)(r.Z,{textAlign:"center",children:(0,f.jsx)(a.Z,{component:"div",variant:"h4",fontWeight:500,color:"ds.text_gray_medium",children:I.confirmSwapTx})}),(0,f.jsx)(m.g,{defaultTokenInfo:l,getTokenInfo:g,priceImpactState:o,slippageValue:e})]})}var h,y,v,j,b,_,w=o(69397);function C(){return C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},C.apply(this,arguments)}function k(e){return s.createElement("svg",C({width:255,height:192,viewBox:"0 0 255 192",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),h||(h=s.createElement("g",{opacity:.2,stroke:"#1D45BA",strokeWidth:.5},s.createElement("path",{d:"M87.232 189.069l166.891-94.883M23.813 141.794l155.683-88.51M77.55 41.94l175.808 99.825M1.357 106.959l147.372 83.68"}))),y||(y=s.createElement("path",{d:"M111.099 101.702c2.367-15.602 0-19.194 0-19.194l-15.53 20.839s4.154 6.669 3.12 10.42a23.34 23.34 0 01-1.907 5.039 1.428 1.428 0 00.404 1.859c.104.081.218.147.34.198l5.515 3.29 6.669-11.67 1.465-6.58-1.536 1.217a25.335 25.335 0 001.46-5.418z",fill:"url(#tx-failure_inline_svg__paint0_linear_6993_206264)"})),v||(v=s.createElement("path",{d:"M156.92 4.158l-5.297-3.038a13.847 13.847 0 00-2.339-.9c-1.427-.46-3.144-.213-4.986.867L79.082 39.152c-4.92 2.868-8.877 10.529-8.855 17.11l.18 52.975c0 3.948 1.465 6.581 3.674 7.474l6.062 3.181 4.761-7.178 59.651-34.818c4.92-2.868 8.878-10.53 8.856-17.11l-.175-51.072 3.684-5.556z",fill:"url(#tx-failure_inline_svg__paint1_linear_6993_206264)"})),j||(j=s.createElement("path",{d:"M159.846 11.255c0-6.58-4.024-9.597-8.933-6.729l-65.215 38.07c-4.92 2.868-8.878 10.53-8.856 17.11l.18 52.97c0 6.58 4.024 9.597 8.933 6.729l20.144-11.758a18.15 18.15 0 01-1.126 9.844 60.872 60.872 0 01-2.384 4.765 1.467 1.467 0 00.287 1.765 1.455 1.455 0 001.774.171c4.701-3.071 11.25-8.999 12.732-18.75.262-1.727.464-3.29.617-4.743l33.171-19.364c4.92-2.868 8.878-10.53 8.856-17.11l-.18-52.97z",fill:"#E1F2FF"})),b||(b=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M109.06 69.544c.222.102.334.321.334.66 0 .336-.112.69-.334 1.062-.223.37-.502.666-.837.884-.332.22-.623.296-.868.232l-4.379-1.556-4.38 7.286c-.245.385-.524.68-.837.884-.311.204-.588.274-.833.21-.247-.065-.37-.266-.37-.603 0-.338.123-.71.37-1.119l4.345-7.264-4.345-1.578c-.247-.087-.37-.3-.37-.637s.123-.698.37-1.083c.245-.385.522-.681.833-.886.313-.204.592-.273.837-.208l4.38 1.556 4.379-7.288c.245-.385.536-.686.868-.905.335-.22.614-.289.837-.209.222.078.334.287.334.625 0 .337-.112.703-.334 1.095l-4.381 7.286 4.381 1.556zM147.491 45.236c.223.102.336.321.336.659 0 .337-.113.692-.336 1.063-.22.37-.5.665-.834.884-.335.218-.625.296-.87.23l-4.379-1.556-4.379 7.288c-.245.385-.525.68-.837.884-.311.204-.59.273-.835.209-.246-.065-.369-.266-.369-.604 0-.337.123-.71.369-1.117l4.346-7.264-4.346-1.578c-.246-.087-.369-.3-.369-.637s.123-.7.369-1.085c.245-.385.524-.68.835-.884.312-.204.592-.274.837-.21l4.379 1.556 4.379-7.286a2.96 2.96 0 01.87-.907c.334-.218.614-.288.834-.208.223.078.336.287.336.624 0 .338-.113.703-.336 1.097l-4.379 7.287 4.379 1.556zM119.052 78.853c0 2.676 2.143 3.508 4.785 1.86 2.643-1.65 4.786-5.154 4.786-7.83s-2.143-3.508-4.786-1.86c-2.642 1.649-4.785 5.155-4.785 7.83z",fill:"#FF1351"})),_||(_=s.createElement("defs",null,s.createElement("linearGradient",{id:"tx-failure_inline_svg__paint0_linear_6993_206264",x1:95.569,y1:124.151,x2:112.15,y2:124.151,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#3154CA"}),s.createElement("stop",{offset:1,stopColor:"#17D1AA"})),s.createElement("linearGradient",{id:"tx-failure_inline_svg__paint1_linear_6993_206264",x1:70.226,y1:119.891,x2:156.92,y2:119.891,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#3154CA"}),s.createElement("stop",{offset:1,stopColor:"#17D1AA"})))))}o.p;var I=o(18718);function Z({txSubmitErrorState:e,onTryAgain:t,onSuccess:o,onDownloadLogs:n}){const l=(0,x.E)(),i=null==e.value;return(0,f.jsxs)(r.Z,{display:"flex",flexDirection:"column",gap:"16px",alignItems:"center",width:"404px",mx:"auto",mt:"131px",children:[(0,f.jsx)(r.Z,{children:i?(0,f.jsx)(I.r,{}):(0,f.jsx)(k,{})}),(0,f.jsxs)(r.Z,{textAlign:"center",children:[(0,f.jsx)(a.Z,{component:"div",variant:"h3",fontWeight:500,mb:"4px",color:"ds.text_gray_medium",children:i?l.txSubmitted:l.txFailed}),(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:i?l.checkTx:l.txNotProcessed})]}),(0,f.jsx)(r.Z,{children:(0,f.jsx)(w.Z,{onClick:i?o:t,variant:"primary",children:i?l.goToTxs:l.tryAgain})}),!i&&(0,f.jsx)(r.Z,{children:(0,f.jsx)(w.Z,{variant:"tertiary",color:"primary",onClick:n,children:l.downloadLogFile})})]})}var T=o(54048),S=o(36094),E=o(78280);function A({onContinue:e,onCancel:t}){var o,n;const{orderData:l}=(0,i.ZD)(),s=null!==(o=null===(n=l.selectedPoolCalculation)||void 0===n?void 0:n.order.limitPrice)&&void 0!==o?o:"0",c=(0,x.E)();return(0,f.jsxs)(S.ZP,{title:c.limitPrice,onClose:t,withCloseButton:!0,closeOnOverlayClick:!0,children:[(0,f.jsxs)(r.Z,{display:"flex",maxWidth:"648px",mt:"8px",mb:"24px",flexDirection:"column",gap:"24px",children:[(0,f.jsx)(r.Z,{children:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:c.limitPriceContent})}),(0,f.jsxs)(r.Z,{display:"flex",flexDirection:"column",gap:"16px",children:[(0,f.jsx)(L,{col1:c.yourLimitPrice,children:(0,f.jsx)(E.Z6,{price:null!=s?s:"0"})}),(0,f.jsx)(L,{col1:c.marketPrice,children:(0,f.jsx)(E.Fs,{})})]})]}),(0,f.jsxs)(r.Z,{maxWidth:"648px",display:"flex",gap:"24px",pt:"24px",children:[(0,f.jsx)(w.Z,{fullWidth:!0,variant:"secondary",onClick:t,children:c.back}),(0,f.jsx)(w.Z,{fullWidth:!0,variant:"primary",onClick:e,children:c.swap})]})]})}const L=({col1:e,children:t,withInfo:o=!1})=>(0,f.jsxs)(r.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,f.jsxs)(r.Z,{display:"flex",alignItems:"center",children:[(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"grayscale.500",children:e}),o?(0,f.jsx)(r.Z,{ml:"8px",children:(0,f.jsx)(T.r,{})}):null]}),(0,f.jsx)(r.Z,{children:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:t})})]});var D=o(905),O=o(2991),P=o.n(O),F=o(20847),B=o(19809),R=o(71653);function M({onDialogConfirm:e,onDialogRefuse:t}){var o;const[n,l]=(0,s.useState)(!1),i=(0,x.E)(),c=[{onClick:e,disabled:!n,primary:!0,label:i.disclaimerProceed}];return(0,f.jsx)(S.ZP,{title:i.disclaimerTitle,onClose:t,closeButton:(0,f.jsx)(R.Z,{onClose:t}),styleContentOverride:{paddingTop:"0px"},styleOverride:{maxWidth:"648px"},dialogActions:c,children:(0,f.jsxs)(r.Z,{display:"flex",maxWidth:"648px",flexDirection:"column",gap:"24px",children:[(0,f.jsx)(r.Z,{children:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"grayscale.900",align:"justify",children:i.disclaimerDescription})}),(0,f.jsxs)(r.Z,{children:[(0,f.jsx)(a.Z,{component:"div",fontWeight:500,variant:"body1",color:"grayscale.900",align:"justify",children:i.pleaseNote}),(0,f.jsx)(r.Z,{sx:{display:"flex",alignItems:"center",flexFlow:"column"},children:P()(o=[i.note1,i.note2,i.note3,i.note4]).call(o,((e,t)=>(0,f.jsxs)(r.Z,{sx:{display:"flex",flexFlow:"row nowrap",alignItems:"flex-start",justifyContent:"flex-start"},children:[(0,f.jsxs)(a.Z,{component:"div",variant:"body1",color:"grayscale.900",children:[t+1,". "]}),(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"grayscale.900",children:e})]})))})]}),(0,f.jsx)(F.Z,{label:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"grayscale.900",children:i.swapDisclamerCheckbox}),control:(0,f.jsx)(B.Z,{onChange:()=>l(!n),checked:n,sx:{marginRight:"8px"}}),sx:{margin:"0px"}})]})})}var V=o(69051),W=o(47867),N=o(41796);function z(e){return(0,f.jsx)(W.Z,{open:!0,onClose:()=>{},sx:{bgcolor:(0,N.Fq)("#121F4D",.7),display:"flex",justifyContent:"center",alignItems:"center"},id:"loadingOverlay",children:(0,f.jsx)(S.F0,{empty:!0,display:"flex",flexDirection:"column",className:"loadingOverlay",boxShadow:"0px 13px 20px -1px #00000026",children:(0,f.jsx)(V.default,{large:!0,light:!0})})})}var Q=o(69553),G=o(38043),H=o(94435),U=o.n(H),q=o(94473),$=o.n(q),K=o(20116),X=o.n(K),Y=o(47302),J=o.n(Y),ee=o(54804),te=o.n(ee),oe=o(90461),ne=o(60067),le=o(259);const re=(0,le.observer)((function({priceImpactState:e}){var t;const{orderData:o}=(0,i.ZD)(),n=(0,x.E)(),{sellTokenInfo:l,buyTokenInfo:d,limitPriceFocusState:p,onChangeLimitPrice:u,limitPrice:m}=(0,c.LL)(),[g,h]=(0,s.useState)(!1),y="market"===o.type,v=y?" ":"0",j=null===(t=o.selectedPoolCalculation)||void 0===t?void 0:t.prices.market,b=j?(_=j,oe.C.format(_,o.tokens.priceDenomination,ne.S)+(te()(_).call(_,".")?".":"")):v;var _;const w=y?b:m.displayValue,C=(null==l?void 0:l.ticker)&&(null==d?void 0:d.ticker),k=!C||y,I=g?w+".":w;return(0,f.jsxs)(r.Z,{mt:"16px",children:[(0,f.jsxs)(r.Z,{component:"fieldset",sx:{border:"1px solid",borderColor:"grayscale.400",borderRadius:"8px",p:"16px",display:"grid",gridTemplateColumns:"1fr auto",justifyContent:"start",position:"relative",bgcolor:k?"ds.bg_color_contrast_min":"ds.bg_color_max",columnGap:"6px",rowGap:"8px",...!k&&{"&:hover":{border:"1px solid",borderColor:"grayscale.max"}}},height:"56px",children:[(0,f.jsx)(r.Z,{component:"legend",sx:{top:"-9px",left:"16px",position:"absolute",px:"4px",bgcolor:"ds.bg_color_max",borderRadius:"10px",color:"ds.text_gray_medium"},children:y?n.marketPrice:n.limitPrice}),(0,f.jsx)(a.Z,{sx:{appearance:"none",border:"0",outline:"none","::placeholder":{color:"grayscale.600"}},component:"input",type:"text",variant:"body1",color:"ds.text_gray_medium",placeholder:"0",bgcolor:k?"ds.bg_color_contrast_min":"ds.bg_color_max",readOnly:k,value:C?I:" ",onChange:e=>{let t=e.target.value.replace(/[^\d.]+/g,"");if(t&&"."!==t||(t=""),te()(t).call(t,"."))return h(!0),t=t.replace(".",""),void u(t);!/^[0-9]\d*(\.\d+)?$/gi.test(t)&&t||(u(t),h(!1))},onFocus:()=>!y&&p.update(!0),onBlur:()=>!y&&p.update(!1)}),(0,f.jsx)(r.Z,{sx:{justifySelf:"end"},children:(0,f.jsxs)(r.Z,{height:"100%",width:"max-content",display:"flex",alignItems:"center",children:[(0,f.jsx)(a.Z,{color:"ds.text_gray_max",children:(null==l?void 0:l.ticker)||"-"}),(0,f.jsx)(r.Z,{children:"/"}),(0,f.jsx)(a.Z,{color:"ds.text_gray_max",children:(null==d?void 0:d.ticker)||"-"})]})})]}),e&&C&&(0,f.jsx)(a.Z,{component:"div",variant:"caption",pt:"4px",children:(0,f.jsxs)(E.aI,{priceImpactState:e,sx:{display:"flex"},children:[(0,f.jsx)(E.iB,{small:!0,isSevere:e.isSevere})," = ",(0,f.jsx)(E.De,{})," (",(0,f.jsx)(E.Xi,{}),")"]})})]})}));var ae=o(25843),ie=o.n(ae),se=o(77766),ce=o.n(se),de=o(31238),pe=o.n(de),ue=o(78580),xe=o.n(ue),me=o(22694);const fe=["0","0.1","0.5","1","2","3","5","10"];function ge({onSetNewSlippage:e,onClose:t,slippageValue:o}){var n;const l=(0,x.E)(),[i,c]=(0,s.useState)(o),[d,p]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!xe()(fe).call(fe,o)),g=!u;return(0,f.jsx)(S.ZP,{title:l.slippageTolerance,onClose:t,withCloseButton:!0,closeOnOverlayClick:!0,styleContentOverride:{paddingTop:"16px"},styleOverride:{minWidth:"612px",height:"540px",maxWidth:"612px"},children:(0,f.jsxs)(r.Z,{sx:{margin:"0 auto",flex:1},children:[(0,f.jsx)(r.Z,{sx:{bg:"ds.bg_color_max"},children:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:l.defaultSlippageTolerance})}),(0,f.jsx)(r.Z,{pb:"16px",pt:"8px",children:(0,f.jsx)(a.Z,{component:"div",variant:"body2",color:"ds.text_gray_low",children:l.slippageToleranceTooltip})}),(0,f.jsx)(r.Z,{display:"flex",justifyContent:"flex-start",mb:"32px",children:(0,f.jsx)(me.Z,{tabs:ce()(n=P()(fe).call(fe,(e=>({label:`${e}%`,isActive:!u&&e===i,onClick:()=>{m(!1),c(e)}})))).call(n,{label:l.manual,isActive:u,onClick:()=>{m(!0)}})})}),(0,f.jsx)(r.Z,{my:"16px",children:(0,f.jsxs)(r.Z,{component:"fieldset",sx:{border:d&&!g?"2px solid":"1px solid",borderColor:d&&!g?"ds.el_gray_max":"grayscale.400",borderRadius:"8px",p:"16px",display:"grid",gridTemplateColumns:"1fr auto",justifyContent:"start",position:"relative",bgcolor:g?"ds.bg_color_contrast_min":"ds.bg_color_max",columnGap:"6px",rowGap:"8px",...!d&&!g&&{"&:hover":{border:"1px solid",borderColor:"ds.el_gray_max"}},maxHeight:"56px"},onFocus:()=>p(!0),onBlur:()=>p(!1),children:[(0,f.jsx)(r.Z,{component:"legend",sx:{top:"-7px",left:"16px",position:"absolute",px:"4px",bgcolor:"ds.bg_color_max",color:"ds.text_gray_medium"},children:l.slippageTolerance}),(0,f.jsx)(a.Z,{sx:{appearance:"none",border:"0",outline:"none","::placeholder":{color:"grayscale.600"}},component:"input",type:"text",variant:"body1",color:"ds.text_gray_medium",placeholder:"0",onChange:e=>{let t=e.target.value.replace(/[^\d.]+/g,"");const[o,n]=t.split(".");(null==n?void 0:n.length)>2&&(t=t.substr(0,o.length+3));const l=Number(t);l>100?t="100":l<0&&(t="0"),c(t)},bgcolor:g?"ds.bg_color_contrast_min":"ds.bg_color_max",readOnly:g,value:i})]})}),(0,f.jsx)(r.Z,{my:"24px",p:"16px",pt:"12px",bgcolor:"ds.sys_yellow_100",borderRadius:"8px",children:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"grayscale.max",children:l.slippageToleranceHigh})}),(0,f.jsx)(r.Z,{pt:"12px",children:(0,f.jsx)(w.Z,{disabled:0===ie()(i).call(i).length,fullWidth:!0,onClick:()=>{try{e(pe()(i)),t()}catch(e){console.error(`Failed to apply new slippage: "${i}"`,e)}},variant:"contained",children:l.apply})})]})})}var he,ye=o(90948),ve=o(2734),je=o(78426);function be(){return be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},be.apply(this,arguments)}function _e(e){return s.createElement("svg",be({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),he||(he=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.293 8.293a1 1 0 011.414 0L12 13.586l5.293-5.293a1 1 0 111.414 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414z",fill:"currentColor"})))}o.p;var we=o(17963),Ce=o(39958);const ke=(0,ye.ZP)(r.Z)((({theme:e})=>({"& svg":{"& path":{fill:e.palette.ds.el_gray_medium}}})));function Ie({label:e,showMax:t=!1,disabled:o=!1,onAssetSelect:n,error:l="",handleAmountChange:i,value:c,tokenInfo:d,defaultTokenInfo:p,getTokenInfo:u,focusState:m}){var g,h;const[y,v]=(0,s.useState)(null),{id:j,amount:b,ticker:_}=d||{},{name:w}=(0,ve.Z)(),C=(0,x.E)(),k=m.value?"grayscale.max":"grayscale.400";(0,s.useEffect)((()=>{null!=j&&u(j).then((e=>(null!=e.logo&&v(`data:image/png;base64,${e.logo}`),null))).catch((e=>{console.warn("Failed to resolve remote info for token: "+j,e)}))}),[j]);const I="dark-theme"===w?Ce.default:we.Z,Z=_===p.ticker?je.Z:null!=y?y:I;return(0,f.jsxs)(r.Z,{children:[(0,f.jsxs)(r.Z,{onClick:(null===(g=d.name)||void 0===g?void 0:g.length)>0?void 0:n,component:"fieldset",sx:{borderStyle:"solid",borderWidth:(null===(h=d.id)||void 0===h?void 0:h.length)>0&&l||m.value?"2px":"1px",borderColor:l?"ds.sys_magenta_500":k,borderRadius:"8px",p:"16px",display:"grid",gridTemplateColumns:"1fr auto",gridTemplateRows:"1fr 1fr",justifyContent:"start",position:"relative",bgcolor:"ds.bg_color_max",columnGap:"6px",rowGap:"6px",maxHeight:"80px","&:hover":{borderColor:!l&&"grayscale.max"}},children:[(0,f.jsx)(r.Z,{component:"legend",sx:{top:"-9px",left:"16px",position:"absolute",px:"4px",bgcolor:"ds.bg_color_max",color:l?"magenta.500":"ds.text_gray_medium"},children:e}),(0,f.jsx)(a.Z,{sx:{appearance:"none",border:"0",outline:"none","::placeholder":{color:"grayscale.600"},bgcolor:"ds.bg_color_max"},component:"input",type:"text",variant:"body1",color:"ds.text_gray_medium",placeholder:"0",padding:"0",onChange:e=>{o||i(e.target.value)},value:o?"":c,onFocus:()=>m.update(!0),onBlur:()=>m.update(!1)}),(0,f.jsx)(r.Z,{sx:{justifySelf:"end",cursor:"pointer",maxHeight:"24px"},onClick:n,children:(0,f.jsxs)(r.Z,{height:"100%",width:"min-content",display:"flex",gap:"8px",alignItems:"center",children:[(0,f.jsx)(r.Z,{width:"24px",height:"24px",sx:{overflowY:"hidden","& > svg":{width:"100%",height:"100%"},borderRadius:"4px"},children:(0,f.jsx)("img",{width:"100%",src:Z,alt:"",onError:e=>{e.target.src=I}})}),(0,f.jsx)(a.Z,{color:"ds.text_gray_medium",width:"max-content",children:_||"Select asset"}),(0,f.jsx)(r.Z,{display:"inline-flex",children:(0,f.jsx)(ke,{children:(0,f.jsx)(_e,{})})})]})}),!l&&t?(0,f.jsx)(r.Z,{children:(0,f.jsx)(a.Z,{component:"button",variant:"caption1",fontWeight:500,maxHeight:"18px",maxWidth:"34px",sx:{p:"2px 4px",bgcolor:"ds.gray_50",borderRadius:"4px",":disabled":{cursor:"not-allowed"},":hover":{bgcolor:"ds.gray_100"},":active":{bgcolor:"ds.gray_200"},color:"ds.text_gray_medium"},onClick:()=>{i(b)},disabled:o,children:C.max})}):(0,f.jsx)(r.Z,{minHeight:"18px"}),(0,f.jsx)(r.Z,{sx:{justifySelf:"end",alignSelf:"end"},children:(0,f.jsxs)(a.Z,{component:"div",variant:"caption1",color:"ds.text_gray_low",children:[C.currentBalance," ",b||0," ",_]})})]}),l&&(0,f.jsx)(a.Z,{component:"div",pt:"4px",variant:"caption",color:"ds.sys_magenta_500",children:l})]})}function Ze({onAssetSelect:e,defaultTokenInfo:t,getTokenInfo:o}){const{orderData:n}=(0,i.ZD)(),{sellQuantity:{displayValue:l,error:a},sellTokenInfo:s={},buyTokenInfo:d={},onChangeSellQuantity:p,sellFocusState:u}=(0,c.LL)(),m=(0,x.E)(),{tokenId:g}=n.amounts.sell,h=(null==s?void 0:s.ticker)&&(null==d?void 0:d.ticker);return(0,f.jsx)(r.Z,{children:(0,f.jsx)(Ie,{label:m.swapFromLabel,disabled:!h,handleAmountChange:p,value:l,tokenInfo:s,defaultTokenInfo:t,getTokenInfo:o,onAssetSelect:e,focusState:u,error:a,showMax:!0},g)})}function Te({onAssetSelect:e,defaultTokenInfo:t,getTokenInfo:o}){const n=(0,x.E)(),{orderData:l}=(0,i.ZD)(),{buyQuantity:{displayValue:r,error:a},sellTokenInfo:s={},buyTokenInfo:d={},onChangeBuyQuantity:p,buyFocusState:u}=(0,c.LL)(),{tokenId:m}=l.amounts.buy,g=(null==s?void 0:s.ticker)&&(null==d?void 0:d.ticker),h=g&&null==l.selectedPoolCalculation,y=h?n.pairNotAvailable:a;return(0,f.jsx)(Ie,{label:n.swapToLabel,disabled:!g,handleAmountChange:h?()=>{}:p,value:r,tokenInfo:d,defaultTokenInfo:t,getTokenInfo:o,onAssetSelect:e,focusState:u,error:y},m)}var Se=o(90649),Ee=o(88767),Ae=o(30300);function Le({store:e,onClose:t,onTokenInfoChanged:o,defaultTokenInfo:n,getTokenInfoBatch:l}){const{sellQuantity:{isTouched:r},buyQuantity:{isTouched:a},buyTokenInfo:d={},sellTokenInfo:x={},buyTouched:m,switchTokens:g}=(0,c.LL)(),{walletVerifiedAssets:h,isLoading:y,errored:v}=function(e,t){const o=(0,Ee.useQueryClient)(),{onlyVerifiedTokens:n,isLoading:l,isError:r}=(0,i.es)({useErrorBoundary:!1});return r&&o.invalidateQueries({queryKey:["useSwapTokensOnlyVerified"]}),{walletVerifiedAssets:(0,s.useMemo)((()=>{var o,l,r;const a=""===t.id,i=$()(e).call(e,(e=>""===e.id));return[...a?[]:[i],...J()(o=X()(l=P()(r=null!=n?n:[]).call(r,(t=>{if(""===t.id)return null;const o=$()(e).call(e,(e=>e.fingerprint===t.fingerprint));return{...t,...null!=o?o:{}}}))).call(l,Boolean)).call(o,(0,Se.comparatorByGetter)((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase()})))]}),[n,e,t]),isLoading:l,errored:r}}(e.assets,x),{orderData:j,resetQuantities:b}=(0,i.ZD)();return(0,f.jsx)(Ae.Z,{assets:h,assetsStillLoading:y||v,type:"to",onAssetSelected:e=>{const{id:n,decimals:l}=e,i=n!==j.amounts.buy.tokenId||!a||l!==d.decimals;n===j.amounts.sell.tokenId&&r&&(b(),g()),i&&(m(e),o({decimals:null!=l?l:0,id:n}),p.ampli.swapAssetToChanged((0,u.fQ)(e))),t()},onClose:t,defaultTokenInfo:n,getTokenInfoBatch:l})}function De({store:e,onClose:t,onTokenInfoChanged:o,defaultTokenInfo:n,getTokenInfoBatch:l}){const{walletVerifiedAssets:r,isLoading:a,errored:d}=function(e){const t=(0,Ee.useQueryClient)(),{onlyVerifiedTokens:o,isLoading:n,isError:l}=(0,i.es)({useErrorBoundary:!1});return l&&t.invalidateQueries({queryKey:["useSwapTokensOnlyVerified"]}),{walletVerifiedAssets:(0,s.useMemo)((()=>{var t,n;return J()(t=X()(n=P()(e).call(e,(e=>{const t=null==o?void 0:$()(o).call(o,(t=>t.fingerprint===e.fingerprint));return""===e.id||t?{...e,...null!=t?t:{}}:void 0}))).call(n,Boolean)).call(t,(0,Se.comparatorByGetter)((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase()})))}),[o,e]),isLoading:n,errored:l}}(e.assets);console.log("errored",d);const{orderData:x,resetQuantities:m}=(0,i.ZD)(),{buyQuantity:{isTouched:g},sellQuantity:{isTouched:h},sellTokenInfo:y={},sellTouched:v,switchTokens:j}=(0,c.LL)();return(0,f.jsx)(Ae.Z,{assets:r,assetsStillLoading:a||d,type:"from",onAssetSelected:e=>{const{id:n,decimals:l}=e,r=n!==x.amounts.sell.tokenId||!h||l!==y.decimals;n===x.amounts.buy.tokenId&&g&&(m(),j()),r&&(v(e),o({id:n,decimals:null!=l?l:0}),p.ampli.swapAssetFromChanged((0,u._o)(e))),t()},onClose:t,defaultTokenInfo:n,getTokenInfoBatch:l})}o(31653);var Oe,Pe,Fe=o(96486);function Be(){return Be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Be.apply(this,arguments)}function Re(e){return s.createElement("svg",Be({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Oe||(Oe=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.894 2c-.824 0-1.614.327-2.197.91L3.286 15.32a1 1 0 00-.263.465l-.993 3.972a1 1 0 001.213 1.212l3.971-.993a.999.999 0 00.465-.263L20.09 7.303A3.105 3.105 0 0017.894 2zm-.782 2.324a1.106 1.106 0 111.564 1.565L6.46 18.104l-2.086.522.522-2.086L17.11 4.324z",fill:"currentColor"})),Pe||(Pe=s.createElement("path",{d:"M12 19a1 1 0 100 2h9a1 1 0 100-2h-9z",fill:"#000"})))}o.p;var Me=o(1464),Ve=o(16942);const We=(0,ye.ZP)(r.Z)((({theme:e})=>({"& svg":{"& path":{fill:e.palette.ds.el_gray_medium}}})));function Ne({handleEditPool:e,defaultTokenInfo:t}){var o;const n=(0,x.E)(),[l,p]=(0,s.useState)(!0),{orderData:u}=(0,i.ZD)(),{selectedPoolCalculation:m,bestPoolCalculation:g,type:h}=u,{sellTokenInfo:y,buyTokenInfo:v}=(0,c.LL)(),{formattedPtAmount:j,formattedNonPtAmount:b}=(0,d.n)(t);if(!(null==y?void 0:y.ticker)||!(null==v?void 0:v.ticker)||null==m)return null;const{pool:_}=m,w=`Total: ${null==b?j:`${b} + ${j}`}`,C="limit"===h,k=((null==g?void 0:g.pool)||{}).poolId===_.poolId;return(0,f.jsxs)(r.Z,{children:[(0,f.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:"16px"},children:[(0,f.jsx)(r.Z,{display:"flex",gap:"8px",alignItems:"center",children:(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:n.dexLabel})}),(0,f.jsx)(r.Z,{sx:{display:"flex",gap:"4px",alignItems:"center"},children:(0,f.jsxs)(r.Z,{display:"flex",gap:"8px",alignItems:"center",children:[(0,f.jsx)(Me.j,{provider:_.provider}),(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:null!==(o=(0,Se.maybe)(_.provider,(e=>`${(0,Fe.capitalize)(e)} ${k?n.auto:""}`)))&&void 0!==o?o:n.noPoolFound}),C&&(0,f.jsx)(We,{sx:{cursor:"pointer"},onClick:C?e:void 0,children:(0,f.jsx)(Re,{})})]})})]}),(0,f.jsxs)(r.Z,{sx:{border:"1px solid",borderColor:"grayscale.400",borderRadius:"8px",position:"relative",bgcolor:"ds.bg_color_max",p:"16px"},children:[(0,f.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:l&&"8px",cursor:"pointer"},onClick:()=>p((e=>!e)),children:[_.provider&&(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:w}),(0,f.jsx)(r.Z,{sx:{cursor:"pointer",display:"flex",gap:"4px",alignItems:"center"},children:(0,f.jsx)(r.Z,{sx:{transform:l?"rotate(180deg)":"rotate(0deg)"},children:(0,f.jsx)(We,{children:(0,f.jsx)(_e,{})})})})]}),l&&(0,f.jsx)(Ve.Z,{defaultTokenInfo:t,withInfo:!0,showMinAda:!0})]})]})}var ze=o(67163);const Qe=["DEX name","Price","TVL","DEX fee","Liquidity provider fee"],Ge="minmax(auto, 208px) 120px 200px 90px 158px",He=10;function Ue({currentPool:e,sellTokenId:t,denomination:o,defaultTokenInfo:n,poolList:l=[],onPoolSelected:s,onClose:c}){var d;const p=null!==(d=n.decimals)&&void 0!==d?d:0,u=n.ticker;return(0,f.jsx)(S.ZP,{title:"Select dex",onClose:c,withCloseButton:!0,closeOnOverlayClick:!0,children:(0,f.jsx)(ze.Z,{gridTemplateColumns:Ge,columnNames:Qe,children:P()(l).call(l,(n=>{const{provider:l,fee:d,batcherFee:x,poolId:m}=n,g=new D.Z(n.tokenA.quantity).dividedBy(n.ptPriceTokenA).multipliedBy(2).toString(10),h=oe.C.format(g,p,0),y=(0,i.sq)(n,t),v=o>=0?oe.C.format(null!=y?y:oe.C.zero,o,He):"-",j=oe.C.format(x.quantity,p,p);return(0,f.jsxs)(r.Z,{onClick:()=>(e=>{s(e),c()})(m),sx:{p:"8px",display:"grid",gridColumn:"1/-1",border:"1px solid",borderRadius:"8px",cursor:"pointer",alignItems:"center",borderColor:e===m?"primary.600":"transparent",gridTemplateColumns:Ge,columnGap:"8px","&:hover":{bgcolor:"grayscale.50"}},children:[(0,f.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,f.jsx)(r.Z,{width:"32px",height:"32px",children:(0,f.jsx)(Me.j,{provider:l})}),(0,f.jsx)(a.Z,{component:"span",variant:"body1",fontWeight:500,color:"ds.text_gray_medium",children:l})]}),(0,f.jsx)(r.Z,{textAlign:"right",children:(0,f.jsx)(a.Z,{component:"span",variant:"body1",color:"ds.text_gray_medium",children:v})}),(0,f.jsx)(r.Z,{textAlign:"right",children:(0,f.jsxs)(a.Z,{component:"span",variant:"body1",color:"ds.text_gray_medium",children:[h," ",u]})}),(0,f.jsx)(r.Z,{textAlign:"right",children:(0,f.jsxs)(a.Z,{component:"span",variant:"body1",color:"ds.text_gray_medium",children:[j," ",u]})}),(0,f.jsx)(r.Z,{textAlign:"right",children:(0,f.jsxs)(a.Z,{component:"span",variant:"body1",color:"ds.text_gray_medium",children:[d,"%"]})})]},m)}))})})}function qe({onClose:e,defaultTokenInfo:t}){const{orderData:{tokens:o,pools:n,selectedPoolId:l,amounts:r},selectedPoolChanged:a}=(0,i.ZD)(),{poolTouched:s}=(0,c.LL)();return(0,f.jsx)(Ue,{onPoolSelected:e=>{s(),a(e),p.ampli.swapPoolChanged()},sellTokenId:r.sell.tokenId,denomination:o.priceDenomination,defaultTokenInfo:t,poolList:n,currentPool:l,onClose:e})}var $e;function Ke(){return Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ke.apply(this,arguments)}function Xe(e){return s.createElement("svg",Ke({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),$e||($e=s.createElement("path",{d:"M21 3a1 1 0 10-2 0v3.194l-.997-.898L18 5.294a8.997 8.997 0 00-15 6.705 1 1 0 102 .002 7.013 7.013 0 014.145-6.392 6.993 6.993 0 017.52 1.174l.001.001L18.016 8H14a1 1 0 100 2h6a1 1 0 001-1V3zM3 15a1 1 0 011-1h6a1 1 0 110 2H5.984l1.35 1.216A6.997 6.997 0 0019 12a1 1 0 112 .002 9.013 9.013 0 01-5.33 8.216A8.993 8.993 0 016 18.706l-.003-.002L5 17.805V21a1 1 0 11-2 0v-6z",fill:"#383E54"})))}o.p;const Ye=({orderType:e})=>{const{orderTypeChanged:t}=(0,i.ZD)(),{sellTokenInfo:o={},buyTokenInfo:n={}}=(0,c.LL)(),{marketTabLabel:l,limitTabLabel:a}=(0,x.E)(),d=!((null==o?void 0:o.ticker)&&(null==n?void 0:n.ticker)),p=[{type:"market",label:l},{type:"limit",label:a}],[u,m]=(0,s.useState)(0),g={transform:`rotate(${u}deg)`,transition:"transform 2s ease"};return(0,f.jsxs)(r.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:"16px",children:[(0,f.jsx)(me.Z,{tabs:P()(p).call(p,(({type:o,label:n})=>({label:n,isActive:e===o,onClick:()=>t(o)})))}),(0,f.jsx)(Je,{isDisabled:d,onClick:d?()=>{}:()=>{var e;null===(e=document.activeElement)||void 0===e||e.blur(),m((e=>e+360)),console.log("swap refresh")},children:(0,f.jsx)(Xe,{style:{...!d&&g}})})]})},Je=(0,ye.ZP)(r.Z)((({theme:e,isDisabled:t})=>({cursor:"pointer","& path":{fill:t?"#A0A4A8":"ds.el_gray_medium"},"& svg":{"& path":{fill:e.palette.ds.el_gray_medium}}})));var et;function tt(){return tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},tt.apply(this,arguments)}function ot(e){return s.createElement("svg",tt({width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),et||(et=s.createElement("path",{d:"M24.293 10.293a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L26 13.414V23a1 1 0 11-2 0v-9.586l-2.293 2.293a1 1 0 01-1.414-1.414l4-4zM16 17a1 1 0 10-2 0v9.586l-2.293-2.293a1 1 0 00-1.414 1.414l4 4a1 1 0 001.414 0l4-4a1 1 0 00-1.414-1.414L16 26.586V17z",fill:"currentColor"})))}o.p;const nt=(0,ye.ZP)(r.Z)((({theme:e})=>({"& svg":{"& path":{fill:e.palette.ds.el_primary_medium}}}))),lt=()=>{const{clearSwapForm:e,switchTokens:t,onChangeLimitPrice:o,buyTokenInfo:n={}}=(0,c.LL)(),{clear:l}=(0,x.E)();return(0,f.jsxs)(r.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,f.jsx)(r.Z,{sx:{cursor:null!=n&&n.ticker?"pointer":"not-allowed",color:null!=n&&n.ticker?"primary.500":"grayscale.400"},onClick:()=>{if(null!=n&&n.ticker)return o(""),t()},children:(0,f.jsx)(nt,{children:(0,f.jsx)(ot,{})})}),(0,f.jsx)(r.Z,{children:(0,f.jsx)(w.Z,{onClick:()=>e(),variant:"tertiary",color:"primary",children:l})})]})};var rt=o(64685);const at=({setOpenedDialog:e,slippageValue:t})=>{const{slippageTolerance:o,slippageToleranceTooltip:n}=(0,x.E)();return(0,f.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,f.jsxs)(r.Z,{display:"flex",gap:"8px",alignItems:"center",children:[(0,f.jsx)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:o}),(0,f.jsx)(rt.b,{content:n})]}),(0,f.jsxs)(it,{onClick:e,sx:{cursor:"pointer",display:"flex",gap:"4px",alignItems:"center"},children:[(0,f.jsxs)(a.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:[t,"%"]}),(0,f.jsx)(Re,{})]})]})},it=(0,ye.ZP)(r.Z)((({theme:e})=>({"& svg":{"& path":{fill:e.palette.ds.el_gray_medium}}})));var st=o(16550);const ct=({slippageValue:e,onSetNewSlippage:t,swapStore:o,defaultTokenInfo:n,getTokenInfo:l,getTokenInfoBatch:a,priceImpactState:d})=>{const[p,u]=(0,s.useState)(""),[x,m]=(0,s.useState)(),{orderData:{type:g},sellTokenInfoChanged:h,buyTokenInfoChanged:y}=(0,i.ZD)(),{buyTouched:v,onChangeLimitPrice:j}=(0,c.LL)(),{onlyVerifiedTokens:b}=(0,i.es)(),_=o.assets,w=(0,s.useMemo)((()=>{var e,t;return J()(e=X()(t=P()(_).call(_,(e=>{const t=$()(b).call(b,(t=>t.fingerprint===e.fingerprint));return""===e.id||t?{...e,...t}:void 0}))).call(t,Boolean)).call(e,(0,Se.comparatorByGetter)((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase()})))}),[b,_]),C=(0,st.useLocation)().search,k=new(U())(C).get("tokenId"),I=X()(w).call(w,(e=>e.id===k));return(0,s.useEffect)((()=>{I&&(m(I[0]),j())}),[]),(0,s.useEffect)((()=>{x&&(v(x),y({id:null==x?void 0:x.id,decimals:null==x?void 0:x.decimals}))}),[x]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.Z,{width:"100%",mx:"auto",maxWidth:"506px",display:"flex",flexDirection:"column",gap:"8px",pb:"20px",children:[(0,f.jsx)(Ye,{orderType:g}),(0,f.jsx)(Ze,{defaultTokenInfo:n,getTokenInfo:l,onAssetSelect:()=>u("from")}),(0,f.jsx)(lt,{}),(0,f.jsx)(Te,{defaultTokenInfo:n,getTokenInfo:l,onAssetSelect:()=>u("to")}),(0,f.jsx)(re,{priceImpactState:d}),(0,f.jsx)(at,{setOpenedDialog:()=>u("slippage"),slippageValue:e}),(0,f.jsx)(Ne,{handleEditPool:()=>u("pool"),defaultTokenInfo:n})]}),"from"===p&&(0,f.jsx)(De,{store:o,onClose:()=>u(""),onTokenInfoChanged:e=>{j(),h(e)},defaultTokenInfo:n,getTokenInfoBatch:a}),"to"===p&&(0,f.jsx)(Le,{store:o,onClose:()=>u(""),onTokenInfoChanged:e=>{j(),y(e)},defaultTokenInfo:n,getTokenInfoBatch:a}),"slippage"===p&&(0,f.jsx)(ge,{slippageValue:e,onSetNewSlippage:t,onClose:()=>u("")}),"pool"===p&&(0,f.jsx)(qe,{defaultTokenInfo:n,onClose:()=>u("")})]})};var dt=o(22188),pt=o(16544),ut=o(5227),xt=o(2677),mt=o(75723),ft=(o(34786),o(21131)),gt=o(38079),ht=o(84174),yt=o(99095),vt=o(13469),jt=o(57500),bt=o(50579);const _t=1,wt=10,Ct=.1,kt=(0,yt.injectIntl)((0,le.observer)((function(e){var t;const{stores:o}=e,[n,a]=(0,s.useState)(""),{back:c,sendUsingLedgerNano:h,sendUsingTrezorT:y,swap:v}=(0,x.E)(),{orderStep:j,setOrderStepValue:b}=o.substores.ada.swapStore,{openTxReviewModal:_,changeModalView:C,showTxResultModal:k}=(0,jt.useTxReviewModal)(),{slippage:I,slippageChanged:T,orderData:{type:S,slippage:L,selectedPoolCalculation:O,amounts:{sell:P,buy:F},limitPrice:B},frontendFeeTiersChanged:R}=(0,i.ZD)(),{sellTokenInfo:W,buyTokenInfo:N,resetSwapForm:H,sellQuantity:U,buyQuantity:q}=(0,Q.Z)(),$=o.wallets.selectedOrFail,K=$.type,X=$.isHardware,Y=(0,ht.getNetworkById)($.networkId),J=o.tokenInfoStore.getDefaultTokenInfoSummary(Y.NetworkId),ee=e=>o.tokenInfoStore.fetchMissingAndGetLocalOrRemoteMetadata(Y,e),te=e=>ee([e])[e].then((e=>null!=e?e:{})),oe="market"===S,ne=oe?Number(null!==(t=null==O?void 0:O.prices.priceImpact)&&void 0!==t?t:0):0,le=ne>_t?{isSevere:ne>wt}:null,{formattedFeeQuantity:re}=(0,d.n)(J),[ae,ie]=(0,s.useState)(null),[se,ce]=(0,s.useState)(null),[de,pe]=(0,s.useState)(String(L)),[ue,xe]=(0,s.useState)(null),me=X?null:(0,xt.uv)((0,s.useState)("")),fe=(0,xt.uv)((0,s.useState)(null)),ge=(null==W?void 0:W.ticker)&&(null==N?void 0:N.ticker),[he,ye]=(0,s.useState)(null);(0,s.useEffect)((()=>()=>{b(0)}),[]);const ve=null!=O&&"0"!==P.quantity&&"0"!==F.quantity&&null==U.error&&null==q.error&&ge,je=1===j&&null==ue,be=0===j&&ve||1===j&&!0,_e=o.substores.ada.swapStore.swapDisclaimerAcceptanceFlag;function we(){(0,dt.runInAction)((()=>{b(0),null==me||me.update(""),fe.update(null),xe(null)}))}(0,s.useEffect)((()=>{p.ampli.swapInitiated({...(0,u.th)(W,N),slippage_tolerance:L,order_type:S}),_e.get().then(ie).catch((e=>{console.error("Failed to load swap disclaimer status! Setting to false for safety",e),ie(!1)})),I.read().then((e=>(e>0&&(0,dt.runInAction)((()=>{pe(String(e)),e!==L&&T(e)})),null))).catch((e=>{console.error("Failed to load stored slippage",e)})),ce((0,mt.addressHexToBech32)($.externalAddressesByType[gt.dq.CARDANO_BASE][0].address)),o.substores.ada.stateFetchStore.fetcher.getSwapFeeTiers({network:Y}).then((e=>{var t;const o=null!==(t=null==e?void 0:e.muesliswap)&&void 0!==t?t:[];return R(o),null})).catch((e=>{console.error(`unexpected error: failed to get swap fee tiers: ${e}`)}))}),[]);const Ce=e=>{if(null==ue)throw new Error("Incorrect state! Order transaction is not prepared properly");if(!X&&""===e)throw new Error("Incorrect state! User password is required")};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.Z,{display:"flex",flexDirection:"column",height:"100%",children:[(0,f.jsxs)(r.Z,{sx:{flexGrow:"1",overflowY:"auto",p:"24px"},borderBottom:"1px solid",borderColor:"grayscale.200",children:[0===j&&(0,f.jsx)(ct,{swapStore:o.substores.ada.swapStore,slippageValue:de,onSetNewSlippage:e=>{(0,dt.runInAction)((()=>{I.save(e),T(e),pe(String(e)),p.ampli.swapSlippageChanged({slippage_tolerance:e})}))},defaultTokenInfo:J,getTokenInfo:te,getTokenInfoBatch:ee,priceImpactState:le}),1===j&&(0,f.jsx)(g,{slippageValue:de,walletAddress:se,priceImpactState:le,onRemoteOrderDataResolved:async({contractAddress:e,datum:t,datumHash:n})=>{if(null==O)throw new Error("Incorrect state. Pool calculations are not available to prepare the transaction");if(null==e||null==t||null==n)throw new Error(`Incorrect remote order resolve! ${l()({contractAddress:e,datum:t,datumHash:n})}`);const{pool:{provider:r,deposit:a,batcherFee:i},cost:s}=O,c=s.frontendFeeInfo.fee,d={deposit:a.quantity,batcher:i.quantity},p={wallet:$,contractAddress:e,datum:t,datumHash:n,sell:P,buy:F,feFees:c,ptFees:d,poolProvider:r},u=await o.substores.ada.swapStore.createUnsignedSwapTx(p),x=u.unsignedTx;(0,dt.runInAction)((()=>{ye(x),xe(u)}))},defaultTokenInfo:J,getTokenInfo:te,getFormattedPairingValue:e=>{var t;const{currency:n}=o.profile.unitOfAccount;if(null==n||null==J.ticker)return"-";const l=o.coinPriceStore.getCurrentPrice(J.ticker,n),r=new D.Z(e).shiftedBy(-(null!==(t=J.decimals)&&void 0!==t?t:0));return`${l?(0,pt.calculateAndFormatValue)(r,l):"-"} ${n}`},onError:()=>{o.app.goToRoute({route:ut.ROUTES.SWAP.ERROR})}}),2===j&&(0,f.jsx)(Z,{txSubmitErrorState:fe,onTryAgain:we,onSuccess:()=>{o.app.goToRoute({route:ut.ROUTES.WALLETS.ROOT})},onDownloadLogs:vt.ju})]}),j<2&&(0,f.jsxs)(r.Z,{flexShrink:0,gap:"24px",p:"24px",display:"flex",alignItems:"center",justifyContent:"center",sx:{height:"97px"},children:[1===j&&(0,f.jsx)(w.Z,{onClick:we,sx:{minWidth:"128px",minHeight:"48px"},variant:"secondary",children:c}),(0,f.jsx)(w.Z,{onClick:async()=>{try{if(0===j)!function(){if(""===n){if(oe){if(function(){if(null!=le&&le.isSevere)return a("priceImpactAlert"),!0}())return}else if(function(){const e=new D.Z(O.prices.market);if(new D.Z(B).isGreaterThan(e.times(1+Ct)))return a("limitOrderWarning"),!0}())return;b(1),xe(null)}}();else if(1===j){var e,t,l;const n=(null===(e=O.pool)||void 0===e?void 0:e.poolId)===(null===(t=O.pool.bestPool)||void 0===t?void 0:t.poolId);_({title:"Transaction confirmation",modalView:"transactionReview",receiverCustomTitle:{to:(0,f.jsx)(Me._,{provider:null===(l=O.pool)||void 0===l?void 0:l.provider,isAutoPool:n})},submitTx:e=>{(async e=>{if(null==ue)return;Ce(e),a("loadingOverlay");const t={wallet:$,signRequest:ue},n=X?{[K]:t}:{normal:{...t,password:e}};try{const e=()=>o.wallets.refreshWalletFromRemote($.publicDeriverId);await o.substores.ada.wallets.adaSendAndRefresh({broadcastRequest:n,refreshWallet:e}),b(2),k(bt.TransactionResult.SUCCESS);try{p.ampli.swapOrderSubmitted({...(0,u.th)(W,N),from_amount:U.displayValue,to_amount:q.displayValue,pool_source:null==O?void 0:O.pool.provider,order_type:S,slippage_tolerance:Number(de),swap_fees:Number(re)})}catch(e){console.error("analytics fail",e)}H()}catch(e){!function(e){const t=e instanceof ft.IncorrectWalletPasswordError;(0,dt.runInAction)((()=>{fe.update(e),b(t?1:2),k(bt.TransactionResult.FAIL)})),t||console.error("Failed to submit swap tx",e)}(e)}finally{a("")}})(e)},extraOverviewDetails:{title:"Swap Details",onClick:()=>C({modalView:"extraDetails"}),component:(0,f.jsx)(m.g,{defaultTokenInfo:J,getTokenInfo:te,priceImpactState:le,slippageValue:de})},unsignedTx:he})}}catch(e){console.error("Error handling next step",e)}},sx:{minWidth:"128px",minHeight:"48px"},variant:"primary",disabled:!be||je,children:je&&(0,f.jsx)(V.default,{small:!0,color:3})||(0===j?v:"ledger"===K?h:"trezor"===K?y:e.intl.formatMessage(G.default.confirm))})]})]}),"loadingOverlay"===n&&(0,f.jsx)(z,{}),"limitOrderWarning"===n&&(0,f.jsx)(A,{onContinue:()=>{b(1),a("")},onCancel:()=>a("")}),"priceImpactAlert"===n&&(0,f.jsx)(E.NN,{onContinue:()=>{b(1),a("")},onCancel:()=>a("")}),!1===ae&&(0,f.jsx)(M,{onDialogConfirm:()=>{_e.set(!0).then((()=>ie(!0))).catch((e=>{console.error("Failed to store swap acceptance status!",e),ie(!0)}))},onDialogRefuse:()=>{o.app.redirect({route:ut.ROUTES.WALLETS.ROOT})}})]})})))}}]);
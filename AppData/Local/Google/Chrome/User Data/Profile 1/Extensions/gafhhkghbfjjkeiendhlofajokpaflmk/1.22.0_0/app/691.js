!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f6442b66-a327-42ce-9462-0ed70183040d",e._sentryDebugIdIdentifier="sentry-dbid-f6442b66-a327-42ce-9462-0ed70183040d")}catch(s){}}();var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"1.22.0-2d3a946"};"use strict";(self["webpackChunk_lace_browser_extension_wallet"]=self["webpackChunk_lace_browser_extension_wallet"]||[]).push([[691],{"./src/hooks/index.ts":(e,t,s)=>{s.d(t,{COIN_SELECTION_ERRORS:()=>m.COIN_SELECTION_ERRORS,TOAST_DEFAULT_DURATION:()=>O.TOAST_DEFAULT_DURATION,useAppInit:()=>N.useAppInit,useAssetInfo:()=>I.useAssetInfo,useCurrentWallet:()=>V.useCurrentWallet,useCustomSubmitApi:()=>j.useCustomSubmitApi,useFetchCoinPrice:()=>r.useFetchCoinPrice,useGetHandles:()=>x.useGetHandles,useHandleResolver:()=>P.useHandleResolver,useInitializeTx:()=>m.useInitializeTx,useLocalStorage:()=>a.useLocalStorage,useNetwork:()=>T.useNetwork,useOnAddressSave:()=>D.useOnAddressSave,useRedirection:()=>n.useRedirection,useUpdateAddressStatus:()=>_.useUpdateAddressStatus,useWalletAvatar:()=>B.useWalletAvatar,useWalletManager:()=>y.useWalletManager});var a=s("./src/hooks/useLocalStorage.ts");var n=s("./src/hooks/useRedirection.ts");var o=s("./src/hooks/useAddressValidation.ts");var r=s("./src/hooks/useFetchCoinPrice.ts");var i=s("../../node_modules/react/index.js");var l=s("./src/api/transformers.ts");var c=s("../../packages/common/dist/index.esm.js");var d=s("./src/stores/index.ts");const useBalances=e=>{const{inMemoryWallet:t}=useWalletStore();const s=useObservable(t.balance.utxo.total$);const a=useObservable(t.balance.utxo.available$);const n=useObservable(t.balance.rewardAccounts.deposit$);const o=useObservable(t.balance.rewardAccounts.rewards$);const r=useMemo(()=>s&&a?{total:walletBalanceTransformer(BigInt((s.coins||BigInt(0))+(o||BigInt(0))).toString(),e),available:walletBalanceTransformer(BigInt((a.coins||BigInt(0))+(o||BigInt(0))).toString(),e)}:void 0,[s,a,e,o]);const i=useMemo(()=>o?walletBalanceTransformer(o.toString(),e):void 0,[o,e]);const l=useMemo(()=>n?walletBalanceTransformer(n.toString(),e):void 0,[n,e]);return{balance:r,rewards:i,deposit:l}};var u=s("../../node_modules/lodash/isEmpty.js");const useDelegationDetails=()=>{var e;const{inMemoryWallet:t}=useWalletStore();const s=useObservable(null==t?void 0:null===(e=t.delegation)||void 0===e?void 0:e.rewardAccounts$);return useMemo(()=>{var e,t,a;const n=isEmpty(s)?void 0:s[0];return s?(null==n?void 0:null===(e=n.delegatee)||void 0===e?void 0:e.nextNextEpoch)||(null==n?void 0:null===(t=n.delegatee)||void 0===t?void 0:t.nextEpoch)||(null==n?void 0:null===(a=n.delegatee)||void 0===a?void 0:a.currentEpoch)||null:void 0},[s])};var m=s("./src/hooks/useInitializeTx.ts");var v=s("./src/features/stake-pool-details/store/index.ts");var p=s("./src/views/browser-view/features/staking/types/index.ts");var g=s("./src/features/delegation/stores/index.ts");var w=s("../../node_modules/@cardano-sdk/input-selection/dist/esm/InputSelectionError.js");const S={[w.InputSelectionFailure.UtxoFullyDepleted]:p.StakingErrorType.UTXO_FULLY_DEPLETED,[w.InputSelectionFailure.UtxoBalanceInsufficient]:p.StakingErrorType.UTXO_BALANCE_INSUFFICIENT};const isDeRegistrationsWithRewardsLockedError=e=>!!e&&"object"==typeof e&&"name"in e&&e.name===DeRegistrationsWithRewardsLocked.name;const useBuildDelegation=()=>{const{inMemoryWallet:e}=useWalletStore();const{selectedStakePool:t,setDelegationTxBuilder:s,setDelegationTxFee:a}=useDelegationStore();const{setIsBuildingTx:n,setStakingError:o}=useStakePoolDetails();const r=useCallback(async r=>{try{const i=null!=r?r:null==t?void 0:t.hexId;const l=i?{pools:[{weight:1,id:i}]}:null;n(true);const c=e.createTxBuilder();const d=await c.delegatePortfolio(l).build().inspect();s(c);a(d.body.fee.toString());o()}catch(u){if(isDeRegistrationsWithRewardsLockedError(u))o({data:u.keysWithLockedRewards,type:StakingErrorType.REWARDS_LOCKED});else if("object"==typeof u&&Object.values(InputSelectionFailure).includes(u.failure)&&u.failure in S)o({type:S[u.failure]})}finally{n(false)}},[e,null==t?void 0:t.hexId,s,a,n,o]);return{buildDelegation:r}};var y=s("./src/hooks/useWalletManager.ts");var f=s("./src/hooks/useStickyTopPosition.ts");var b=s("./src/hooks/useTimeSpentOnPage.ts");const useSyncingTheFirstTime_useSyncingTheFirstTime=()=>{const{inMemoryWallet:e}=useWalletStore();const t=useMemo(()=>{var t;if(!e){return of(true)}return concat(of(true),null==e?void 0:null===(t=e.syncStatus)||void 0===t?void 0:t.isSettled$.pipe(filter(e=>e),map(()=>false),take(1)))},[e]);return useObservable(t)};var E=s("./src/views/browser-view/features/send-transaction/index.ts");var C=s("./src/utils/constants.ts");const useHasEnoughCollateral_useHasEnoughCollateral=()=>{const[e,t]=useState(false);const{inMemoryWallet:s}=useWalletStore();const a=useObservable(null==s?void 0:s.addresses$);useEffect(()=>{(async()=>{var e;const n=null==a?void 0:null===(e=a[0])||void 0===e?void 0:e.address;const o={address:n&&Cardano.PaymentAddress(n),value:{coins:COLLATERAL_AMOUNT_LOVELACES}};try{await s.createTxBuilder().addOutput(o).build().inspect();t(true)}catch{t(false)}})()},[a,s]);return e};const useCollateral=()=>{var e;const[t,s]=useState();const[a,n]=useState();const{inMemoryWallet:o,isInMemoryWallet:r}=useWalletStore();const{setBuiltTxData:i}=useBuiltTxState();const[l,c]=useState(false);const[d,u]=useState(false);const m=useObservable(null==o?void 0:o.addresses$);const v=null==m?void 0:null===(e=m[0])||void 0===e?void 0:e.address;const p=useHasEnoughCollateral();const g=useSyncingTheFirstTime();const w=useMemo(()=>({address:v&&Cardano.PaymentAddress(v),value:{coins:COLLATERAL_AMOUNT_LOVELACES}}),[v]);const S=useCallback(async()=>{if(!p||g)return;c(true);const e=o.createTxBuilder().addOutput(w);const t=await e.build().inspect();s(t.body.fee);n(e);c(false)},[p,g,o,w]);const y=useCallback(async()=>{if(!a)return;u(true);try{const e=a.build();const t=await e.sign();await o.submitTx(t);const s=await firstValueFrom(o.utxo.available$.pipe(map(e=>e.find(e=>e[0].txId===t.tx.id&&e[1].value.coins===COLLATERAL_AMOUNT_LOVELACES)),filter(isNotNil),take(1)));await o.utxo.setUnspendable([s]);if(!r){const n=await e.inspect();i({uiTx:{fee:n.inputSelection.fee,hash:n.hash,outputs:n.inputSelection.outputs}})}}catch(l){if(!r){logger.error("submitCollateralTx fails with:",null==l?void 0:l.message);i({uiTx:void 0,error:l.message})}throw l}finally{u(false)}},[a,o,r,i]);return{initializeCollateralTx:S,submitCollateralTx:y,isInitializing:l,isSubmitting:d,txFee:t,hasEnoughAda:p,txBuilder:a}};var T=s("./src/hooks/useNetwork.ts");var k=s("./src/hooks/useEnterKeyPress.ts");var h=s("../../node_modules/bignumber.js/bignumber.js");const R=2;const useStakingRewards=()=>{const{inMemoryWallet:e}=useWalletStore();const t=useObservable(useMemo(()=>{return combineLatest([e.currentEpoch$,e.delegation.rewardsHistory$]).pipe(map(([{epochNo:e},{all:t}])=>{var s;const a=e.valueOf()-R;const n=t.filter(({epoch:e})=>e.valueOf()<=a);var o;return{totalRewards:(null==n?void 0:n.length)>0?BigNumber.sum.apply(null,null!==(o=n.map(({rewards:e})=>e.toString()))&&void 0!==o?o:[]):0,lastReward:(null===(s=n[n.length-1])||void 0===s?void 0:s.rewards)||0}}))},[e.currentEpoch$,e.delegation.rewardsHistory$]));return{totalRewards:(null==t?void 0:t.totalRewards)||0,lastReward:(null==t?void 0:t.lastReward)||0}};var A=s("./src/hooks/useMaxAda.ts");var x=s("./src/hooks/useGetHandles.ts");var P=s("./src/hooks/useHandleResolver.ts");var I=s("./src/hooks/useAssetInfo.ts");var _=s("./src/hooks/useUpdateAddressStatus.ts");var D=s("./src/hooks/useOnAddressSave.ts");var N=s("./src/hooks/useAppInit.ts");var B=s("./src/hooks/useWalletAvatar.ts");var O=s("./src/hooks/useActionExecution.ts");var j=s("./src/hooks/useCustomSubmitApi.ts");var V=s("./src/hooks/useCurrentWallet.ts")},"./src/hooks/useEnterKeyPress.ts":(e,t,s)=>{s.d(t,{buttonIds:()=>o});var a=s("./src/routes/wallet-paths.ts");var n=s("../../node_modules/react/index.js");const o={sendNextBtnId:"send-next-btn",nftDetailsBtnId:"send-nft-btn",tokenBtnId:"send-token-btn",addressSaveBtn:"addr-save-btn"};const isElementEnabled=e=>!e.hasAttribute("disabled");const handleClick=e=>{const t=document.querySelector(`#${e}`);if(t&&!t.hasAttribute("disabled"))t.click()};const handleStakingBtn=()=>{const e=document.querySelector('[data-testid="stake-pool-details-stake-btn"]');const t=document.querySelector('[data-testid="stake-pool-confirmation-btn"]');const s=document.querySelector('[data-testid="switch-pools-modal-confirm"]');const a=document.querySelector('[data-testid="stake-sign-confirmation-btn"]');const n=document.querySelector('[data-testid="exit-staking-modal-confirm"]');if(n)n.click();else if(t&&!t.hasAttribute("disabled"))t.click();else if(a&&!a.hasAttribute("disabled"))a.click();else if(s&&!s.hasAttribute("disabled"))s.click();else if(e&&!e.hasAttribute("disabled"))e.click()};const handleAddressBtn=()=>{const e=document.querySelector('[data-testid="address-form-details-btn-edit"]');const t=document.querySelector('[data-testid="address-form-button-save"]');const s=document.querySelector('[data-testid="delete-address-modal-confirm"]');const a=null==s?void 0:s.offsetHeight;if(a&&isElementEnabled(s))s.click();else if(t&&isElementEnabled(t))t.click();else if(e&&isElementEnabled(e))e.click()};const handleSetting=()=>{const e=document.querySelector('[data-testid="show-public-key-button"]');const t=document.querySelector('[data-testid="show-passphrase-button"]');const s=document.querySelector('[data-testid="hide-passphrase-button"]');const a=document.querySelector('[data-testid="delete-address-modal-cancel"]');if(e&&!e.hasAttribute("disabled"))e.click();else if(t&&!t.hasAttribute("disabled"))t.click();else if(s&&!s.hasAttribute("disabled"))s.click();else if(a&&!a.hasAttribute("disabled"))a.click()};const handleAssetBtn=()=>{const e=document.querySelector(`#${o.tokenBtnId}`);const t=document.querySelector(`#${o.sendNextBtnId}`);const s=document.querySelector('[data-testid="delete-address-modal-confirm"]');if(s)s.click();else if(e&&!e.hasAttribute("disabled"))e.click();else if(t&&!t.hasAttribute("disabled"))t.click()};const handleSendBtn=()=>{const e=document.querySelector('[data-testid="delete-address-modal-confirm"]');if(e)e.click();else handleClick(o.sendNextBtnId)};const handleEnterKeyPress=e=>{const t=window.location.hash;if("Enter"===e.code){switch(true){case new RegExp("send").test(t):handleSendBtn();break;case new RegExp("nft").test(t):handleClick(o.nftDetailsBtnId);break;case new RegExp(walletRoutePaths.assets).test(t):handleAssetBtn();break;case new RegExp(walletRoutePaths.earn).test(t)||new RegExp(walletRoutePaths.staking).test(t):handleStakingBtn();break;case new RegExp(walletRoutePaths.addressBook).test(t):handleAddressBtn();break;case new RegExp(walletRoutePaths.settings).test(t):handleSetting();break;default:break}}};const useEnterKeyPress=()=>{useEffect(()=>{document.addEventListener("keydown",handleEnterKeyPress);return()=>{document.removeEventListener("keydown",handleEnterKeyPress)}},[])}},"./src/hooks/useIsSmallerScreenWidthThan.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");const useIsSmallerScreenWidthThan=e=>{const[t,s]=useState(window.innerWidth<=e);useEffect(()=>{const t=window.matchMedia(`(min-width: ${e}px)`);const handleMatchMediaChangeEvent=e=>s(!e.matches);t.addEventListener("change",handleMatchMediaChangeEvent);return()=>{t.removeEventListener("change",handleMatchMediaChangeEvent)}},[]);return t}},"./src/hooks/useMultiDelegationEnabled.ts":(e,t,s)=>{var a=s("./src/stores/index.ts");var n=s("../../node_modules/react/index.js");const useMultiDelegationEnabled=()=>{const{walletType:e}=useWalletStore();return useMemo(()=>{switch(e){case WalletType.Ledger:return true;case WalletType.Trezor:return true;default:return true}},[e])}},"./src/hooks/useTxHistoryLoader.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/stores/index.ts");var o=s("../../packages/cardano/dist/index.esm.js");var r=s("../../packages/common/dist/index.esm.js");const i={transactions:void 0,mightHaveMore:false};const useTxHistoryLoader=e=>{var t;const{blockchainProvider:{chainHistoryProvider:s},cardanoWallet:a}=useWalletStore();const n=useMemo(()=>Wallet.createObservableTransactionsByAddressesProvider(s,{initialInterval:DEFAULT_POLLING_CONFIG.pollInterval,maxInterval:DEFAULT_POLLING_CONFIG.pollInterval*DEFAULT_POLLING_CONFIG.maxIntervalMultiplier},console),[s]);const o=useMemo(()=>Wallet.createTxHistoryLoader(n,a.wallet,e),[a.wallet,e,n]);const r=useObservable(o.loadedHistory$,i);const l=useObservable(o.error$,null);useEffect(()=>{var t,s;if((null===(t=r.transactions)||void 0===t?void 0:t.length)&&(null===(s=r.transactions)||void 0===s?void 0:s.length)<e&&r.mightHaveMore)o.loadMore()},[r.mightHaveMore,null===(t=r.transactions)||void 0===t?void 0:t.length,e,o]);return useMemo(()=>({loadMore:o.loadMore,retry:o.retry,loadedHistory:r,error:l}),[r,l,o.loadMore,o.retry])}},"./src/hooks/useWalletActivities.ts":(e,t,s)=>{var a=s("./src/providers/index.ts");var n=s("../../node_modules/react/index.js");var o=s("./src/hooks/useFetchCoinPrice.ts");var r=s("./src/stores/index.ts");var i=s("../../node_modules/lodash/noop.js");var l=s.n(i);var c=s("./src/stores/slices/index.ts");var d=s("../../packages/core/dist/index.esm.js");var u=s("./src/hooks/useTxHistoryLoader.ts");var m=s("../../packages/common/dist/index.esm.js");const useAsyncSwitchMap_useAsyncSwitchMap=(e,t)=>{const s=useRef(0);return useCallback(a=>{const n=++s.current;(async()=>{try{const o=await e(a);if(n===s.current)t(o)}catch(r){logger.error("useAsyncSwitchMap: Failed to map the input",r)}})()},[e,t])};const v={sendAnalytics:l()};const useWalletActivities=({sendAnalytics:e,withLimitedRewardsHistory:t}=v)=>{var s;const{fiatCurrency:a}=useCurrencyStore();const{priceResult:n}=useFetchCoinPrice();const{getWalletActivities:o,walletActivitiesStatus:r,walletActivities:i,activitiesCount:l,walletState:c}=useWalletStore();const d=null==n?void 0:null===(s=n.cardano)||void 0===s?void 0:s.price;const u=useCallback(async()=>{a&&d&&o({fiatCurrency:a,cardanoFiatPrice:d,sendAnalytics:e,withLimitedRewardsHistory:t})},[a,d,o,t,e]);useEffect(()=>{u()},[u,null==c?void 0:c.transactions.history,null==c?void 0:c.transactions.outgoing.inFlight,null==c?void 0:c.transactions.outgoing.signed,null==c?void 0:c.addresses,null==c?void 0:c.assetInfo,null==c?void 0:c.delegation.rewardsHistory,null==c?void 0:c.eraSummaries]);return{walletActivitiesStatus:r,walletActivities:i,activitiesCount:l}};const useWalletActivitiesPaginated=({sendAnalytics:e}=v)=>{var t,s,a;const[n,o]=useState();const[r,i]=useState(1);const{fiatCurrency:l}=useCurrencyStore();const{priceResult:c}=useFetchCoinPrice();const{walletUI:{cardanoCoin:d},walletState:u,setTransactionActivityDetail:m,setRewardsActivityDetail:p,assetDetails:g,blockchainProvider:{assetProvider:w,inputResolver:S},isSharedWallet:y}=useWalletStore();const f=null==c?void 0:null===(t=c.cardano)||void 0===t?void 0:t.price;const b=useItemsPageSize();const{loadMore:E,retry:C,error:T,loadedHistory:k}=useTxHistoryLoader(b);const h=useMemo(()=>({fiatCurrency:l,cardanoFiatPrice:f,sendAnalytics:e,withLimitedRewardsHistory:true}),[f,l,e]);const R=useMemo(()=>({assetProvider:w,cardanoCoin:d,setRewardsActivityDetail:p,setTransactionActivityDetail:m,assetDetails:g,inputResolver:S,isSharedWallet:y}),[w,d,p,m,g,S,y]);const A=useCallback(async e=>{const{transactions:t}=u;return(await mapWalletActivities({...u,transactions:{...t,history:e}},h,R)).walletActivities},[R,h,u]);const x=useAsyncSwitchMap(A,o);useEffect(()=>{(async()=>{if((null==k?void 0:k.transactions)===void 0||!l||!f)return;x(k.transactions.slice(0,r*b))})()},[f,r,R,h,l,x,null==k?void 0:k.transactions,A,b,u]);const P=useCallback(()=>{var e;var t;if(r*b>=(null!==(t=null==k?void 0:null===(e=k.transactions)||void 0===e?void 0:e.length)&&void 0!==t?t:0))E();i(e=>e+1)},[r,null==k?void 0:null===(s=k.transactions)||void 0===s?void 0:s.length,b,E]);return{walletActivities:n,mightHaveMore:null==k?void 0:k.mightHaveMore,loadedTxLength:null==k?void 0:null===(a=k.transactions)||void 0===a?void 0:a.slice(0,r*b).length,loadMore:P,retry:C,error:T}}},"./src/lib/scripts/types/index.ts":(e,t,s)=>{s.d(t,{ABOUT_EXTENSION_KEY:()=>r,BaseChannels:()=>a.BaseChannels,BrowserViewSections:()=>a.BrowserViewSections,MessageTypes:()=>a.MessageTypes,USER_ID_SERVICE_BASE_CHANNEL:()=>n.USER_ID_SERVICE_BASE_CHANNEL});var a=s("./src/lib/scripts/types/background-service.ts");var n=s("./src/lib/scripts/types/userIdService.ts");const o="authorizedDapps";const r="aboutExtension";const i="midnightEventBanner";var l=s("./src/lib/scripts/types/nami-migration-channels.ts")},"./src/lib/scripts/types/nami-migration-channels.ts":(e,t,s)=>{var a;(function(e){e["MIGRATION"]="migration"})(a||(a={}))},"./src/lib/storage/hooks/index.ts":(e,t,s)=>{s.d(t,{useDbState:()=>useDbState});var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/dexie-react-hooks/dist/dexie-react-hooks.js");var o=s("./src/providers/DatabaseProvider/index.ts");var r=s("./src/hooks/useActionExecution.ts");var i=s("./src/lib/storage/config/index.ts");var l=s("./src/lib/storage/helpers/index.ts");const useDbState=(e,t,s)=>{const[c]=(0,o.useDatabaseContext)();const[d,u]=(0,a.useState)(i.LIST_DEFAULT_LIMIT);const[m]=(0,r.useActionExecution)({shouldDisplayToastOnSuccess:true,getErrorMessage:l.getErrorMessage});const v=(0,n.useLiveQuery)(()=>{const e=c.getConnection(t).limit(d);return s&&(null==s?void 0:s.listQuery)?s.listQuery(e):e.toArray()},[d,s],e);const p=(0,n.useLiveQuery)(()=>{return s&&(null==s?void 0:s.countQuery)?null==s?void 0:s.countQuery(c.getConnection(t)):c.getConnection(t).count()},[s]);const saveRecord=(e,a)=>m(()=>s&&s.saveRecordQuery?s.saveRecordQuery(c.getConnection(t))(e):c.getConnection(t).add(e),a);const updateRecord=(e,s,a)=>m(()=>c.getConnection(t).update(e,s),a);const deleteRecord=(e,s)=>m(()=>c.getConnection(t).delete(e),s);const g=(0,a.useCallback)(()=>m(()=>c.getConnection(t).clear()),[c,m,t]);const w=(0,a.useCallback)(()=>{u(e=>e+i.LIST_DEFAULT_LIMIT)},[u]);return{list:v,count:p,utils:{saveRecord,updateRecord,deleteRecord,extendLimit:w,clearTable:g}}}},"./src/lib/storage/models/index.ts":(e,t,s)=>{s.d(t,{addressBookQueries:()=>addressBookQueries,addressBookSchema:()=>n,dappSchema:()=>o.dappSchema,nftFoldersQueries:()=>nftFoldersQueries,nftFoldersSchema:()=>r});var a=s("./src/lib/storage/helpers/index.ts");const n={table:"addressBook",indexedFields:{1:["++id","name","address"],2:["++id","name","address","network","handleResolution"]}};const addressBookQueries=e=>({listQuery:t=>t.filter(({network:t})=>t===e).sortBy("name",a.sortTabletByName),countQuery:t=>t.filter(({network:t})=>t===e).count(),saveRecordQuery:t=>s=>t.add({...s,network:e})});var o=s("./src/lib/storage/models/dapp.ts");const r={table:"nftFolders",indexedFields:{3:["++id","&name","assets","network"]}};const nftFoldersQueries=e=>({listQuery:t=>t.filter(({network:t})=>t===e).sortBy("name",a.sortTabletByName),saveRecordQuery:t=>s=>t.add({...s,network:e})})},"./src/lib/wallet-api-ui.ts":(e,t,s)=>{s.d(t,{bitcoinWallet:()=>T,bitcoinWalletManager:()=>f,createPassphrase:()=>createPassphrase,observableWallet:()=>E,signingCoordinator:()=>h,walletManager:()=>y,walletRepository:()=>C,withSignTxConfirmation:()=>withSignTxConfirmation});var a=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/messaging/index.js");var n=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/util.js");var o=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/observableWallet/util.js");var r=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/errors.js");var i=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/SigningCoordinator/KeyAgentFactory.js");var l=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/SigningCoordinator/SigningCoordinator.js");var c=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/SigningCoordinator/exposeSigningCoordinatorApi.js");var d=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/types.js");var u=s("../../packages/cardano/dist/index.esm.js");var m=s("../../node_modules/rxjs/dist/esm5/internal/firstValueFrom.js");var v=s("../../node_modules/webextension-polyfill/dist/browser-polyfill.js");var p=s.n(v);var g=s("../../packages/common/dist/index.esm.js");var w=s("./src/lib/scripts/background/bitcoinWalletManager.ts");var S=s("../../node_modules/buffer/index.js")["Buffer"];const y=(0,a.consumeRemoteApi)({baseChannel:(0,n.walletManagerChannel)("lace"),properties:n.walletManagerProperties},{logger:g.logger,runtime:v.runtime});const f=(0,a.consumeRemoteApi)({baseChannel:"bitcoin-wallet-manager",properties:w.bitcoinWalletManagerProperties},{logger:g.logger,runtime:v.runtime});const b=[u.Wallet.KeyManagement.errors.AuthenticationError,u.Wallet.KeyManagement.errors.HwMappingError,u.Wallet.KeyManagement.errors.InvalidMnemonicError,u.Wallet.KeyManagement.errors.InvalidSerializableDataError,u.Wallet.KeyManagement.errors.ProofGenerationError,u.Wallet.KeyManagement.errors.TransportError,u.Wallet.InputSelectionError,u.Wallet.TxSubmissionError];const E=(0,a.consumeRemoteApi)({baseChannel:(0,n.walletChannel)("lace"),properties:o.observableWalletProperties,errorTypes:b},{logger:g.logger,runtime:v.runtime});const C=(0,a.consumeRemoteApi)({baseChannel:(0,n.repositoryChannel)("lace"),properties:o.walletRepositoryProperties,errorTypes:[r.WalletConflictError]},{logger:g.logger,runtime:v.runtime});const T=(0,a.consumeRemoteApi)({baseChannel:"bitcoin-wallet",properties:w.bitcoinWalletProperties,errorTypes:[Error]},{logger:g.logger,runtime:v.runtime});const k=(0,i.createKeyAgentFactory)({getBip32Ed25519:u.Wallet.getBip32Ed25519,logger:g.logger});const h=new l.SigningCoordinator({hwOptions:{manifest:u.Wallet.manifest,communicationType:u.Wallet.KeyManagement.CommunicationType.Web}},{keyAgentFactory:k,logger:g.logger});(0,c.exposeSigningCoordinatorApi)({signingCoordinator:h},{logger:g.logger,runtime:v.runtime});const withSignTxConfirmation=async(e,t)=>{const s=h.transactionWitnessRequest$.subscribe(async e=>{try{if(e.walletType===d.WalletType.InMemory){if("string"!=typeof t){throw new TypeError("Invalid state: expected password for in-memory wallet")}const s=S.from(t,"utf8");await e.sign(s).finally(()=>s.fill(0))}else{await e.sign()}}catch{}});try{return await e()}finally{s.unsubscribe();t=""}};const createPassphrase=e=>S.from(e.value||"","utf8");const withSignDataConfirmation=async(e,t,s)=>{const a=h.signDataRequest$.pipe(mergeMap(e=>e.walletType===WalletType.InMemory?of(t).pipe(map(createPassphrase),mergeMap(t=>from(e.sign(t)).pipe(finalize(()=>{t.fill(0)})))):from(e.sign()))).subscribe();try{return await e()}finally{a.unsubscribe();s()}};const R=window;R.walletRepository=C;R.walletManager=y;R.firstValueFrom=m.firstValueFrom},"./src/multichain/BlockchainProvider.tsx":(e,t,s)=>{s.d(t,{Blockchain:()=>n,useCurrentBlockchain:()=>useCurrentBlockchain});var a=s("../../node_modules/react/index.js");var n;(function(e){e["Cardano"]="cardano";e["Bitcoin"]="bitcoin"})(n||(n={}));const o=(0,a.createContext)({blockchain:n.Cardano,setBlockchain:()=>{}});const BlockchainProvider=({children:e})=>{const[t,s]=useState(n.Cardano);return React.createElement(o.Provider,{value:{blockchain:t,setBlockchain:s}},e)};const useCurrentBlockchain=()=>(0,a.useContext)(o)},"./src/providers/AnalyticsProvider/analyticsTracker/events/nami-migration.ts":(e,t,s)=>{const createEvent=e=>`nami tool | lace | ${e}`;const a={onboarding:{OPEN:createEvent("open"),ANALYTICS_AGREE_CLICK:createEvent("analytics banner | agree | click"),INTRODUCTION_STEP:createEvent("introduction step | pageview"),CUSTOMIZE_STEP:createEvent("customize step | pageview"),CUSTOMIZE_STEP_LACE_TAB_CLICK:createEvent("customize step | lace tab | click"),CUSTOMIZE_STEP_NAMI_TAB_CLICK:createEvent("customize step | nami tab | click"),CUSTOMIZE_STEP_LACE_MODE_CLICK:createEvent("customize step | lace mode | click"),CUSTOMIZE_STEP_NAMI_MODE_CLICK:createEvent("customize step | nami mode | click"),MIGRATION_COMPLETE:createEvent("migration successful"),MIGRATION_ERROR:createEvent("migration error")}}},"./src/providers/AnalyticsProvider/analyticsTracker/events/onboarding.ts":(e,t,s)=>{const makeOnboardingEvent=e=>`onboarding | ${e}`;const makeOnboardingCreateEvent=e=>`onboarding | new wallet revamp | ${e}`;const makeOnboardingRestoreEvent=e=>`onboarding | restore wallet revamp | ${e}`;const makeOnboardingHardwareEvent=e=>`onboarding | hardware wallet revamp | ${e}`;const makeForgotPasswordEvent=e=>`unlock wallet | forgot password? | ${e}`;const makePaperWalletOnboardingCreateEvent=e=>`onboarding | new wallet revamp paper wallet | ${e}`;const makePaperWalletOnboardingRestoreEvent=e=>`onboarding | restore wallet revamp paper wallet | ${e}`;const a={onboarding:{ANALYTICS_AGREE_CLICK:makeOnboardingEvent("analytics banner | agree | click"),ANALYTICS_REJECT_CLICK:makeOnboardingEvent("analytics banner | reject | click"),LEARN_MORE_CLICK:makeOnboardingEvent("analytics banner | learn more | click"),GOT_IT_CLICK:makeOnboardingEvent("help us improve your experience | got it | click"),PIN_EXTENSION_CLICK:makeOnboardingEvent("lace main view | pin the wallet extension | click")},create:{CHOOSE_RECOVERY_MODE_MNEMONIC_CLICK:makePaperWalletOnboardingCreateEvent("choose mode | recovery phrase | click"),CHOOSE_RECOVERY_MODE_PAPER_CLICK:makePaperWalletOnboardingCreateEvent("choose mode | paper wallet | click"),CHOOSE_RECOVERY_MODE_NEXT_CLICK:makePaperWalletOnboardingCreateEvent("choose mode | next | click"),PGP_PUBLIC_KEY_PAGE_VIEW:makePaperWalletOnboardingCreateEvent("step: pgp key | pageview"),PGP_PUBLIC_KEY_NEXT_CLICK:makePaperWalletOnboardingCreateEvent("step: pgp key | next | click"),WALLET_SETUP_GENERATE_PAPER_WALLET_CLICK:makePaperWalletOnboardingCreateEvent("step: wallet info | Generate paper wallet | click"),PAPER_WALLET_DOWNLOAD_PAGEVIEW:makePaperWalletOnboardingCreateEvent("step: download pdf | pageview"),DOWNLOAD_PAPER_WALLET_CLICK:makePaperWalletOnboardingCreateEvent("download pdf | download pdf | click"),PRINT_PAPER_WALLET_CLICK:makePaperWalletOnboardingCreateEvent("print pdf | print pdf | click"),PAPER_WALLET_COMPLETE_CLICK:makePaperWalletOnboardingCreateEvent("open wallet | open wallet | click"),SETUP_OPTION_CLICK:makeOnboardingCreateEvent("create | click"),SAVE_RECOVERY_PHRASE_NEXT_CLICK:makeOnboardingCreateEvent("save your recovery phrase | next | click"),ENTER_RECOVERY_PHRASE_NEXT_CLICK:makeOnboardingCreateEvent("enter your recovery phrase | next | click"),ENTER_WALLET:makeOnboardingCreateEvent("let's set up your new wallet | enter wallet | click"),RECOVERY_PHRASE_INTRO_WATCH_VIDEO_CLICK:makeOnboardingCreateEvent("save your recovery phrase | watch video | click"),RECOVERY_PHRASE_INTRO_VIDEO_GOTIT_CLICK:makeOnboardingCreateEvent("keeping your wallet secure | got it | click"),RECOVERY_PHRASE_COPY_TO_CLIPBOARD_CLICK:makeOnboardingCreateEvent("save your recovery phrase | copy to clipboard | click"),RECOVERY_PHRASE_PASTE_FROM_CLIPBOARD_CLICK:makeOnboardingCreateEvent("enter your recovery phrase | paste from clipboard | click"),RECOVERY_PHRASE_COPY_READ_MORE_CLICK:makeOnboardingCreateEvent("save your recovery phrase | best practices faq | click"),RECOVERY_PHRASE_PASTE_READ_MORE_CLICK:makeOnboardingCreateEvent("enter your recovery phrase | best practices faq | click"),WALLET_ADDED:makeOnboardingCreateEvent("added")},restore:{WALLET_SETUP_PAGEVIEW:makePaperWalletOnboardingCreateEvent("step: wallet info | pageview"),CHOOSE_RECOVERY_MODE_MNEMONIC_CLICK:makePaperWalletOnboardingRestoreEvent("choose mode | recovery phrase | click"),CHOOSE_RECOVERY_MODE_PAPER_CLICK:makePaperWalletOnboardingRestoreEvent("choose mode | paper wallet | click"),CHOOSE_RECOVERY_MODE_NEXT_CLICK:makePaperWalletOnboardingRestoreEvent("choose mode | next | click"),SCAN_QR_CODE_PAGEVIEW:makePaperWalletOnboardingRestoreEvent("step: scan qr code | pageview"),SCAN_QR_CODE_CAMERA_OK:makePaperWalletOnboardingRestoreEvent("step: scan qr code | camera ok"),SCAN_QR_CODE_CAMERA_ERROR:makePaperWalletOnboardingRestoreEvent("step: scan qr code | camera error"),SCAN_QR_CODE_READ_SUCCESS:makePaperWalletOnboardingRestoreEvent("step: scan qr code | read success"),SCAN_QR_CODE_READ_ERROR:makePaperWalletOnboardingRestoreEvent("step: scan qr code | read error"),WALLET_OVERVIEW_NEXT_CLICK:makePaperWalletOnboardingRestoreEvent("step: wallet overview | next | click"),ENTER_PGP_PRIVATE_KEY_PAGE_VIEW:makePaperWalletOnboardingRestoreEvent("step: pgp private key | pageview"),ENTER_PGP_PRIVATE_KEY_NEXT_CLICK:makePaperWalletOnboardingRestoreEvent("step: pgp private key | next | click"),SETUP_OPTION_CLICK:makeOnboardingRestoreEvent("restore | click"),ENTER_WALLET:makeOnboardingRestoreEvent("let's set up your new wallet | enter wallet | click"),ENTER_RECOVERY_PHRASE_NEXT_CLICK:makeOnboardingRestoreEvent(" enter your recovery phrase  | next | click"),RECOVERY_PHRASE_PASTE_FROM_CLIPBOARD_CLICK:makeOnboardingRestoreEvent("enter your recovery phrase | paste from clipboard | click"),RECOVERY_PHRASE_PASTE_READ_MORE_CLICK:makeOnboardingRestoreEvent("enter your recovery phrase | best practices faq | click"),WALLET_ADDED:makeOnboardingRestoreEvent("added"),HD_WALLET:makeOnboardingRestoreEvent("hd wallet")},hw:{SETUP_OPTION_CLICK:makeOnboardingHardwareEvent("connect | click"),CONNECT_HW_VIEW:makeOnboardingHardwareEvent("connect your device | view"),HW_POPUP_CONNECT_CLICK:makeOnboardingHardwareEvent("native browser pop-up with HWs | connect | click"),CONNECT_HW_TRY_AGAIN_CLICK:makeOnboardingHardwareEvent("connect your device | try again | click"),SETUP_HW_ACCOUNT_NO_CLICK:makeOnboardingHardwareEvent("let's set up your wallet | Account No | click"),ENTER_WALLET:makeOnboardingHardwareEvent("let's set up your wallet | enter wallet | click"),WALLET_ADDED:makeOnboardingHardwareEvent("added"),HD_WALLET:makeOnboardingHardwareEvent("hd wallet")},forgot_password:{ENTER_RECOVERY_PHRASE_NEXT_CLICK:makeForgotPasswordEvent("enter your recovery phrase | next | click"),ENTER_WALLET:makeForgotPasswordEvent("set up your password | enter wallet | click"),RECOVERY_PHRASE_PASTE_FROM_CLIPBOARD_CLICK:makeForgotPasswordEvent("enter your recovery phrase | paste from clipboard | click")}};const n=null},"./src/providers/AnalyticsProvider/analyticsTracker/index.ts":(e,t,s)=>{s.d(t,{AnalyticsTracker:()=>i.AnalyticsTracker,EnhancedAnalyticsOptInStatus:()=>r.EnhancedAnalyticsOptInStatus,ExtensionViews:()=>r.ExtensionViews,PostHogAction:()=>r.PostHogAction,TX_CREATION_TYPE_KEY:()=>r.TX_CREATION_TYPE_KEY,TxCreationType:()=>r.TxCreationType,TxRecipientType:()=>r.TxRecipientType});var a=s("./src/providers/AnalyticsProvider/analyticsTracker/events/multi-wallet.ts");var n=s("./src/providers/AnalyticsProvider/analyticsTracker/events/onboarding.ts");var o=s("./src/providers/AnalyticsProvider/analyticsTracker/events/nami-migration.ts");var r=s("./src/providers/AnalyticsProvider/analyticsTracker/types.ts");var i=s("./src/providers/AnalyticsProvider/analyticsTracker/AnalyticsTracker.ts")},"./src/providers/BackgroundPageProvider/index.ts":(e,t,s)=>{s.d(t,{useBackgroundPage:()=>useBackgroundPage});var a=s("../../node_modules/react/index.js");const n=(0,a.createContext)(null);const useBackgroundPage=()=>{const e=(0,a.useContext)(n);if(null===e)throw new Error("BackgroundPageContext not defined");return e};const BackgroundPageProvider=({children:e})=>{const[t,s]=useState();const a=useCallback(e=>{s(e)},[s]);return React.createElement(n.Provider,{value:{page:t,setBackgroundPage:a}},e)}},"./src/providers/DatabaseProvider/index.ts":(e,t,s)=>{s.d(t,{DatabaseProvider:()=>a.DatabaseProvider,useDatabaseContext:()=>a.useDatabaseContext});var a=s("./src/providers/DatabaseProvider/context.tsx")},"./src/providers/TxWitnessRequestProvider/index.ts":(e,t,s)=>{s.d(t,{TxWitnessRequestProvider:()=>TxWitnessRequestProvider,useTxWitnessRequest:()=>useTxWitnessRequest});var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-router/esm/react-router.js");var o=s("./src/lib/wallet-api-ui.ts");var r=s("../../node_modules/rxjs/dist/esm5/internal/operators/take.js");var i=s("./src/routes/index.ts");var l=s("./src/features/dapp/components/confirm-transaction/utils.ts");const c=(0,a.createContext)(null);const useTxWitnessRequest=()=>{const e=(0,a.useContext)(c);if(null===e)throw new Error("TxWitnessRequestContext not defined");return e};const TxWitnessRequestProvider=({children:e})=>{const[t,s]=(0,a.useState)();const d=(0,n.useLocation)();(0,a.useEffect)(()=>{if(d.pathname!==i.dAppRoutePaths.dappSignTx){return()=>void 0}const e=o.signingCoordinator.transactionWitnessRequest$.pipe((0,r.take)(1)).subscribe(async e=>{s(e)});const t=(0,l.readyToSign)();return()=>{e.unsubscribe();t.shutdown()}},[d.pathname,s]);return a.createElement(c.Provider,{value:t},e)}},"./src/providers/UIThemeProvider/index.ts":(e,t,s)=>{s.d(t,{UIThemeProvider:()=>a.UIThemeProvider});var a=s("./src/providers/UIThemeProvider/context.tsx")},"./src/providers/ViewFlowProvider/index.ts":(e,t,s)=>{s.d(t,{ViewFlowProvider:()=>ViewFlowProvider,useViewsFlowContext:()=>useViewsFlowContext});var a=s("../../node_modules/react/index.js");const useViewsFlowState=e=>{const[t,s]=(0,a.useState)(e.initial);const[n,o]=(0,a.useState)();const[r,i]=(0,a.useState)();const[l,c]=(0,a.useState)();const renderCurrentView=()=>e.states[t].action(t);const setPreviousView=()=>{const a=e.states[t].prev;s(a)};const[d,u]=(0,a.useState)();const setNextView=()=>{const a=e.states[t].next;s(a)};return{currentView:t,utils:{renderCurrentView,setPreviousView,setNextView},dappInfo:n,setDappInfo:o,signTxRequest:{set:i,request:r},signDataRequest:{set:c,request:l},signError:{set:u,error:d}}};const n=(0,a.createContext)(null);const useViewsFlowContext=()=>{const e=(0,a.useContext)(n);if(null===e)throw new Error("ViewsFlowContext not defined");return e};const ViewFlowProvider=({children:e,viewStates:t})=>a.createElement(n.Provider,{value:useViewsFlowState(t)},e)},"./src/providers/index.ts":(e,t,s)=>{s.d(t,{AnalyticsProvider:()=>c.AnalyticsProvider,AppSettingsProvider:()=>a.AppSettingsProvider,DatabaseProvider:()=>o.DatabaseProvider,ExternalLinkOpenerProvider:()=>r.ExternalLinkOpenerProvider,ViewFlowProvider:()=>l.ViewFlowProvider,useAnalyticsContext:()=>c.useAnalyticsContext,useAppSettingsContext:()=>a.useAppSettingsContext,useBackgroundServiceAPIContext:()=>d.useBackgroundServiceAPIContext,useCurrencyStore:()=>n.useCurrencyStore,useExternalLinkOpener:()=>r.useExternalLinkOpener,useTheme:()=>i.useTheme,useViewsFlowContext:()=>l.useViewsFlowContext});var a=s("./src/providers/AppSettings/index.ts");var n=s("./src/providers/currency/index.ts");var o=s("./src/providers/DatabaseProvider/index.ts");var r=s("./src/providers/ExternalLinkOpenerProvider/index.ts");var i=s("./src/providers/ThemeProvider/index.ts");var l=s("./src/providers/ViewFlowProvider/index.ts");var c=s("./src/providers/AnalyticsProvider/index.ts");var d=s("./src/providers/BackgroundServiceAPI/index.ts");var u=s("./src/providers/UIThemeProvider/index.ts")},"./src/routes/DappConnectorView.tsx":(e,t,s)=>{s.d(t,{DappConnectorView:()=>DappConnectorView});var a=s("../../node_modules/react/index.js");var n=s("./src/stores/index.ts");var o=s("./src/features/unlock-wallet/index.ts");var r=s("./src/hooks/index.ts");var i=s("./src/routes/index.ts");var l=s("./src/lib/i18n.ts");var c=s("../../node_modules/react-router/esm/react-router.js");var d=s("./src/components/Layout/index.ts");var u=s("./src/features/dapp/index.ts");var m=s("../../packages/common/dist/index.esm.js");var v=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var y=s.n(S);var f=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var b=s.n(f);var E=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var C=s.n(E);var T=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var k=s.n(T);var h=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/routes/DappConnectorView.module.scss");var R={};R.styleTagTransform=k();R.setAttributes=b();R.insert=y().bind(null,"head");R.domAPI=w();R.insertStyleElement=C();var A=p()(h["default"],R);const x=h["default"]&&h["default"].locals?h["default"].locals:void 0;var P=s("./src/features/unlock-wallet/selectors.ts");var I=s("./src/providers/index.ts");var _=s("../../node_modules/dayjs/dayjs.min.js");var D=s.n(_);var N=s("../../node_modules/dayjs/plugin/duration.js");var B=s.n(N);var O=s("./src/features/dapp/components/DappError.tsx");var j=s("../../node_modules/webextension-polyfill/dist/browser-polyfill.js");var V=s("../../node_modules/react-i18next/dist/es/index.js");var W=s("./src/features/dapp/components/DappSignDataSuccess.tsx");var M=s("./src/features/dapp/components/DappSignDataFail.tsx");var L=s("./src/components/ErrorBoundary/index.ts");var F=s("./src/hooks/useFatalError.ts");var H=s("./src/utils/constants.ts");var $=s("./src/utils/remove-reloader-if-exists.ts");var U=s("./src/features/dapp/config/index.ts");D().extend(B());const DappSignTxRoutes=()=>a.createElement(I.ViewFlowProvider,{viewStates:U.sendViewsFlowState},a.createElement(c.Switch,null,a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappSignTx,component:u.DappSignTx}),a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappTxSignSuccess,component:u.DappTransactionSuccess}),a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappTxSignFailure,component:u.DappTransactionFail})));const DappSignDataRoutes=()=>a.createElement(I.ViewFlowProvider,{viewStates:U.signDataViewsFlowState},a.createElement(c.Switch,null,a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappSignData,component:u.DappSignData}),a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappDataSignSuccess,component:W.DappSignDataSuccess}),a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappDataSignFailure,component:M.DappSignDataFail})));const isLastValidationExpired=(e,t)=>{const s=D()(Number(e));const a=s.add(D().duration({days:Number(t)}));return a.isBefore(D()())};const DappConnectorView=()=>{const{t:e}=(0,V.useTranslation)();const t=(0,c.useLocation)();const[{lastMnemonicVerification:s,mnemonicVerificationFrequency:l}]=(0,I.useAppSettingsContext)();const{cardanoWallet:v,hdDiscoveryStatus:p}=(0,n.useWalletStore)();const{isWalletLocked:g,walletLock:w}=(0,n.useWalletStore)(P.lockWalletSelector);const S=(0,n.useWalletStore)(e=>e.isSharedWallet);const[y,f]=(0,a.useState)(false);(0,r.useAppInit)();(0,a.useEffect)(()=>{const load=async()=>{if(null===v&&!g())f(true)};load()},[g,v]);(0,a.useEffect)(()=>{if(navigator.userAgent.includes("Win")){const e=H.POPUP_WINDOW.width+(window.outerWidth-window.innerWidth);const t=H.POPUP_WINDOW.height+(window.outerHeight-window.innerHeight);window.resizeTo(e,t)}},[]);const b=(0,a.useMemo)(()=>"Idle"!==p,[p]);const E=(0,F.useFatalError)();(0,a.useEffect)(()=>{if(!b||E)(0,$.removePreloaderIfExists)()},[b,E]);const C=(0,a.useCallback)(()=>{j.tabs.create({url:`app.html#${i.walletRoutePaths.setup.home}`});window.close()},[]);if(E){return a.createElement(L.Crash,null)}if(y){return a.createElement(d.MainLayout,{useSimpleHeader:true,hideFooter:true,showAnnouncement:false},a.createElement(O.DappError,{title:e("dapp.noWallet.heading"),description:e("dapp.noWallet.description"),closeButtonLabel:e("dapp.noWallet.closeButton"),onCloseClick:C,containerTestId:"no-wallet-container",imageTestId:"no-wallet-image",titleTestId:"no-wallet-heading",descriptionTestId:"no-wallet-description",closeButtonTestId:"create-or-restore-wallet-btn"}))}if(S){return a.createElement(d.MainLayout,{useSimpleHeader:true,hideFooter:true,showAnnouncement:false},a.createElement(O.DappError,{title:e("dapp.sharedWallet.heading"),description:e("dapp.sharedWallet.description"),closeButtonLabel:e("dapp.sharedWallet.closeButton"),onCloseClick:C,containerTestId:"no-wallet-container",imageTestId:"no-wallet-image",titleTestId:"no-wallet-heading",descriptionTestId:"no-wallet-description",closeButtonTestId:"create-or-restore-wallet-btn"}))}const checkMnemonicVerificationFrequency=()=>l&&isLastValidationExpired(s,l);if(checkMnemonicVerificationFrequency()&&w){return a.createElement(o.UnlockWalletContainer,{validateMnemonic:true})}if(g()){return a.createElement(o.UnlockWalletContainer,null)}if(b)return a.createElement(m.Loader,{className:x.loader});const T=t.pathname.startsWith(i.dAppRoutePaths.dappSignTxRoot);const k=t.pathname.startsWith(i.dAppRoutePaths.dappSignDataRoot);console.log(t);return a.createElement(d.MainLayout,{useSimpleHeader:true,hideFooter:true,showAnnouncement:false},a.createElement(c.Switch,null,a.createElement(c.Route,{exact:true,path:i.dAppRoutePaths.dappConnect,component:u.Connect}),T&&a.createElement(DappSignTxRoutes,null),k&&a.createElement(DappSignDataRoutes,null)))}},"./src/routes/index.ts":(e,t,s)=>{s.d(t,{DappConnectorView:()=>o.DappConnectorView,dAppRoutePaths:()=>n.dAppRoutePaths,walletRoutePaths:()=>n.walletRoutePaths});var a=s("./src/routes/PopupView.tsx");var n=s("./src/routes/wallet-paths.ts");var o=s("./src/routes/DappConnectorView.tsx")},"./src/stores/index.ts":(e,t,s)=>{s.d(t,{StoreProvider:()=>a.StoreProvider,useSyncStatus:()=>o.useSyncStatus,useWalletStore:()=>a.useWalletStore});var a=s("./src/stores/StoreProvider.tsx");var n=s("./src/stores/types.ts");var o=s("./src/stores/selectors/index.ts")},"./src/stores/selectors/staking-selectors.ts":(e,t,s)=>{var a=s("./src/stores/index.ts");const stakingInfoSelector=({networkInfo:e,fetchNetworkInfo:t})=>({networkInfo:e,fetchNetworkInfo:t});const networkInfoStatusSelector=({networkStateStatus:e})=>e===StateStatus.LOADING||e===StateStatus.IDLE;const stakePoolResultsSelector=({stakePoolSearchResults:e,selectedStakePool:t,stakePoolSearchResultsStatus:s,fetchStakePools:a,setSelectedStakePool:n,resetStakePools:o})=>({stakePoolSearchResults:e,selectedStakePool:t,isSearching:s===StateStatus.LOADING,fetchStakePools:a,setSelectedStakePool:n,resetStakePools:o})},"./src/stores/slices/index.ts":(e,t,s)=>{s.d(t,{activityDetailSlice:()=>l.activityDetailSlice,bitcoinBlockchainProviderSlice:()=>d.bitcoinBlockchainProviderSlice,blockchainProviderSlice:()=>d.blockchainProviderSlice,getProviders:()=>d.getProviders,lockSlice:()=>i.lockSlice,networkSlice:()=>a.networkSlice,stakePoolSearchSlice:()=>n.stakePoolSearchSlice,uiSlice:()=>c.uiSlice,walletActivitiesSlice:()=>o.walletActivitiesSlice,walletInfoSlice:()=>r.walletInfoSlice});var a=s("./src/stores/slices/network-slice.ts");var n=s("./src/stores/slices/stake-pool-search-slice.ts");var o=s("./src/stores/slices/wallet-activities-slice.ts");var r=s("./src/stores/slices/wallet-info-slice.ts");var i=s("./src/stores/slices/lock-slice.ts");var l=s("./src/stores/slices/activity-detail-slice.ts");var c=s("./src/stores/slices/ui-slice.ts");var d=s("./src/stores/slices/blockchain-provider-slice.ts")},"./src/stores/slices/wallet-activities-slice.ts":(e,t,s)=>{s.d(t,{walletActivitiesSlice:()=>walletActivitiesSlice});var a=s("../../node_modules/lodash/flattenDeep.js");var n=s.n(a);var o=s("../../node_modules/lodash/uniq.js");var r=s.n(o);var i=s("../../node_modules/bignumber.js/bignumber.js");var l=s.n(i);var c=s("../../node_modules/lodash/groupBy.js");var d=s.n(c);var u=s("../../node_modules/lodash/flatten.js");var m=s.n(u);var v=s("../../node_modules/lodash/memoize.js");var p=s.n(v);var g=s("../../packages/cardano/dist/index.esm.js");var w=s("../../node_modules/@cardano-sdk/core/dist/esm/util/slotCalc.js");var S=s("../../node_modules/@cardano-sdk/core/dist/esm/Serialization/Transaction.js");var y=s("./src/views/browser-view/features/activity/helpers/index.ts");var f=s("../../packages/core/dist/index.esm.js");var b=s("./src/types/index.ts");var E=s("./src/utils/tx-inspection.ts");var C=s("./src/utils/assets-transformers.ts");var T=s("./src/stores/types.ts");var k=s("./src/utils/get-assets-information.ts");var h=s("./src/views/browser-view/features/activity/helpers/reward-history-transformer.ts");var R=s("../../node_modules/@cardano-sdk/wallet/dist/esm/types.js");const isDelegationActivity=e=>e.type in f.DelegationActivityType||e.type===f.ConwayEraCertificatesTypes.Registration||e.type===f.ConwayEraCertificatesTypes.Unregistration;const getDelegationAmount=e=>{const t=new(l())(Number.parseFloat(e.fee));if(e.type===f.DelegationActivityType.delegationRegistration||e.type===f.ConwayEraCertificatesTypes.Registration){return t.plus(e.deposit).negated()}if(e.type===f.DelegationActivityType.delegationDeregistration||e.type===f.ConwayEraCertificatesTypes.Unregistration){return new(l())(e.depositReclaim).minus(t)}return t.negated()};const A=2;const getFiatAmount=(e,t)=>t?e.times(new(l())(t)).toFormat(A):"";const x=2;const getRewardSpendableDate=(e,t)=>{const s=g.Wallet.createSlotTimeCalc(t);return s((0,w.epochSlotsCalc)(e,t).firstSlot)};const P={walletActivities:[],activitiesCount:0,walletActivitiesStatus:T.StateStatus.IDLE};const I=p()(async({addresses:e,transactions:t,eraSummaries:s,protocolParameters:a,assetInfo:o,delegation:{rewardsHistory:i}},{fiatCurrency:l,cardanoFiatPrice:c,sendAnalytics:u,withLimitedRewardsHistory:v=false},{assetDetails:p,assetProvider:w,cardanoCoin:T,setRewardsActivityDetail:A,setTransactionActivityDetail:P,isSharedWallet:I,inputResolver:_})=>{var D;const epochRewardsMapper=(e,t)=>{const a=e+x;const n=getRewardSpendableDate(a,s);const o=(0,h.rewardHistoryTransformer)({rewards:t,fiatCurrency:l,fiatPrice:c,cardanoCoin:T,date:n});return{...o,onClick:()=>{if(u)u();A({activity:{rewards:t,spendableEpoch:a,spendableDate:n}})}}};const{resolveInput:N}=_;const B=e.filter(R.isKeyHashAddress);if(B.length!==e.length){throw new Error("TODO: implement script address support")}const historicTransactionMapper=async({tx:e})=>{const t=g.Wallet.createSlotTimeCalc(s);const n=t(e.blockHeader.slot);const o=await (0,y.txHistoryTransformer)({tx:e,walletAddresses:B,fiatCurrency:l,fiatPrice:c,date:n,protocolParameters:a,cardanoCoin:T,resolveInput:N,isSharedWallet:I});const extendWithClickHandler=t=>({...t,onClick:()=>{if(u)u();P({activity:e,direction:t.direction,status:t.status,type:t.type})}});return o.map(e=>extendWithClickHandler(e))};const pendingTransactionMapper=async(e,t)=>{let n;if("submittedAt"in e){try{const o=g.Wallet.createSlotTimeCalc(s);n=o(e.submittedAt)}catch{n=new Date}}const r=await (0,y.pendingTxTransformer)({tx:e,walletAddresses:B,fiatPrice:c,fiatCurrency:l,protocolParameters:a,cardanoCoin:T,date:n,resolveInput:N,status:t,isSharedWallet:I});const extendWithClickHandler=t=>({...t,onClick:()=>{if(u)u();const s=S.TxCBOR.deserialize(e.cbor);P({activity:s,direction:b.TxDirections.Outgoing,status:f.ActivityStatus.PENDING,type:t.type})}});return r.map(e=>extendWithClickHandler(e))};const filterTransactionByAssetId=async t=>{const s=await Promise.all(t.map(async e=>{const t=await (0,E.inspectTxType)({walletAddresses:B,tx:e,inputResolver:_,isSharedWallet:I});return{tx:e,type:t}}));return s.filter(({tx:t,type:s})=>{const a=(0,E.getTxDirection)({type:s});const n=e.map(e=>e.address);return(0,y.filterOutputsByTxDirection)(t.body.outputs,a,n).some(e=>{var t;return(0,y.isTxWithAssets)(g.Wallet.Cardano.AssetId(p.id),null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.assets)})})};const getHistoricalTransactions=async()=>{const e=p&&(null==p?void 0:p.id)!==T.id?await filterTransactionByAssetId(t.history):t.history.map(e=>({tx:e}));return m()(await Promise.all(e.map(e=>historicTransactionMapper(e))))};const getPendingTransactions=async()=>m()([...await Promise.all(t.outgoing.inFlight.map(e=>pendingTransactionMapper(e))),...I?await Promise.all(t.outgoing.signed.map(e=>pendingTransactionMapper(e,g.Wallet.TransactionStatus.AWAITING_COSIGNATURES))):[]]);const getRewardsHistory=e=>Object.entries(d()(i.all,({epoch:e})=>e.toString())).map(([e,t])=>epochRewardsMapper(Number(e),t)).filter(t=>t.date.getTime()<Date.now()&&(!e||t.date.getTime()>=e.getTime()));const[O,j]=await Promise.all([getHistoricalTransactions(),getPendingTransactions()]);const V=v?null===(D=O[O.length-1])||void 0===D?void 0:D.date:void 0;const W=p?[]:getRewardsHistory(V);const M=O;const L=j;const F=L.filter(e=>{return M.some(t=>{return(null==t?void 0:t.id)!==(null==e?void 0:e.id)})});const H=[...F,...M,...W];const $=r()(n()(H.map(({assets:e})=>e.map(({id:e})=>g.Wallet.Cardano.AssetId(e)))));const U=await (0,k.getAssetsInformation)($,o,{assetProvider:w,extraData:{nftMetadata:true,tokenMetadata:true}});const K=H.map(e=>{return{...e,...isDelegationActivity(e)&&{amount:`${getDelegationAmount(e)} ${T.symbol}`,fiatAmount:`${getFiatAmount(getDelegationAmount(e),c)} ${l.code}`},assets:e.assets.map(e=>{const t=g.Wallet.Cardano.AssetId(e.id);const s=U.get(t);const a=s?(0,C.assetTransformer)({token:s,key:t,total:{coins:BigInt(0),assets:new Map([[t,BigInt(e.val)]])},fiatCurrency:l}):void 0;return{id:e.id,val:g.Wallet.util.calculateAssetBalance(e.val,s),info:{ticker:(null==a?void 0:a.name)!=="-"&&(null==a?void 0:a.name)||(null==a?void 0:a.ticker)}}})}});const G=d()(K.sort((e,t)=>{var s,a;if(e.status===f.ActivityStatus.AWAITING_COSIGNATURES&&t.status!==f.ActivityStatus.AWAITING_COSIGNATURES)return -1;if(t.status===f.ActivityStatus.AWAITING_COSIGNATURES&&e.status!==f.ActivityStatus.AWAITING_COSIGNATURES)return 1;if(e.status===f.ActivityStatus.PENDING&&t.status!==f.ActivityStatus.PENDING)return -1;if(t.status===f.ActivityStatus.PENDING&&e.status!==f.ActivityStatus.PENDING)return 1;return((null===(s=t.date)||void 0===s?void 0:s.getTime())||0)-((null===(a=e.date)||void 0===a?void 0:a.getTime())||0)}),"formattedDate");const q=Object.entries(G).map(([e,t])=>({title:e,items:t}));return{walletActivities:q,activitiesCount:H.length}},({addresses:e,transactions:t,assetInfo:s,delegation:{rewardsHistory:a}},{cardanoFiatPrice:n,fiatCurrency:o},{cardanoCoin:r,assetDetails:i,isSharedWallet:l})=>{var c,d;return`${t.history.map(({id:e})=>e).join("")}_${t.outgoing.inFlight.map(({id:e,submittedAt:t})=>`${e}_${t}`).join("")}_${null===(c=t.outgoing.signed)||void 0===c?void 0:c.map(({tx:{id:e}})=>e).join("")}_${s.size}_${a.all.length}_${n}_${o.code}_${null==r?void 0:r.id}_${null==i?void 0:i.id}_${null===(d=e[0])||void 0===d?void 0:d.address}_${l}`});const getWalletActivities=async({set:e,get:t,...s})=>{e({walletActivitiesStatus:T.StateStatus.LOADING});const{walletUI:{cardanoCoin:a},walletState:n,setTransactionActivityDetail:o,setRewardsActivityDetail:r,assetDetails:i,blockchainProvider:{assetProvider:l,inputResolver:c},isSharedWallet:d}=t();if(!n){e(P);return}const{walletActivities:u,activitiesCount:m}=await I(n,s,{assetProvider:l,cardanoCoin:a,setRewardsActivityDetail:r,setTransactionActivityDetail:o,assetDetails:i,inputResolver:c,isSharedWallet:d});e({walletActivities:u,activitiesCount:m,walletActivitiesStatus:T.StateStatus.LOADED})};const walletActivitiesSlice=({set:e,get:t})=>({getWalletActivities:({fiatCurrency:s,cardanoFiatPrice:a,sendAnalytics:n,withLimitedRewardsHistory:o})=>getWalletActivities({fiatCurrency:s,cardanoFiatPrice:a,sendAnalytics:n,withLimitedRewardsHistory:o,set:e,get:t}),...P})},"./src/utils/PaperWallet/index.ts":(e,t,s)=>{var a=s("../../node_modules/qrcode/lib/browser.js");var n=s("./src/utils/pgp.ts");var o=s("../../node_modules/buffer/index.js")["Buffer"];const generatePaperWalletPdf=async({mnemonic:e,pgpInfo:t,walletAddress:s,chain:a,walletName:n})=>{try{const r=await readPgpPublicKey({publicKey:t.pgpPublicKey});const i=await encryptMessageWithPgpAsBinaryFormat({publicKey:r,message:e.join(" ")});const l=await QRCode.toDataURL([{mode:"byte",data:i},{mode:"byte",data:o.from(s)},{mode:"byte",data:o.from(a)}],{errorCorrectionLevel:"M",rendererOpts:{quality:1},margin:0});const c=await QRCode.toDataURL(s,{rendererOpts:{quality:1},margin:0});const d=await paperWallet({pgpRef:t.pgpKeyReference,creationDate:new Date().toLocaleDateString(navigator.language,{year:"numeric",month:"long",day:"numeric"}),walletAddress:s,walletName:n,shieldedMessageQrCode:l,publicQrCode:c});const u=new Blob([d.buffer],{type:"application/pdf"});const m=URL.createObjectURL(u);return{error:null,loading:false,url:m,blob:u}}catch(v){return{error:v,loading:false}}}},"./src/utils/assets-transformers.ts":(e,t,s)=>{s.d(t,{assetTransformer:()=>assetTransformer,getTokenAmountInFiat:()=>getTokenAmountInFiat,parseFiat:()=>parseFiat});var a=s("../../node_modules/bignumber.js/bignumber.js");var n=s.n(a);var o=s("./src/api/transformers.ts");var r=s("../../packages/cardano/dist/index.esm.js");var i=s("./src/assets/icons/browser-view/cardano-logo.svg");var l=s("./src/utils/format-number.ts");var c=s("../../node_modules/lodash/isNumber.js");var d=s.n(c);var u=s("./src/utils/get-token-list.ts");var m=s("../../packages/common/dist/index.esm.js");const variationParser=e=>`${e>0?"+":""}${(0,l.formatLocaleNumber)(e.toString())}`;const cardanoTransformer=e=>{const{fiatPrice:t,total:s,cardanoCoin:a,fiatCode:n,areBalancesVisible:o=true,balancesPlaceholder:r=""}=e;const i=walletBalanceTransformer(s.coins.toString(),null==t?void 0:t.price);const l="-"===i.fiatBalance?i.fiatBalance:isNumeric(i.fiatBalance)?formatLocaleNumber(i.fiatBalance):"?";return{id:a.id,logo:CardanoLogo,defaultLogo:CardanoLogo,name:a.name,ticker:a.symbol,price:isNumber(null==t?void 0:t.price)?formatLocaleNumber(t.price.toString(),3):"-",variation:(null==t?void 0:t.priceVariationPercentage24h)?variationParser(t.priceVariationPercentage24h):"-",balance:o?formatLocaleNumber(i.coinBalance):r,fiatBalance:o?`${l} ${n}`:r}};const parseFiat=e=>{if(!e)return e.toString();const t=Math.floor(Math.log10(e));return t<0?e.toFixed(Math.abs(t)):e.toFixed(3)};const assetTransformer=e=>{var t;const{token:s,key:a,total:o,fiat:i,pricesInfo:c,fiatCurrency:d,areBalancesVisible:v=true,balancesPlaceholder:p=""}=e;const{tokenMetadata:g,fingerprint:w,policyId:S}=s;const y=(null==o?void 0:null===(t=o.assets)||void 0===t?void 0:t.get(a))||BigInt(1);const f=r.Wallet.util.calculateAssetBalance(y,s);const b=(null==c?void 0:c.priceInAda)&&i?i*c.priceInAda:void 0;const E=void 0!==g&&void 0!==b?new(n())(f).multipliedBy(b):void 0;const C=(null==c?void 0:c.priceVariationPercentage24h)?variationParser(c.priceVariationPercentage24h):"-";const T=void 0!==b?parseFiat(b):"-";const k=void 0!==E?`${parseFiat(E.toNumber())} ${d.code}`:"-";const h=(0,u.getTokenDisplayMetadata)(s);return{id:a.toString(),logo:h.logo,defaultLogo:(0,m.getRandomIcon)({id:a.toString(),size:30}),name:h.name,ticker:h.description,price:T,variation:C,balance:v?(0,l.compactNumberWithUnit)(f,h.decimals):p,fiatBalance:v?k:p,policyId:S,fingerprint:w,sortBy:{fiatBalance:null==E?void 0:E.toNumber(),metadataName:null==g?void 0:g.name,fingerprint:w,amount:f}}};const getTokenAmountInFiat=(e,t,s)=>new(n())(e).multipliedBy(t).multipliedBy(s).toString();const getTotalAssetsByAddress=(e,t,s)=>{const a=e.filter(e=>e.address===s&&!!e.value.assets).flatMap(e=>[...e.value.assets.keys()]).reduce((e,t)=>e.add(t),new Set);const n=[...a].filter(e=>t.has(e)&&isNFT(t.get(e))).reduce((e,t)=>e.add(t),new Set);return{assets:a.size,nfts:n.size}}},"./src/utils/constants.ts":(e,t,s)=>{s.d(t,{APP_MODE_POPUP:()=>E,CARDANO_COIN_SYMBOL:()=>o,COINGECKO_URL:()=>k,DAPP_CHANNELS:()=>b,DEFAULT_WALLET_BALANCE:()=>u,HW_POPUPS_WIDTH:()=>v,MenuItemList:()=>w,POPUP_WINDOW:()=>S,POPUP_WINDOW_NAMI_TITLE:()=>f,SEND_NFT_DEFAULT_AMOUNT:()=>T,cardanoCoin:()=>i});var a=s("../../packages/cardano/dist/index.esm.js");const n="lace-app";const o={[a.Wallet.Cardano.NetworkId.Mainnet]:"ADA",[a.Wallet.Cardano.NetworkId.Testnet]:"tADA"};const r=10;const i={id:"1",name:"Cardano",decimals:6,symbol:o[a.Wallet.Cardano.NetworkId.Mainnet]};const l=1;const c=5;const d=BigInt(a.Wallet.util.adaToLovelacesString(String(c)));const u={utxo:{total$:{coins:BigInt(0)},available$:{coins:BigInt(0)},unspendable$:{coins:BigInt(0)}},rewardAccounts:{deposit$:BigInt(0),rewards$:BigInt(0)}};const m=[{value:"",label:"Never"},{value:"31",label:"Every month"},{value:"182",label:"Twice a year"},{value:"365",label:"Yearly"}];const v=360;const p=25;const g=664;var w;(function(e){e["ASSETS"]="assets";e["NFT"]="nft";e["TRANSACTIONS"]="transactions";e["STAKING"]="staking";e["DAPPS"]="dapps";e["VOTING"]="voting"})(w||(w={}));const S={width:360,height:630};const y={width:400,height:630};const f="Nami (Lace)";const b={userPrompt:"user-prompt-lace",authenticator:"authenticator-lace",walletApi:"wallet-api-lace",authorizedDapps:"authorized-dapps-lace",originsList:"laceOrigins",dappData:"dapp-data-lace"};const E="popup";const C="browser";const T="1";const k="https://www.coingecko.com";const h="multidelegationFirstVisit";const R="isMultiDelegationDAppCompatibilityModalVisible";const A="stakingBrowserPreferences";const x="popup"},"./src/utils/format-number.ts":(e,t,s)=>{s.d(t,{compactNumberWithUnit:()=>compactNumberWithUnit,formatLocaleNumber:()=>formatLocaleNumber,formatNumberForDisplay:()=>formatNumberForDisplay,handleFormattedValueChange:()=>handleFormattedValueChange});var a=s("../../packages/common/dist/index.esm.js");var n=s("../../node_modules/bignumber.js/bignumber.js");var o=s.n(n);const shortenNumber=(e,t)=>{return t>0&&(null==e?void 0:e.length)>t?`${e.slice(0,t)}`:e};const isNumeric=e=>!new BigNumber(e).isNaN();const formatLocaleNumber=(e,t=a.DEFAULT_DECIMALS)=>new(o())(e).toFormat(t,o().ROUND_DOWN,{groupSize:3,groupSeparator:",",decimalSeparator:"."});const formatNumberForDisplay=(e,t=0)=>{if(!e)return"0";const s=e.replace(/[^\d.]/g,"");const a=s.split(".");const n=formatLocaleNumber(a[0]||"0",0);const o=a.length>2?a.slice(1).join(""):a[1];return a.length>1&&t>0?`${n}.${shortenNumber(o,t)}`:n};const handleFormattedValueChange=({newFormattedValue:e,previousFormattedValue:t},s=0)=>{const a=[...t].findIndex((t,s)=>t!==[...e][s]);if(-1!==a&&","===t[a]&&t.length-e.length===1){if(0===a){const n=e.split(",").join("");return{formattedValue:n?formatNumberForDisplay(n,s):"",value:n,characterOffset:0}}const o=`${e.slice(0,a-1)}${e.slice(a,e.length)}`;const r=o.split(",").join("");return{formattedValue:r?formatNumberForDisplay(r,s):"",value:r,characterOffset:-1}}const i=e.split(",").join("");const l=i?formatNumberForDisplay(i,s):"";return{formattedValue:l,value:i,characterOffset:l.length-e.length}};const compactNumberWithUnit=(e,t=a.DEFAULT_DECIMALS)=>{const s=new(o())(e||0);if(s.isNaN())return formatLocaleNumber("0",t);const{unit:n,unitThreshold:r}=(0,a.getNumberUnit)(s);if(r<a.UnitThreshold.MILLION)return formatLocaleNumber(s.toString(),t);const i=s.dividedBy(r);return`${formatLocaleNumber(i.toString(),t)}${n}`};const formatBalance=e=>{if(e>=1e9){return`${(e/1e9).toFixed(1).replace(/\.0$/,"")}B`}if(e>=1e6){return`${(e/1e6).toFixed(1).replace(/\.0$/,"")}M`}if(e>=1e3){return`${(e/1e3).toFixed(1).replace(/\.0$/,"")}K`}return e.toString()}},"./src/utils/format-string.ts":(e,t,s)=>{s.d(t,{shortenString:()=>shortenString});const shortenString=(e,t)=>{return t>0&&(null==e?void 0:e.length)>t?`${e.slice(0,t)}...`:e};const replaceWhitespace=(e,t="")=>e.replace(/\s/g,t)},"./src/utils/get-transaction-total-output.ts":(e,t,s)=>{s.d(t,{getTransactionTotalOutput:()=>getTransactionTotalOutput});var a=s("../../node_modules/bignumber.js/bignumber.js");var n=s.n(a);const getTransactionTotalOutput=e=>e.reduce((e,t)=>e.plus(t.value.coins.toString()),new(n())(0));const getTransactionTotalOutputByAddress=(e,t)=>e.reduce((e,s)=>{if(s.address===t){return e.plus(s.value.coins.toString())}return e},new BigNumber(0))},"./src/utils/get-wallet-from-storage.ts":(e,t,s)=>{s.d(t,{getWalletFromStorage:()=>getWalletFromStorage});var a=s("./src/utils/local-storage.ts");const getWalletFromStorage=()=>{const e=(0,a.getValueFromLocalStorage)("wallet");return e||void 0}},"./src/utils/pgp.ts":(e,t,s)=>{var a=s("../../node_modules/openpgp/dist/openpgp.min.mjs");var n=s("../../packages/translation/dist/index.esm.js");var o=s("../../packages/common/dist/index.esm.js");const r=null;const i=null;const l=/^-{5}BEGIN PGP (PUBLIC|PRIVATE) KEY BLOCK-{5}[\S\s]+?-{5}END PGP \1 KEY BLOCK-{5}$/;const readPgpPublicKey=async({publicKey:e,config:t})=>{const s=e.trim().replace(/Comment:.*\n?/g,"");const a=s.match(l);if(!a){throw new Error("Misformed armored text")}const n=await readKey({armoredKey:s,config:t});if(n.isPrivate()){throw new Error("PGP key is not public")}const o=await n.getEncryptionKey();if(!o){throw new Error("no valid encryption key packet in key.")}return n};const getFingerprintFromPublicPgpKey=async({publicKeyArmored:e,config:t})=>{const s=await readPgpPublicKey({publicKey:e,config:t});return s.getFingerprint()};const readPgpPrivateKey=async({privateKey:e})=>await readPrivateKey({armoredKey:e});const decryptPgpPrivateKey=async({privateKey:e,passphrase:t})=>await decryptKey({privateKey:e,passphrase:t});const readBinaryPgpMessage=async e=>await readMessage({binaryMessage:e});const encryptMessageWithPgpAsBinaryFormat=async({message:e,publicKey:t,privateKeys:s})=>await encrypt({message:await createMessage({text:e}),encryptionKeys:t,signingKeys:s,format:"binary",config:{deflateLevel:9}});const decryptMessageWithPgp=async({message:e,publicKey:t,privateKey:s,checkSignatures:a=true})=>{const{data:n,signatures:o}=await decrypt({message:e,verificationKeys:t,decryptionKeys:s});if(a&&(null==o?void 0:o.length)>0)o.map(e=>{if(!e.verified)throw new Error(`signature ${e.keyID} not verified`)});return n};const pgpPublicKeyVerification=(e,t)=>async s=>{t({error:null,success:null});if(!s.target.value)return;try{const a=await getFingerprintFromPublicPgpKey({publicKeyArmored:s.target.value.trim()});e(e=>({...e,pgpPublicKey:s.target.value.trim()}));t({error:null,success:a.toUpperCase().match(/.{1,4}/g).join(" ")})}catch(n){if(r.test(n.message))t({error:i18n.t("pgp.error.rsaKeyTooWeak")});else if("no valid encryption key packet in key."===n.message||i.test(n.message))t({error:i18n.t("pgp.error.noValidEncryptionKeyPacket")});else if("PGP key is not public"===n.message)t({error:i18n.t("pgp.error.privateKeySuppliedInsteadOfPublic")});else{logger.error(n);t({error:i18n.t("pgp.error.misformedArmoredText")})}}}},"./src/views/BitcoinDappConnectorView.tsx":(e,t,s)=>{s.d(t,{BitcoinDappConnectorView:()=>BitcoinDappConnectorView});var a=s("../../node_modules/react/index.js");var n=s("./src/features/dapp/components/DappError.tsx");var o=s("./src/utils/remove-reloader-if-exists.ts");var r=s("./src/components/Layout/index.ts");var i=s("../../node_modules/react-i18next/dist/es/index.js");const BitcoinDappConnectorView=()=>{const{t:e}=(0,i.useTranslation)();(0,a.useEffect)(()=>{(0,o.removePreloaderIfExists)()},[]);return a.createElement(r.MainLayout,{showBetaPill:true,useSimpleHeader:true,hideFooter:true,showAnnouncement:false},a.createElement(n.DappError,{title:e("dapp.connector.btc.error.title"),description:e("dapp.connector.btc.error.description"),closeButtonLabel:e("dapp.connector.btc.error.closeButton"),onCloseClick:()=>window.close(),containerTestId:"no-wallet-container",imageTestId:"no-wallet-image",titleTestId:"no-wallet-heading",descriptionTestId:"no-wallet-description",closeButtonTestId:"create-or-restore-wallet-btn"}))}},"./src/views/bitcoin-mode/features/receive-info/components/BitcoinQRInfoWalletDrawer.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/core/dist/index.esm.js");var o=s("./src/providers/ThemeProvider/index.ts");var r=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var i=s.n(r);var l=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var v=s.n(m);var p=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var g=s.n(p);var w=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var S=s.n(w);var y=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/bitcoin-mode/features/receive-info/components/BitcoinQRInfoWalletDrawer.module.scss");var f={};f.styleTagTransform=S();f.setAttributes=v();f.insert=u().bind(null,"head");f.domAPI=c();f.insertStyleElement=g();var b=i()(y["default"],f);const E=y["default"]&&y["default"].locals?y["default"].locals:void 0;var C=s("./src/views/browser-view/stores/index.ts");var T=s("../../packages/common/dist/index.esm.js");var k=s("./src/providers/index.ts");var h=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var R=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var A=s("./src/hooks/index.ts");var x=s("../../node_modules/lodash/isEqual.js");const BitcoinQRInfoWalletDrawer=()=>{const e=useAnalyticsContext();const{theme:t}=useTheme();const[,s]=useDrawer();const{bitcoinWallet:a}=useWalletManager();const[n,o]=useState([]);const[r,i]=useState("");const{getActiveWalletName:l}=useWalletManager();useEffect(()=>{l().then(e=>{i(e)})},[l]);useEffect(()=>{const e=a.addresses$.subscribe(e=>{o(t=>isEqual(t,e)?t:e)});return()=>e.unsubscribe()},[a]);useKeyboardShortcut(["Escape"],()=>s());const handleCopyAddress=()=>{e.sendEventToPostHog(PostHogAction.ReceiveCopyAddressIconClick)};const c=useCallback(()=>getQRCodeOptions(t,ADDRESS_CARD_QR_CODE_SIZE),[t]);return React.createElement(Flex,{flexDirection:"column",justifyContent:"space-between",alignItems:"center"},React.createElement("div",{className:styles.infoContainer},React.createElement(Flex,{flexDirection:"column",gap:"$16"},React.createElement(AddressCard,{name:r,address:n.length>0?n[0].address:"",getQRCodeOptions:c,onCopyClick:handleCopyAddress}))))}},"./src/views/bitcoin-mode/features/send/components/BitcoinSendDrawer.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var o=s("./src/views/bitcoin-mode/features/send/components/SendFlow.tsx");var r=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var i=s.n(r);var l=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var v=s.n(m);var p=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var g=s.n(p);var w=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var S=s.n(w);var y=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/bitcoin-mode/features/send/components/BitcoinSendDrawer.module.scss");var f={};f.styleTagTransform=S();f.setAttributes=v();f.insert=u().bind(null,"head");f.domAPI=c();f.insertStyleElement=g();var b=i()(y["default"],f);const E=y["default"]&&y["default"].locals?y["default"].locals:void 0;const BitcoinSendDrawer=()=>React.createElement(Flex,{className:styles.container,flexDirection:"column",justifyContent:"space-between",alignItems:"center"},React.createElement(SendFlow,null))},"./src/views/bitcoin-mode/features/send/components/PasswordInput.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss");var o=s("../../packages/core/dist/index.esm.js");var r=s("../../packages/common/dist/index.esm.js");var i=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var l=s.n(i);var c=s("./src/lib/wallet-api-ui.ts");var d=s("../../node_modules/react-i18next/dist/es/index.js");const u=null;const PasswordInput=({onSubmit:e,signTransaction:t,isPopupView:s,onClose:a})=>{const{t:n}=useTranslation();const{password:o,setPassword:r,clearSecrets:i}=useSecrets();const[l,c]=useState();const d=useCallback(async s=>{let a;try{const n=createPassphrase(s);c(true);a=await t(n)}catch{c(false);return}await e(a);i()},[i,e,t]);const m=!o.value;const v=useCallback((e,t)=>{e.preventDefault();e.stopPropagation();if(!m)d(t)},[d,m]);useAutoFocus(u,true);return React.createElement(Flex,{flexDirection:"column",w:"$fill",className:styles.container},React.createElement(Flex,{flexDirection:"column",w:"$fill",className:styles.container},s?React.createElement(Text.Heading,{weight:"$bold"},n("browserView.transaction.send.confirmationTitle")):React.createElement(Text.SubHeading,{weight:"$bold"},n("browserView.transaction.send.confirmationTitle")),React.createElement(Box,{mt:s?"$48":"$4"},React.createElement(Text.Body.Normal,{color:"secondary",weight:"$medium"},n("browserView.staking.details.sign.subTitle"))),React.createElement(Flex,{className:styles.container,w:"$fill",alignItems:s?"flex-start":"center",mt:s?"$44":void 0,justifyContent:"center"},React.createElement(Password,{id:u,onSubmit:e=>v(e,o),onChange:r,error:false===l,errorMessage:n("general.errors.invalidPassword"),label:n("browserView.transaction.send.password.placeholder"),autoFocus:true}))),React.createElement(Flex,{w:"$fill",py:"$24",pb:s?"$0":"$24",px:"$40",flexDirection:"column",gap:s?"$8":"$16",className:styles.buttons},React.createElement(Button,{disabled:m,color:"primary",block:true,size:"medium",onClick:()=>d(o),"data-testid":"continue-button"},n("browserView.transaction.send.footer.confirm")),React.createElement(Button,{color:"secondary",block:true,size:"medium",onClick:a,"data-testid":"back-button"},n("browserView.transaction.send.footer.cancel"))))}},"./src/views/bitcoin-mode/features/send/components/ReviewTransaction.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/core/dist/index.esm.js");var o=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var r=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var i=s.n(r);var l=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var v=s.n(m);var p=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var g=s.n(p);var w=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var S=s.n(w);var y=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/bitcoin-mode/features/send/components/ReviewTransaction.module.scss");var f={};f.styleTagTransform=S();f.setAttributes=v();f.insert=u().bind(null,"head");f.domAPI=c();f.insertStyleElement=g();var b=i()(y["default"],f);const E=y["default"]&&y["default"].locals?y["default"].locals:void 0;var C=s("./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss");var T=s("../../packages/common/dist/index.esm.js");var k=s("../../node_modules/react-i18next/dist/es/index.js");const h=1e8;const ReviewTransaction=({unsignedTransaction:e,btcToUsdRate:t,feeRate:s,estimatedTime:a,onConfirm:n,isPopupView:o,onClose:r})=>{const{t:i}=useTranslation();const l=Number(e.amount);const c=l/h*t;const d=e.fee;return React.createElement(Flex,{flexDirection:"column",w:"$fill",className:mainStyles.container},React.createElement(Flex,{className:mainStyles.container,flexDirection:"column",w:"$fill"},o?React.createElement(Text.Heading,{weight:"$bold"},i("browserView.transaction.send.drawer.transactionSummary")):React.createElement(Text.SubHeading,{weight:"$bold"},i("browserView.transaction.send.drawer.transactionSummary")),React.createElement(Box,{mt:o?"$48":"$4"},React.createElement(Text.Body.Normal,{color:"secondary",weight:"$medium"},i("browserView.transaction.send.drawer.breakdownOfYourTransactionCost"))),React.createElement(Box,{w:"$fill",mt:o?"$40":"$96"},React.createElement(RowContainer,null,renderLabel({label:i("browserView.activity.entry.name.sending"),dataTestId:"summary-total-spend"}),React.createElement(Flex,{flexDirection:"column",w:"$fill",alignItems:"flex-end"},React.createElement(Text.Body.Normal,{weight:o?"$medium":"$semibold","data-testid":"output-summary-amount"},Number.parseFloat((l/h).toFixed(8))," BTC"),React.createElement(Text.Body.Normal,{color:"secondary",weight:o?"$medium":"$semibold","data-testid":"output-summary-amount-fiat"},Number.parseFloat(c.toFixed(2))," USD")))),React.createElement(Box,{w:"$fill",mt:o?"$24":"$32"},React.createElement(RowContainer,null,renderLabel({label:i("core.outputSummaryList.recipientAddress"),dataTestId:"output-summary-recipient-title"}),React.createElement(Flex,{flexDirection:"column"},React.createElement(Flex,{flexDirection:"column",w:"$fill",alignItems:"flex-end",gap:"$4"},React.createElement(Text.Address,{className:styles.address,"data-testid":"output-summary-recipient-address"},o?addEllipsis(e.toAddress,12,5):e.toAddress))))),React.createElement(Box,{w:"$fill",mt:o?"$32":"$40",mb:"$8",className:styles.divider}),React.createElement(Box,{w:"$fill",mt:o?"$24":"$32"},React.createElement(RowContainer,null,renderLabel({label:i("browserView.transaction.send.transactionFee"),dataTestId:"summary-fee"}),React.createElement(Flex,{flexDirection:"column",w:"$fill",alignItems:"flex-end",gap:"$4"},React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"output-summary-fee"},Number.parseFloat((Number(d)/h).toFixed(8))," BTC"),React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"output-summary-fee-rate",className:styles.feeRateLabel},(s*h/1e3).toFixed(2)," sats/vB")))),React.createElement(Box,{w:"$fill",mt:o?"$24":"$32"},React.createElement(RowContainer,null,renderLabel({label:i("browserView.transaction.btc.send.time"),dataTestId:"summary-estimated-confirmation-time"}),React.createElement(Flex,{flexDirection:"column",w:"$fill",alignItems:"flex-end",gap:"$4"},React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"output-summary-recipient-address"},a))))),React.createElement(Flex,{w:"$fill",py:"$24",pb:o?"$0":"$24",px:"$40",flexDirection:"column",gap:o?"$8":"$16",className:mainStyles.buttons},React.createElement(Button,{color:"primary",block:true,size:"medium",onClick:n,"data-testid":"continue-button"},i("browserView.transaction.send.footer.confirm")),React.createElement(Button,{color:"secondary",block:true,size:"medium",onClick:r,"data-testid":"back-button"},i("browserView.transaction.send.footer.cancel"))))}},"./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss":(e,t,s)=>{var a=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var n=s.n(a);var o=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var p=s.n(v);var g=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss");var w={};w.styleTagTransform=p();w.setAttributes=d();w.insert=l().bind(null,"head");w.domAPI=r();w.insertStyleElement=m();var S=n()(g["default"],w);var y=g["default"]&&g["default"].locals?g["default"].locals:void 0},"./src/views/bitcoin-mode/features/send/components/SendFlow.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/bitcoin-mode/features/send/components/SendStepOne.tsx");var o=s("./src/views/bitcoin-mode/features/send/components/ReviewTransaction.tsx");var r=s("./src/views/bitcoin-mode/features/send/components/PasswordInput.tsx");var i=s("./src/views/bitcoin-mode/features/send/components/TransactionSuccess.tsx");var l=s("./src/views/bitcoin-mode/features/send/components/TransactionFailed.tsx");var c=s("./src/hooks/index.ts");var d=s("../../packages/common/dist/index.esm.js");var u=s("../../packages/bitcoin/dist/index.esm.js");var m=s("../../packages/cardano/dist/index.esm.js");var v=s("./src/routes/index.ts");var p=s("./src/views/browser-view/stores/index.ts");var g=s("./src/stores/index.ts");var w=s("./src/utils/constants.ts");var S=s("./src/providers/index.ts");var y=s("./src/views/browser-view/components/Drawer/index.ts");var f=s("../../node_modules/react-i18next/dist/es/index.js");var b=s("../../node_modules/buffer/index.js")["Buffer"];const E=1e8;const signTransaction=async(e,t,s)=>{const a=b.from(t,"hex");const n=b.from(await Cardano.KeyManagement.emip3decrypt(a,s));const o=e.signers;const r=[];for(const i of o){const l=Bitcoin.deriveAccountRootKeyPair(n,i.addressType,i.network,i.account);const c=Bitcoin.deriveChildKeyPair(l.pair.privateKey,i.chain,i.index);let d=c.pair;if(i.addressType===Bitcoin.AddressType.Taproot){const u=c.pair.publicKey.slice(1);const m=Bitcoin.tweakTaprootPrivateKey(c.pair.privateKey,u);d={publicKey:c.pair.publicKey,privateKey:b.from(m)}}const v=new Bitcoin.BitcoinSigner(d);r.push(v)}const p=Bitcoin.signTx(e,r);for(const g of r)g.clearSecrets();s.fill(0);n.fill(0);return p};const buildTransaction=({knownAddresses:e,changeAddress:t,recipientAddress:s,feeRate:a,amount:n,utxos:o,network:r})=>new Bitcoin.TransactionBuilder(r,a,e).setChangeAddress(t).setUtxoSet(o).addOutput(s,n).build();const btcStringToSatoshisBigint=e=>{const[t,s=""]=e.split(".");const a=s.padEnd(8,"0").slice(0,8);return BigInt(t)*BigInt(E)+BigInt(a)};const SendFlow=()=>{const{t:e}=useTranslation();const[t,s]=useState("AMOUNT");const[a,n]=useState("");const[o,r]=useState("");const[i,l]=useState(null);const[c,d]=useState(1);const[u,m]=useState("~30 min");const[v,p]=useState(null);const[g,w]=useState(null);const[S,y]=useState(null);const[f,b]=useState(null);const[E,C]=useState(null);const[T,k]=useState(null);const[h,R]=useState("");const[A,x]=useState();const{priceResult:P}=useFetchCoinPrice();const{bitcoinWallet:I}=useWalletManager();var _;const D=useMemo(()=>{var e;return null!==(_=null===(e=P.bitcoin)||void 0===e?void 0:e.price)&&void 0!==_?_:0},[P.bitcoin]);const N=useObservable(I.balance$,BigInt(0));const[B,O]=useDrawer();const j=useRedirection(walletRoutePaths.activity);const V=useRedirection(walletRoutePaths.assets);const W=useAnalyticsContext();const M=useMemo(()=>{if(!S||(null==S?void 0:S.length)===0)return false;if(!g||(null==g?void 0:g.length)===0)return false;for(const e of S){const{inputs:t}=e;for(const s of g){const a=t.some(e=>e.index===s.index&&e.txId===s.txId);if(a){return true}}}return false},[S,g]);const{walletUI:{appMode:L}}=useWalletStore();const F=L===APP_MODE_POPUP;useEffect(()=>{switch(t){case"AMOUNT":W.sendEventToPostHog(PostHogAction.SendClick);break;case"REVIEW":W.sendEventToPostHog(PostHogAction.SendTransactionDataReviewTransactionClick);break;case"DONE":W.sendEventToPostHog(PostHogAction.SendAllDoneView);break;case"FAILED":case"UNAUTHORIZED":W.sendEventToPostHog(PostHogAction.SendSomethingWentWrongView);break;default:break}},[t,W]);useEffect(()=>{I.getNetwork().then(k)},[I]);useEffect(()=>{I.getCurrentFeeMarket().then(p)},[I]);useEffect(()=>{I.addresses$.subscribe(e=>{b(e)})},[I]);useEffect(()=>{I.utxos$.subscribe(w)},[I]);useEffect(()=>{I.pendingTransactions$.subscribe(y)},[I]);useEffect(()=>{I.getInfo().then(e=>{C(e)})},[I]);const H=useCallback(()=>{if(F)V();else(null==B?void 0:B.onClose)?null==B?void 0:B.onClose():O()},[O,B,F,V]);const backToAmount=()=>{s("AMOUNT");O({...B,content:DrawerContent.SEND_BITCOIN_TRANSACTION,renderHeader:()=>React.createElement(DrawerNavigation,{title:React.createElement("div",null,e("browserView.transaction.send.title")),onCloseIconClick:H})})};const goToReview=t=>{d(t);l(buildTransaction({knownAddresses:f,changeAddress:f[0].address,recipientAddress:o,feeRate:t,amount:btcStringToSatoshisBigint(a),utxos:g,network:T}));s("REVIEW");O({...B,content:DrawerContent.SEND_BITCOIN_TRANSACTION,renderHeader:()=>React.createElement(DrawerNavigation,{title:React.createElement("div",null,e("browserView.transaction.send.title")),onCloseIconClick:H,onArrowIconClick:backToAmount})})};const goToPassword=()=>s("PASSWORD");const $=useCallback(async e=>{if(!i||!(null==E?void 0:E.encryptedSecrets.seed))return;return await signTransaction(i,E.encryptedSecrets.seed,e)},[i,E]);const handleSubmitTx=async e=>{try{const t=await I.submitTransaction(e.hex);R(t);s("DONE")}catch(a){x(a);s("FAILED")}};const backToReview=()=>s("REVIEW");if("AMOUNT"===t){return React.createElement(SendStepOne,{onClose:H,isPopupView:F,amount:a,onAmountChange:n,address:o,availableBalance:Number(N),onAddressChange:r,feeMarkets:v,onEstimatedTimeChange:m,onContinue:goToReview,network:T,hasUtxosInMempool:M})}if("REVIEW"===t){return React.createElement(ReviewTransaction,{onClose:H,isPopupView:F,unsignedTransaction:i,btcToUsdRate:D,feeRate:c,estimatedTime:u,onConfirm:goToPassword})}if("PASSWORD"===t){return React.createElement(PasswordInput,{onClose:H,isPopupView:F,onSubmit:handleSubmitTx,signTransaction:$})}if("DONE"===t){return React.createElement(TransactionSuccess,{onClose:H,isPopupView:F,onViewTransaction:()=>{O();j()},hash:h})}if("FAILED"===t){return React.createElement(TransactionFailed,{onClose:H,isPopupView:F,onBack:backToReview,txError:A})}return React.createElement(React.Fragment,null)}},"./src/views/bitcoin-mode/features/send/components/SendStepOne.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/common/dist/index.esm.js");var o=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var w=s.n(g);var S=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/bitcoin-mode/features/send/components/SendStepOne.module.scss");var y={};y.styleTagTransform=w();y.setAttributes=m();y.insert=d().bind(null,"head");y.domAPI=l();y.insertStyleElement=p();var f=r()(S["default"],y);const b=S["default"]&&S["default"].locals?S["default"].locals:void 0;var E=s("./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss");var C=s("../../packages/core/dist/index.esm.js");var T=s("../../node_modules/bignumber.js/bignumber.js");var k=s("./src/hooks/index.ts");var h=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var R=s("../../packages/bitcoin/dist/index.esm.js");var A=s("../../node_modules/react-i18next/dist/es/index.js");var x=s("./src/utils/format-number.ts");const P=1e8;const I=[{key:"fast",label:"Fast",feeRate:10,estimatedTime:"~10 min"},{key:"standard",label:"Average",feeRate:5,estimatedTime:"~30 min"},{key:"slow",label:"Low",feeRate:1,estimatedTime:"~60 min"},{key:"custom",label:"Custom",estimatedTime:"~?? min"}];const InputError=({marginBottom:e,error:t,isPopupView:s})=>React.createElement(Box,{style:{position:"relative"},w:"$fill"},React.createElement(Box,{style:s||e?{}:{position:"absolute",top:0,left:0},pl:"$24",py:"$8"},React.createElement(Text.Body.Small,{color:"error",weight:"$semibold","data-testid":"address-input-error"},t)));const SendStepOne=({amount:e,onAmountChange:t,address:s,onAddressChange:a,availableBalance:n,feeMarkets:o,onEstimatedTimeChange:r,onContinue:i,isPopupView:l,onClose:c,network:d,hasUtxosInMempool:u})=>{var m,v;const{t:p}=useTranslation();const g=Number.parseFloat(e)||0;const w=0===g;const S=g>n/P;const[y,f]=useState(1);const b=useCallback(()=>{return I.map(e=>{var t;return{...e,feeRate:"custom"!==e.key?(null==o?void 0:null===(t=o[e.key])||void 0===t?void 0:t.feeRate)||e.feeRate:e.feeRate}})},[o]);const[E,C]=useState(b());const[T,k]=useState((null===(m=E.find(e=>e.feeRate===y))||void 0===m?void 0:m.key)||(null===(v=E[1])||void 0===v?void 0:v.key));const h=useMemo(()=>E.find(e=>e.key===T),[E,T]);const[R,A]=useState("0");const[x,_]=useState();const[D,N]=useState(false);const[B,O]=useState();useEffect(()=>{_(void 0);if("custom"!==T||!o)return;if(Number.parseFloat(R)<Number.parseFloat((o.slow.feeRate*P/1e3).toFixed(2)))_(p("browserView.transaction.btc.send.error.feeTooLow"));else if(Number.parseFloat(R)>Number.parseFloat((o.fast.feeRate*P/1e3).toFixed(2)))_(p("browserView.transaction.btc.send.error.feeTooHigh"))},[R,o,T,p]);useEffect(()=>{C(b())},[b]);const handleNext=()=>{if(w||S||""===s.trim())return;const e="custom"===T?Number.parseFloat((Number.parseFloat(R)/P*1e3).toFixed(8)):null==h?void 0:h.feeRate;f(e);r(null==h?void 0:h.estimatedTime);i(e)};const{priceResult:j}=useFetchCoinPrice();var V;const W=useMemo(()=>{var e;return null!==(V=null===(e=j.bitcoin)||void 0===e?void 0:e.price)&&void 0!==V?V:0},[j.bitcoin]);const M=useMemo(()=>g*W,[g,W]);const L={id:"btc",ticker:"BTC",balance:`${p("browserView.transaction.btc.send.balance")}: ${(n/P).toFixed(8)}`};const F=`≈ ${new BigNumber(M.toString()).toFixed(2,BigNumber.ROUND_HALF_UP)} USD`;useEffect(()=>{const e=Bitcoin.validateBitcoinAddress(s,d);switch(e){case Bitcoin.AddressValidationResult.Valid:N(true);O(void 0);break;case Bitcoin.AddressValidationResult.InvalidNetwork:N(false);O(p("general.errors.incorrectAddressNetwork"));break;case Bitcoin.AddressValidationResult.InvalidAddress:N(false);O(p("general.errors.incorrectAddress"));break}},[s,d,a,p]);const handleCustomFeeKeyDown=e=>{const t=["-","+","e",","];const s=Number(e.currentTarget.value);if(t.includes(e.key)||"ArrowDown"===e.key&&s<=0)e.preventDefault()};const onCustomFeeBlur=e=>{A(e.target.value||"0")};return React.createElement(Flex,{className:mainStyles.container,flexDirection:"column",w:"$fill"},React.createElement(Flex,{flexDirection:"column",w:"$fill",className:mainStyles.container},l&&React.createElement(Text.Heading,{weight:"$bold"},p("browserView.transaction.send.title")),u&&React.createElement(InputError,{marginBottom:true,error:"You cannot send transactions while previous transactions are still pending.",isPopupView:l}),React.createElement(Search,{disabled:u,value:s,"data-testid":"btc-address-input",label:p("core.destinationAddressInput.recipientAddressOnly"),onChange:e=>a(e),style:{width:"100%"}}),!D&&!!(null==s?void 0:s.length)&&React.createElement(InputError,{error:B,isPopupView:l}),React.createElement(Box,{w:"$fill",mt:l?"$16":"$40",py:"$24",px:"$32",className:styles.amountSection},React.createElement(AssetInput,{disabled:u,inputId:"BTC",coin:L,value:e,onChange:({value:e})=>t(e),fiatValue:F,getErrorMessage:()=>p("general.errors.insufficientBalance"),error:p("general.errors.insufficientBalance"),invalid:S,isPopupView:l,hasMaxBtn:false,displayValue:formatNumberForDisplay(e,15),focused:true})),React.createElement(Box,{mt:l?"$24":"$32"},l?React.createElement(Text.Body.Large,{weight:"$bold"},p("browserView.transaction.btc.send.feeRate")):React.createElement(Text.SubHeading,{weight:"$bold"},p("browserView.transaction.btc.send.feeRate"))),React.createElement(Flex,{mt:l?"$16":"$32",w:"$fill"},React.createElement(ToggleButtonGroup.Root,{disabled:u,onValueChange:e=>{k(e)},value:T},E.map(({key:e,label:t})=>React.createElement(ToggleButtonGroup.Item,{key:e,value:e},t)))),React.createElement(Flex,{w:"$fill",mt:l?"$16":"$32",justifyContent:"space-between",mb:"$8"},"custom"!==T?React.createElement(React.Fragment,null,React.createElement(Text.Body.Normal,{weight:"$semibold"},p("browserView.transaction.send.transactionFee")),React.createElement(Flex,{flexDirection:"column",alignItems:"flex-end"},React.createElement(Text.Body.Normal,{weight:"$medium"},(h.feeRate*P/1e3).toFixed(2)," sats/vB"),React.createElement(Text.Body.Normal,{weight:"$medium"},h.estimatedTime))):React.createElement(Box,{w:"$fill"},React.createElement(Input,{className:styles.feeInput,step:"0.1",type:"number",label:p("browserView.transaction.btc.send.feeRateCustom"),disabled:u,value:R,"data-testid":"btc-add-custom-fee",bordered:false,onChange:e=>{const t=e.target.value.replace(",",".");A(t)},onKeyDown:handleCustomFeeKeyDown,onWheel:e=>{e.preventDefault();e.stopPropagation();e.currentTarget.blur()},inputMode:"decimal",pattern:"[0-9]*[.]?[0-9]*",onBlur:onCustomFeeBlur,filledLabelOnFocus:true}),x&&React.createElement(InputError,{error:x,isPopupView:l})))),React.createElement(Flex,{w:"$fill",py:"$24",pb:l?"$0":"$24",px:"$40",flexDirection:"column",gap:l?"$8":"$16",className:mainStyles.buttons},React.createElement(Button,{disabled:w||S||""===s.trim()||!D,color:"primary",block:true,size:"medium",onClick:handleNext,"data-testid":"continue-button"},p("browserView.transaction.send.footer.review")),React.createElement(Button,{color:"secondary",block:true,size:"medium",onClick:c,"data-testid":"back-button"},p("browserView.transaction.send.footer.cancel"))))}},"./src/views/bitcoin-mode/features/send/components/TransactionFailed.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/common/dist/index.esm.js");var o=s("./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss");var r=s("./src/components/ResultMessage/index.ts");var i=s("../../node_modules/react-i18next/dist/es/index.js");var l=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var c=s.n(l);const TransactionFailed=({txError:e,onBack:t,isPopupView:s,onClose:a})=>{const{t:n}=useTranslation();const[o,r]=useState(false);return React.createElement(Flex,{flexDirection:"column",w:"$fill",className:styles.container},React.createElement(Flex,{w:"$fill",flexDirection:"column",alignItems:"center",justifyContent:"center","data-testid":"tx-fail-container",className:styles.container},React.createElement(ResultMessage,{status:"error",title:React.createElement("div",{"data-testid":"send-error-title"},n("browserView.transaction.fail.oopsSomethingWentWrong")),description:React.createElement(Flex,{flexDirection:"column",gap:"$60"},React.createElement(Box,{w:"$fill"},React.createElement("div",{"data-testid":"send-error-description"},n("browserView.transaction.fail.problemSubmittingYourTransaction")),React.createElement("div",{"data-testid":"send-error-description2"},n("browserView.transaction.fail.clickBackAndTryAgain"))),"object"==typeof e&&e.message&&React.createElement(Box,{w:"$fill"},React.createElement(SummaryExpander,{onClick:()=>r(!o),open:o,title:"Show issue details",plain:true},React.createElement(TransactionSummary.Other,{label:e.name,text:e.message}))))})),React.createElement(Flex,{w:"$fill",py:"$24",pb:s?"$0":"$24",px:"$40",flexDirection:"column",gap:s?"$8":"$16",className:styles.buttons},React.createElement(Button,{color:"primary",block:true,size:"medium",onClick:t,"data-testid":"continue-button"},n("browserView.transaction.send.footer.fail")),React.createElement(Button,{color:"secondary",block:true,size:"medium",onClick:a,"data-testid":"back-button"},n("browserView.transaction.send.footer.cancel"))))}},"./src/views/bitcoin-mode/features/send/components/TransactionSuccess.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/common/dist/index.esm.js");var o=s("./src/views/bitcoin-mode/features/send/components/SendFlow.module.scss");var r=s("./src/components/ResultMessage/index.ts");var i=s("../../node_modules/react-i18next/dist/es/index.js");var l=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var c=s.n(l);var d=s("./src/components/TransactionHashBox/index.ts");const TransactionSuccess=({hash:e,onViewTransaction:t,isPopupView:s,onClose:a})=>{const{t:n}=useTranslation();const[o,r]=useState(false);return React.createElement(Flex,{flexDirection:"column",w:"$fill",className:styles.container},React.createElement(Flex,{w:"$fill",flexDirection:"column",alignItems:"center",justifyContent:"center","data-testid":"transaction-success-container",className:styles.container},React.createElement(ResultMessage,{title:React.createElement("div",null,n("browserView.transaction.success.youCanSafelyCloseThisPanel")),description:React.createElement(Flex,{flexDirection:"column",gap:"$60"},React.createElement("div",null,n("browserView.transaction.success.thisMayTakeAFewMinutes")),React.createElement(Box,{w:"$fill"},React.createElement(SummaryExpander,{onClick:()=>r(!o),open:o,title:"Transaction hash",plain:true},React.createElement(Flex,{justifyContent:"center"},React.createElement(TransactionHashBox,{hash:e})))))})),React.createElement(Flex,{w:"$fill",py:"$24",pb:s?"$0":"$24",px:"$40",flexDirection:"column",gap:s?"$8":"$16",className:styles.buttons},React.createElement(Button,{color:"primary",block:true,size:"medium",onClick:t,"data-testid":"continue-button"},n("browserView.transaction.send.footer.review")),React.createElement(Button,{color:"secondary",block:true,size:"medium",onClick:a,"data-testid":"back-button"},n("browserView.transaction.send.footer.cancel"))))}},"./src/views/browser-view/components/Drawer/DrawerUIContent.tsx":(e,t,s)=>{s.d(t,{DrawerContent:()=>p});var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/lodash/isUndefined.js");var o=s.n(n);var r=s("./src/views/browser-view/features/send-transaction/index.ts");var i=s("./src/views/browser-view/stores/index.ts");var l=s("../../packages/common/dist/index.esm.js");var c=s("./src/views/browser-view/components/QRInfoWalletDrawer/index.ts");var d=s("./src/views/browser-view/features/sign-message/SignMessageDrawer.tsx");var u=s("./src/views/browser-view/components/WalletUsedAddressesDrawer/index.ts");var m=s("./src/views/bitcoin-mode/features/send/components/BitcoinSendDrawer.tsx");var v=s("./src/views/bitcoin-mode/features/receive-info/components/BitcoinQRInfoWalletDrawer.tsx");var p;(function(e){e["SEND_TRANSACTION"]="send-transaction";e["CO_SIGN_TRANSACTION"]="co-sign-transaction";e["RECEIVE_TRANSACTION"]="receive-transaction";e["SHOW_USED_ADDRESSES"]="show-used-addresses";e["SIGN_MESSAGE"]="sign-message-addresses";e["SEND_BITCOIN_TRANSACTION"]="send-bitcoin-transaction";e["RECEIVE_BITCOIN_TRANSACTION"]="receive-bitcoin-transaction"})(p||(p={}));const renderDrawerContent=e=>{switch(e){case p.SEND_TRANSACTION:return React.createElement(Transaction,{flow:"send"});case p.CO_SIGN_TRANSACTION:return React.createElement(Transaction,{flow:"co-sign"});case p.RECEIVE_TRANSACTION:return React.createElement(QRInfoWalletDrawer,null);case p.SHOW_USED_ADDRESSES:return React.createElement(WalletUsedAddressesDrawer,null);case p.SIGN_MESSAGE:return React.createElement(SignMessageDrawer,null);case p.SEND_BITCOIN_TRANSACTION:return React.createElement(BitcoinSendDrawer,null);case p.RECEIVE_BITCOIN_TRANSACTION:return React.createElement(BitcoinQRInfoWalletDrawer,null);default:return React.createElement(Skeleton,null)}};const DrawerUIContainer=({defaultContent:e})=>{var t,s,a;const[n,o]=useDrawer();const r=null==n?void 0:null===(t=n.renderFooter)||void 0===t?void 0:t.call(n);return React.createElement(Drawer,{className:null==n?void 0:n.wrapperClassName,visible:!isUndefined(n)||!isUndefined(e),destroyOnClose:true,onClose:()=>{return(null==n?void 0:n.onClose)?null==n?void 0:n.onClose():o()},footer:r||void 0,navigation:null==n?void 0:null===(s=n.renderHeader)||void 0===s?void 0:s.call(n),title:null==n?void 0:null===(a=n.renderTitle)||void 0===a?void 0:a.call(n),keyboard:false},renderDrawerContent(e||(null==n?void 0:n.content)))}},"./src/views/browser-view/components/Drawer/index.ts":(e,t,s)=>{s.d(t,{DrawerContent:()=>a.DrawerContent});var a=s("./src/views/browser-view/components/Drawer/DrawerUIContent.tsx")},"./src/views/browser-view/components/EducationalList/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/assets/images/educational-illustration.png");var o=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var w=s.n(g);var S=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/EducationalList/EducationalListRow.module.scss");var y={};y.styleTagTransform=w();y.setAttributes=m();y.insert=d().bind(null,"head");y.domAPI=l();y.insertStyleElement=p();var f=r()(S["default"],y);const b=S["default"]&&S["default"].locals?S["default"].locals:void 0;var E=s("../../node_modules/classnames/index.js");var C=s("./src/providers/ExternalLinkOpenerProvider/index.ts");var T=s("./src/routes/wallet-paths.ts");const is_internal_link_isInternalLink=(e,t=walletRoutePaths)=>{if("/"===e)return true;if("string"==typeof t)return e===t;for(const s in t){const a=is_internal_link_isInternalLink(e,t[s]);if(a)return true}return false};const EducationalListRow_EducationalListRow=({subtitle:e,title:t,link:s,src:a=illustrations})=>{const n=useExternalLinkOpener();const{push:o}=useHistory();const onLinkClicked=()=>{const e=isValidURL(s);const t=isInternalLink(s);if(e&&!t)n(s);if(t&&!e)o(s)};return React.createElement("div",{className:styles.rowContainer,"data-testid":"educational-list-row",onClick:onLinkClicked},React.createElement("div",{className:styles.imageContainer},React.createElement("img",{src:a,alt:"educational-illustration",className:styles.image,"data-testid":"educational-list-row-img"})),React.createElement("div",{className:cn(styles.contentContainer,{[styles.validLink]:isValidURL(s)})},React.createElement("h1",{className:styles.title,"data-testid":"educational-list-row-title"},t),React.createElement("p",{className:styles.subtitle,"data-testid":"educational-list-row-subtitle"},e)))};var k=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/EducationalList/EducationalList.module.scss");var h={};h.styleTagTransform=w();h.setAttributes=m();h.insert=d().bind(null,"head");h.domAPI=l();h.insertStyleElement=p();var R=r()(k["default"],h);const A=k["default"]&&k["default"].locals?k["default"].locals:void 0;function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const EducationalList=({items:e,title:t})=>{const s="string"==typeof t?React.createElement("h1",{className:styles.title,"data-testid":"educational-list-title"},t):t;return React.createElement("div",{className:styles.listContainer,"data-testid":"educational-list"},s,e.map((e,t)=>React.createElement(EducationalListRow,_extends({key:`${e.title}-${t}`},e))))}},"./src/views/browser-view/components/Layout/Layout.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-i18next/dist/es/index.js");var o=s("../../node_modules/classnames/index.js");var r=s("../../node_modules/lodash/debounce.js");var i=s("../../packages/common/dist/index.esm.js");var l=s("./src/providers/BackgroundServiceAPI/index.ts");var c=s("./src/providers/ThemeProvider/index.ts");var d=s("./src/lib/scripts/types/index.ts");var u=s("./src/views/browser-view/components/Drawer/index.ts");var m=s("./src/hooks/useNetworkError.ts");var v=s("./src/routes/index.ts");var p=s("./src/views/browser-view/components/SideMenu/index.ts");var g=s("./src/hooks/useIsSmallerScreenWidthThan.ts");var w=s("./src/components/NetworkPill/index.ts");var S=s("./src/assets/branding/lace-logo.svg");var y=s("./src/assets/branding/lace-logo-dark-mode.svg");var f=s("./src/assets/branding/lace-logo-beta.svg");var b=s("./src/assets/branding/lace-logo-beta-dark.svg");var E=s("./src/assets/branding/lace-logo-mark.component.svg");var C=s("./src/assets/branding/lace-logo-beta-white.component.svg");var T=s("./src/assets/branding/lace-logo-beta-dark.component.svg");var k=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var h=s.n(k);var R=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var A=s.n(R);var x=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var P=s.n(x);var I=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var _=s.n(I);var D=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var N=s.n(D);var B=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var O=s.n(B);var j=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/LeftSidePanel/LeftSidePanel.module.scss");var V={};V.styleTagTransform=O();V.setAttributes=_();V.insert=P().bind(null,"head");V.domAPI=A();V.insertStyleElement=N();var W=h()(j["default"],V);const M=j["default"]&&j["default"].locals?j["default"].locals:void 0;var L=s("./src/providers/index.ts");var F=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");const H="lace";const $="lace-bitcoin";const U={dark:{[H]:y["default"],[$]:b["default"]},light:{[H]:S["default"],[$]:f["default"]}};const K={dark:T["default"],light:C["default"]};const LeftSidePanel_LeftSidePanel=({theme:e})=>{const[t,s]=useState(H);const a=useBackgroundServiceAPIContext();const n=useHistory();const o=useAnalyticsContext();const r=useIsSmallerScreenWidthThan(BREAKPOINT_XSMALL);const[i,l]=useState(false);const handleLogoRedirection=()=>{n.push(walletRoutePaths.assets);o.sendEventToPostHog(PostHogAction.WalletLaceClick)};const handleLogoMouseEnter=()=>l(true);const handleLogoMouseLeave=()=>l(false);const getWalletMode=async()=>{const{activeBlockchain:e}=await a.getBackgroundStorage();s("bitcoin"===e?$:H)};getWalletMode();const c=t===$?K[e]:LaceLogoMark;const d=r?React.createElement(c,{onMouseOver:handleLogoMouseEnter,onMouseLeave:handleLogoMouseLeave,className:styles.shortenedLogo,onClick:handleLogoRedirection}):React.createElement("img",{className:styles.logo,src:U[e][t],alt:"LACE","data-testid":"header-logo",onClick:handleLogoRedirection});return React.createElement(React.Fragment,null,r&&React.createElement(NetworkPill,{isExpandable:true}),React.createElement("nav",{id:"nav",className:classnames(styles.navigation,{[styles.shadowNone]:i})},React.createElement("div",{className:styles.stickyMenuInner},React.createElement("div",{className:styles.logoContainer},d,!r&&React.createElement("div",{className:styles.networkPillBox},React.createElement(NetworkPill,null))),React.createElement(SideMenu,null))))};var G=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/Layout/Layout.module.scss");var q={};q.styleTagTransform=O();q.setAttributes=_();q.insert=P().bind(null,"head");q.domAPI=A();q.insertStyleElement=N();var Y=h()(G["default"],q);const z=G["default"]&&G["default"].locals?G["default"].locals:void 0;var X=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/wallet-setup/components/PinExtension.module.scss");var Q={};Q.styleTagTransform=O();Q.setAttributes=_();Q.insert=P().bind(null,"head");Q.domAPI=A();Q.insertStyleElement=N();var J=h()(X["default"],Q);const Z=X["default"]&&X["default"].locals?X["default"].locals:void 0;var ee=s("./src/assets/icons/extension.component.svg");const PinExtension_PinExtension=()=>{const{t:e}=useTranslation();const t=useAnalyticsContext();return React.createElement("div",{className:styles.pinExtension,onClick:()=>t.sendEventToPostHog(postHogOnboardingActions.onboarding.PIN_EXTENSION_CLICK),"data-testid":"pin-extension-component"},React.createElement(LaceLogoMark,{className:styles.logo,"data-testid":"pin-extension-logo"}),React.createElement("div",{className:styles.content},React.createElement("h5",{"data-testid":"pin-extension-title"},e("browserView.pinExtension.title")),React.createElement("p",{"data-testid":"pin-extension-prompt"},React.createElement(Trans,{i18nKey:"browserView.pinExtension.prompt",components:{icon:React.createElement(ExtensionIcon,{"data-testid":"pin-extension-icon"})}}))))};var et=s("./src/hooks/index.ts");var es=s("./src/stores/index.ts");var ea=s("./src/views/browser-view/features/send-transaction/index.ts");var en=s("./src/views/browser-view/components/TransactionCTAsBox/useOpenReceiveDrawer.tsx");var eo=s("./src/views/browser-view/components/TransactionCTAsBox/useBitcoinSendDrawer.tsx");var er=s("./src/multichain/index.ts");const ei=500;const el=5e3;const Layout=({children:e,drawerUIDefaultContent:t,noAside:s=false})=>{var a;const{t:n}=useTranslation();const{theme:o,setTheme:r}=useTheme();const i=useBackgroundServiceAPIContext();const{walletState:l}=useWalletStore();const c=useOpenReceiveDrawer();const{blockchain:d}=useCurrentBlockchain();const u=useOpenTransactionDrawer({content:DrawerContent.SEND_TRANSACTION,config:{options:{isAdvancedFlow:true}}});const m=useBitcoinSendDrawer();const v=d===Blockchain.Cardano?u:m;const[p,{updateLocalStorage:g}]=useLocalStorage("showPinExtension",true);const[w]=useLocalStorage("showMultiAddressModal",true);useEffect(()=>{const openDrawer=async()=>{var e,t,s,a;const n=await i.getBackgroundStorage();if(!n)return;if((null===(e=n.message)||void 0===e?void 0:e.type)===MessageTypes.OPEN_BROWSER_VIEW&&(null===(t=n.message)||void 0===t?void 0:t.data.section)===BrowserViewSections.SEND_ADVANCED){console.error("Pening tx send");await i.clearBackgroundStorage({keys:["message"]});v()}if((null===(s=n.message)||void 0===s?void 0:s.type)===MessageTypes.OPEN_BROWSER_VIEW&&(null===(a=n.message)||void 0===a?void 0:a.data.section)===BrowserViewSections.RECEIVE_ADVANCED){await i.clearBackgroundStorage({keys:["message"]});c()}};openDrawer()},[i,c,v]);useEffect(()=>{var e;const t=null===(e=i.requestMessage$)||void 0===e?void 0:e.subscribe(({type:e,data:t})=>{if(e===MessageTypes.CHANGE_THEME)r(t.theme)});return()=>t.unsubscribe()},[i,r]);useEffect(()=>{var e;if(w&&(null==l?void 0:null===(e=l.addresses)||void 0===e?void 0:e.length)>1)return;const t=window.setTimeout(()=>{g(false)},el);return()=>window.clearTimeout(t)},[g,w,null==l?void 0:null===(a=l.addresses)||void 0===a?void 0:a.length]);const S=useMemo(()=>debounce(toast.notify,ei),[]);const y=useCallback(()=>S({text:n("general.errors.networkError")}),[S,n]);useNetworkError(y);return React.createElement("div",{id:"main",className:classnames(styles.layoutGridContainer,!s&&styles.withAside,s&&styles.noAside)},React.createElement(LeftSidePanel,{theme:o.name}),p&&React.createElement("div",{className:styles.pinExtension},React.createElement(PinExtension,null)),e,React.createElement(DrawerUIContainer,{defaultContent:t}))}},"./src/views/browser-view/components/Layout/SectionLayout.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var o=s.n(n);var r=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var i=s.n(r);var l=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var v=s.n(m);var p=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var g=s.n(p);var w=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/Layout/SectionLayout.modules.scss");var S={};S.styleTagTransform=g();S.setAttributes=u();S.insert=c().bind(null,"head");S.domAPI=i();S.insertStyleElement=v();var y=o()(w["default"],S);const f=w["default"]&&w["default"].locals?w["default"].locals:void 0;var b=s("../../node_modules/intersection-observer-polyfill/index.js");var E=s("../../node_modules/classnames/index.js");var C=s("./src/hooks/useIsSmallerScreenWidthThan.ts");var T=s("./src/components/DropdownMenu/index.ts");var k=s("./src/views/browser-view/components/TransactionCTAsBox/index.ts");var h=s("../../packages/common/dist/index.esm.js");var R=s("./src/assets/icons/arrow-right.component.svg");var A=s("./src/assets/icons/arrow-left.component.svg");var x=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/SidePanelButton/SidePanelButton.module.scss");var P={};P.styleTagTransform=g();P.setAttributes=u();P.insert=c().bind(null,"head");P.domAPI=i();P.insertStyleElement=v();var I=o()(x["default"],P);const _=x["default"]&&x["default"].locals?x["default"].locals:void 0;const SidePanelButton_SidePanelButton=({active:e,onClick:t})=>React.createElement(Button,{className:styles.roundBtn,variant:"outlined",color:"secondary","data-testid":"side-panel-handler",onClick:t},React.createElement("div",{className:classnames(styles.square,{[styles.squareActive]:e})},e?React.createElement(ArrowRight,{className:styles.icon}):React.createElement(ArrowLeft,{className:styles.icon}),React.createElement("div",{className:classnames(styles.switch,{[styles.active]:e})})));var D=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/CollapsiblePanelContainer/CollapsiblePanelContainer.module.scss");var N={};N.styleTagTransform=g();N.setAttributes=u();N.insert=c().bind(null,"head");N.domAPI=i();N.insertStyleElement=v();var B=o()(D["default"],N);const O=D["default"]&&D["default"].locals?D["default"].locals:void 0;const CollapsiblePanelContainer_CollapsiblePanelContainer=({children:e,topNavigation:t,onOverlayClick:s})=>React.createElement("div",{className:styles.overlay,onClick:s},React.createElement("div",{className:styles.stickyTopNavigation},t),React.createElement("div",{"data-testid":"right-side-panel",className:styles.container,onClick:e=>e.stopPropagation()},e));const j="content";const V={threshold:1};const W="top";const M="bottom";const SidePanel_SidePanel=({sidePanelContent:e,isSidePanelFixed:t=true})=>{const s=useRef();const[a,n]=useState(W);const[o,r]=useState(false);const i=useIsSmallerScreenWidthThan(BREAKPOINT_SMALL);const l=useCallback(e=>{e.map(e=>{if(!s.current)return;e.intersectionRect.height===e.boundingClientRect.height?n(W):n(M)})},[]);useEffect(()=>{const e=null==s?void 0:s.current;const a=new IntersectionObserver(l,V);if(e&&t)a.observe(e);return()=>{if(e)a.unobserve(e)}},[l,t]);const toggleSidePanelVisibility=e=>{null==e?void 0:e.stopPropagation();r(e=>!e)};const c=React.createElement("div",{className:classnames(styles.navigationBox,{[styles.navigationBoxOverlay]:o&&i,[styles.navigationBoxFlexible]:true})},React.createElement(TransactionCTAsBox,null),React.createElement(DropdownMenu,null),!!e&&i&&React.createElement(SidePanelButton,{active:o,onClick:toggleSidePanelVisibility}));return React.createElement("aside",{id:"side-panel",className:classnames(styles.sidePanelContainer,styles[a],{[styles.stickyAside]:t})},i&&o?React.createElement(CollapsiblePanelContainer,{onOverlayClick:toggleSidePanelVisibility,topNavigation:c},e):React.createElement("div",{ref:s,className:classnames(styles[a],{[styles.stickyAsideInner]:t,[styles.topBarAlignment]:i})},React.createElement(React.Fragment,null,React.createElement("div",{className:styles.topNavigationBox},c),!!e&&!i&&React.createElement("div",{className:styles.sidePanelContentBox},e))))};var L=s("./src/providers/index.ts");var F=s("./src/components/Credit/index.ts");var H=s("./src/utils/constants.ts");const $="content";const SectionLayout=({children:e,sidePanelContent:t,isSidePanelFixed:s=true,hasCredit:a=false})=>{const n=useExternalLinkOpener();const handleOnClick=()=>n(COINGECKO_URL);return React.createElement(React.Fragment,null,React.createElement("main",{id:$,className:classNames(styles.content,!!t&&styles.withAside)},React.createElement("div",null,e),a&&React.createElement(Credit,{handleOnClick:handleOnClick})),React.createElement(SidePanel,{sidePanelContent:t,isSidePanelFixed:s}))}},"./src/views/browser-view/components/Layout/index.ts":(e,t,s)=>{var a=s("./src/views/browser-view/components/Layout/Layout.tsx");var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var w=s.n(g);var S=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/Layout/WalletSetupLayout.module.scss");var y={};y.styleTagTransform=w();y.setAttributes=m();y.insert=d().bind(null,"head");y.domAPI=l();y.insertStyleElement=p();var f=r()(S["default"],y);const b=S["default"]&&S["default"].locals?S["default"].locals:void 0;var E=s("./src/assets/branding/lace-logo.svg");var C=s("./src/assets/branding/lace-logo-dark-mode.svg");var T=s("./src/assets/icons/browser-view/question-mark.svg");var k=s("../../node_modules/react-i18next/dist/es/index.js");var h=s("../../packages/common/dist/index.esm.js");var R=s("./src/providers/ThemeProvider/context.tsx");var A=s("./src/providers/ExternalLinkOpenerProvider/index.ts");const WalletSetupLayout=({children:e,prompt:t})=>{const{t:s}=useTranslation();const{theme:a}=useTheme();const n=useExternalLinkOpener();return React.createElement("div",{className:styles.walletSetupLayout},React.createElement("div",{className:styles.header},React.createElement("img",{src:"light"===a.name?laceLogo:laceLogoDarkMode,alt:"LACE",width:120,"data-testid":"lace-logo"}),t||React.createElement(Button,{color:"gradient",onClick:()=>n("https://iohk.zendesk.com/hc/en-us/requests/new"),"data-testid":"help-and-support-button"},React.createElement("img",{src:QuestionMark,alt:"question mark"}),s("general.lock.helpAndSupport"))),React.createElement("div",{className:styles.container},React.createElement("div",{className:styles.content},e)),React.createElement("div",{className:styles.legalButtonsContainer},React.createElement("a",{className:styles.legalButton,onClick:()=>n("https://www.lace.io/lace-cookie-policy.pdf"),"data-testid":"cookie-policy-link"},s("settings.legals.cookiePolicy")),React.createElement("a",{className:styles.legalButton,onClick:()=>n("https://www.lace.io/iog-privacy-policy.pdf"),"data-testid":"privacy-policy-link"},s("settings.legals.privacyPolicy")),React.createElement("a",{className:styles.legalButton,onClick:()=>n("https://www.lace.io/iohktermsandconditions.pdf"),"data-testid":"terms-of-service-link"},s("settings.legals.termsOfService"))))};var x=s("./src/views/browser-view/components/Layout/SectionLayout.tsx")},"./src/views/browser-view/components/PortfolioBalance/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-i18next/dist/es/index.js");var o=s("../../packages/common/dist/index.esm.js");var r=s("../../node_modules/dayjs/dayjs.min.js");var i=s.n(r);var l=s("../../node_modules/dayjs/plugin/localizedFormat.js");var c=s.n(l);var d=s("./src/assets/icons/purple-question-mark.component.svg");var u=s("../../node_modules/classnames/index.js");var m=s("./src/stores/index.ts");var v=s("../../node_modules/lodash/isNil.js");var p=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var g=s.n(p);var w=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var S=s.n(w);var y=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var f=s.n(y);var b=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var E=s.n(b);var C=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var T=s.n(C);var k=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var h=s.n(k);var R=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/PortfolioBalance/PortfolioBalanceValue/PortfolioBalanceValue.module.scss");var A={};A.styleTagTransform=h();A.setAttributes=E();A.insert=f().bind(null,"head");A.domAPI=S();A.insertStyleElement=T();var x=g()(R["default"],A);const P=R["default"]&&R["default"].locals?R["default"].locals:void 0;var I=s("./src/utils/constants.ts");const formatPercentage=e=>isNil(e)?"-":`${e>0?"+":""}${e}%`;const PortfolioBalanceValue_PortfolioBalanceValue=({balance:e,balanceSubtitle:t,currencyCode:s,isBalanceVisible:a=true,textSize:n="large"})=>{const{walletUI:{getHiddenBalancePlaceholder:o,appMode:r}}=useWalletStore();const i=r===APP_MODE_POPUP;const l=useMemo(()=>({[styles.balanceTextLarge]:"large"===n,[styles.balanceTextXLarge]:i&&!a,[styles.balanceTextMedium]:"medium"===n}),[a,i,n]);const c=useMemo(()=>({[styles.codeTextLarge]:"large"===n,[styles.codeTextMedium]:"medium"===n}),[n]);const d=useMemo(()=>[{[styles.popupView]:i,[styles.subtitleTextLarge]:"large"===n,[styles.subtitleTextMedium]:"medium"===n}],[i,n]);let u=Number.isNaN(Number(null==t?void 0:t.value))?null==t?void 0:t.value:Number(t.value);if((null==t?void 0:t.isPercentage)&&"number"==typeof u){d.push({[styles.negative]:u<0,[styles.positive]:u>0});u=formatPercentage(u)}return React.createElement(React.Fragment,null,React.createElement("div",{className:classnames(styles.balance,{[styles.popupView]:i})},React.createElement("h1",{"data-testid":"portfolio-balance-value",className:classnames(l)},a?e:o()),a&&React.createElement("h4",{"data-testid":"portfolio-balance-currency",className:classnames(c)},s)),!isNil(null==t?void 0:t.value)&&React.createElement("h4",{className:classnames(d),"data-testid":"portfolio-balance-subtitle"},u))};var _=s("./src/assets/icons/browser-view/info-icon.component.svg");var D=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/PortfolioBalance/PortfolioBalanceLabel/PortfolioBalanceLabel.module.scss");var N={};N.styleTagTransform=h();N.setAttributes=E();N.insert=f().bind(null,"head");N.domAPI=S();N.insertStyleElement=T();var B=g()(D["default"],N);const O=D["default"]&&D["default"].locals?D["default"].locals:void 0;var j=s("./src/components/BalanceVisibilityToggle/BalanceVisibilityToggle.tsx");const PortfolioBalanceLabel_PortfolioBalanceLabel=({label:e,showInfoTooltip:t=false,showBalanceVisibilityToggle:s=false})=>{const{t:a}=useTranslation();const{walletUI:{appMode:n}}=useWalletStore();return React.createElement("div",{className:classnames(styles.titleContainer,{[styles.popupView]:n===APP_MODE_POPUP})},React.createElement("label",{"data-testid":"portfolio-balance-label"},e,t&&React.createElement(Tooltip,{placement:"top",title:a("browserView.assets.portfolioBalanceToolTip")},React.createElement("span",{className:styles.iconWrapper,"data-testid":"portfolio-balance-label-info"},React.createElement(InfoIcon,{className:styles.icon}))),s&&React.createElement(BalanceVisibilityToggle,null)))};var V=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/PortfolioBalance/PortfolioBalance.module.scss");var W={};W.styleTagTransform=h();W.setAttributes=E();W.insert=f().bind(null,"head");W.domAPI=S();W.insertStyleElement=T();var M=g()(V["default"],W);const L=V["default"]&&V["default"].locals?V["default"].locals:void 0;i().extend(c());const PortfolioBalance=({label:e,balance:t,balanceSubtitle:s,currencyCode:a,loading:n,showBalanceVisibilityToggle:o,isBalanceVisible:r=true,textSize:i="large",showInfoTooltip:l=false,isPriceOutdatedBannerVisible:c,lastPriceFetchedDate:d})=>{const{t:u}=useTranslation();return React.createElement(Skeleton,{loading:n},React.createElement(PortfolioBalanceLabel,{showBalanceVisibilityToggle:o,showInfoTooltip:l,label:e}),c?React.createElement("div",{className:styles.warningBanner},React.createElement(Banner,{customIcon:React.createElement(QuestionMarkIcon,null),withIcon:true,message:d?u("general.warnings.priceDataExpired",{date:dayjs(d).format("lll")}):u("general.warnings.cannotFetchPrice")})):React.createElement(PortfolioBalanceValue,{isBalanceVisible:r,balance:t,currencyCode:a,textSize:i,balanceSubtitle:s}))}},"./src/views/browser-view/components/QRInfoWalletDrawer/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/core/dist/index.esm.js");var o=s("./src/providers/ThemeProvider/index.ts");var r=s("./src/stores/index.ts");var i=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var y=s.n(S);var f=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/QRInfoWalletDrawer/QRInfoWalletDrawer.module.scss");var b={};b.styleTagTransform=y();b.setAttributes=p();b.insert=m().bind(null,"head");b.domAPI=d();b.insertStyleElement=w();var E=l()(f["default"],b);const C=f["default"]&&f["default"].locals?f["default"].locals:void 0;var T=s("../../node_modules/react-i18next/dist/es/index.js");var k=s("./src/views/browser-view/stores/index.ts");var h=s("../../packages/common/dist/index.esm.js");var R=s("./src/providers/index.ts");var A=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var x=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var P=s("./src/hooks/index.ts");var I=s("../../packages/cardano/dist/index.esm.js");var _=s("./src/utils/get-transaction-total-output.ts");var D=s("./src/utils/assets-transformers.ts");var N=s("./src/utils/format-number.ts");var B=s("./src/stores/slices/index.ts");const O=null;const addressHasTx=async(e,t)=>{const s=await t.transactionsByAddresses({addresses:[e],pagination:{limit:1,startAt:0}});return s.totalResultCount>0};const getCurrentUnusedAddress=async(e,t)=>{if(!e||0===e.length)return;if(Wallet.isScriptAddress(e[0]))return;const s=[...e].filter(e=>Wallet.isKeyHashAddress(e)).sort((e,t)=>t.index-e.index);const a=s[0];const n=!await addressHasTx(a.address,t);if(n)return a;return};const useWalletInformation=()=>{return useWalletStore(e=>{var t,s,a,n;return{name:null==e?void 0:null===(t=e.walletInfo)||void 0===t?void 0:t.name,handles:null==e?void 0:null===(s=e.walletState)||void 0===s?void 0:s.handles,utxos:null==e?void 0:null===(a=e.walletState)||void 0===a?void 0:a.utxo.total,rewardAccounts:null==e?void 0:null===(n=e.walletState)||void 0===n?void 0:n.delegation.rewardAccounts}})};const QRInfoWalletDrawer=()=>{const e=useAnalyticsContext();const{t}=useTranslation();const{theme:s}=useTheme();const{name:a,handles:n,utxos:o,rewardAccounts:r}=useWalletInformation();const[i,l]=useState();const[c,d]=useState();const[u,m]=useState();const[,v]=useDrawer();const[p]=useLocalStorage("isReceiveInAdvancedMode",false);const{chainHistoryProvider:g}=getProviders();useKeyboardShortcut(["Escape"],()=>v());const handleCopyAdaHandle=()=>{e.sendEventToPostHog(PostHogAction.ReceiveCopyADAHandleIconClick)};const handleCopyAddress=()=>{e.sendEventToPostHog(PostHogAction.ReceiveCopyAddressIconClick)};const w=useCallback(()=>getQRCodeOptions(s,ADDRESS_CARD_QR_CODE_SIZE),[s]);const S={additionalAddressesTitle:t("qrInfo.advancedMode.additionalAddresses.title"),addNewAddressBtn:t("qrInfo.advancedMode.newAddress.button"),mainAddressTag:t("qrInfo.advancedMode.tags.main"),newAddressTag:t("qrInfo.advancedMode.tags.unused"),newAddressBannerText:t("qrInfo.advancedMode.newAddress.warning")};const y=O&&p;const{inMemoryWallet:f}=useWalletStore();const b=useObservable(f.addresses$);const E=useMemo(()=>{if(!b)return;const e=b.some(e=>Wallet.isScriptAddress(e));if(!e){return[...b].sort((e,t)=>{if(Wallet.isKeyHashAddress(e)&&Wallet.isKeyHashAddress(t)){if(e.index!==t.index){return e.index-t.index}if(e.stakeKeyDerivationPath&&t.stakeKeyDerivationPath){return e.stakeKeyDerivationPath.index-t.stakeKeyDerivationPath.index}if(e.stakeKeyDerivationPath&&!t.stakeKeyDerivationPath){return -1}if(!e.stakeKeyDerivationPath&&t.stakeKeyDerivationPath){return 1}return 0}return 0})}return[...b]},[b]);const C=useObservable(f.assetInfo$);const{addressesWithUtxo:T,outputs:k}=useMemo(()=>{const e=null==o?void 0:o.map(e=>e[0]);const t=null==o?void 0:o.map(e=>e[1]);return{addressesWithUtxo:e,outputs:t}},[o]);const h=useCallback(async()=>{const e=await f.getNextUnusedAddress();d(e[0].address)},[f,d]);useEffect(()=>{const fetchAddress=async()=>{const e=await getCurrentUnusedAddress(E,g);m(null==e?void 0:e.address)};fetchAddress()},[E,g,o]);useEffect(()=>{if(!E)return;const e=E.filter(({address:e})=>e!==u).map(({address:e,rewardAccount:t})=>{var s,a;const o=C&&getTotalAssetsByAddress(k,C,e);const i=getTransactionTotalOutputByAddress(k,e);const l=Wallet.util.lovelacesToAdaString(i.toString());const c=formatBalance(Number.parseFloat(l));const d=r.find(e=>e.address===t);const u=null==d?void 0:null===(s=d.delegatee)||void 0===s?void 0:s.nextNextEpoch;return{address:e,handles:n.filter(t=>t.cardanoAddress===e).map(({handle:e})=>e),stakePool:null==u?void 0:null===(a=u.metadata)||void 0===a?void 0:a.ticker,balance:c,tokens:{amount:null==o?void 0:o.assets,nfts:null==o?void 0:o.nfts}}});l(e);d(u)},[E,T,C,n,k,r,o,c,d,u]);useEffect(()=>{if(y&&(null==i?void 0:i.length)===0)h()},[y,i,h]);const R=useMemo(()=>{return(null==i?void 0:i.length)>1||(null==i?void 0:i.length)>0&&u},[u,i]);return React.createElement(Flex,{flexDirection:"column",justifyContent:"space-between",alignItems:"center"},React.createElement("div",{className:styles.infoContainer},!y&&E&&React.createElement(Flex,{flexDirection:"column",gap:"$16"},React.createElement(AddressCard,{name:a,address:E[0].address,getQRCodeOptions:w,onCopyClick:handleCopyAddress}),null==n?void 0:n.map(({nftMetadata:e,image:s})=>React.createElement(HandleAddressCard,{key:e.name,name:e.name,image:getAssetImageUrl(s||e.image),copiedMessage:t("core.infoWallet.handleCopied"),onCopyClick:handleCopyAdaHandle}))),y&&React.createElement(React.Fragment,null,(null==i?void 0:i.length)>0&&React.createElement(AddressCard,{address:i[0].address,getQRCodeOptions:w,onCopyClick:handleCopyAddress,tagWith:{label:S.mainAddressTag},metadata:{handles:i[0].handles,balance:i[0].balance,tokens:{amount:i[0].tokens.amount,nfts:i[0].tokens.nfts},stakePool:i[0].stakePool}}),R&&React.createElement(Divider,{orientation:"center","data-testid":"additional-addresses-divider"},S.additionalAddressesTitle),(null==i?void 0:i.length)>1&&React.createElement(React.Fragment,null,i.slice(1).map(({address:e,handles:t,balance:s,tokens:a,stakePool:n})=>React.createElement(AddressCard,{key:e,address:e,getQRCodeOptions:w,onCopyClick:handleCopyAddress,metadata:{handles:t,balance:s,tokens:a,stakePool:n}}))),c&&React.createElement(AddressCard,{address:c,getQRCodeOptions:w,onCopyClick:handleCopyAddress,highlighted:true,isUnused:true,tagWith:{label:S.newAddressTag,tooltip:React.createElement(Trans,{i18nKey:"qrInfo.advancedMode.newAddress.description",components:{pt:React.createElement("p",null),pb:React.createElement("p",null)}})}}))),y&&React.createElement(Flex,{w:"$fill",mb:"$16",gap:"$16",flexDirection:"column",className:styles.addNewAddressContainer},c&&React.createElement(Banner,{message:S.newAddressBannerText,customIcon:React.createElement(ExclamationCircleOutlined,{className:styles.addNewAddressBannerIcon}),withIcon:true,className:styles.addNewAddressBanner}),React.createElement(Button.Secondary,{disabled:!!c,w:"$fill",icon:React.createElement(PlusCircleOutlined,null),onClick:h,label:S.addNewAddressBtn,"data-testid":"add-new-address-button"})))}},"./src/views/browser-view/components/SideMenu/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/utils/constants.ts");var o=s("./src/providers/index.ts");var r=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var i=s("./src/routes/wallet-paths.ts");var l=s("./src/views/browser-view/components/SideMenu/SideMenuContent.module.scss");var c=s("./src/assets/icons/assets-icon.component.svg");var d=s("./src/assets/icons/hover-assets-icon.component.svg");var u=s("./src/assets/icons/active-assets-icon.component.svg");var m=s("./src/assets/icons/nft-icon.component.svg");var v=s("./src/assets/icons/hover-nft-icon.component.svg");var p=s("./src/assets/icons/active-nft-icon.component.svg");var g=s("./src/assets/icons/transactions-icon.component.svg");var w=s("./src/assets/icons/hover-transactions-icon.component.svg");var S=s("./src/assets/icons/active-transactions-icon.component.svg");var y=s("./src/assets/icons/database-icon.component.svg");var f=s("./src/assets/icons/hover-database-icon.component.svg");var b=s("./src/assets/icons/active-database-icon.component.svg");var E=s("./src/assets/icons/tiles-outlined.component.svg");var C=s("./src/assets/icons/tiles-outlined-gradient.component.svg");var T=s("./src/assets/icons/tiles-solid-gradient.component.svg");var k=s("./src/assets/icons/voting-icon.component.svg");var h=s("./src/assets/icons/hover-voting-icon.component.svg");const R=[{id:n.MenuItemList.ASSETS,label:"browserView.sideMenu.links.tokens",testId:"item-assets",path:i.walletRoutePaths.assets,regularIcon:c["default"],hoverIcon:d["default"],activeIcon:u["default"],iconClassName:l["default"].tokensLinkIcon},{id:n.MenuItemList.NFT,label:"browserView.sideMenu.links.nfts",testId:"item-nfts",path:i.walletRoutePaths.nfts,regularIcon:m["default"],hoverIcon:v["default"],activeIcon:p["default"]},{id:n.MenuItemList.TRANSACTIONS,label:"browserView.sideMenu.links.activity",testId:"item-transactions",path:i.walletRoutePaths.activity,regularIcon:g["default"],hoverIcon:w["default"],activeIcon:S["default"]},{id:n.MenuItemList.STAKING,label:"browserView.sideMenu.links.staking",testId:"item-staking",path:i.walletRoutePaths.staking,regularIcon:y["default"],hoverIcon:f["default"],activeIcon:b["default"]},{id:n.MenuItemList.VOTING,label:"browserView.sideMenu.links.voting",testId:"item-voting",path:i.walletRoutePaths.voting,regularIcon:k["default"],hoverIcon:h["default"],activeIcon:h["default"]},{id:n.MenuItemList.DAPPS,label:"browserView.sideMenu.links.dappExplorer",testId:"item-dapps",path:i.walletRoutePaths.dapps,regularIcon:E["default"],hoverIcon:C["default"],activeIcon:T["default"]}];const A=[{id:n.MenuItemList.ASSETS,label:"browserView.sideMenu.links.tokens",testId:"item-assets",path:i.walletRoutePaths.assets,regularIcon:c["default"],hoverIcon:d["default"],activeIcon:u["default"],iconClassName:l["default"].tokensLinkIcon},{id:n.MenuItemList.TRANSACTIONS,label:"browserView.sideMenu.links.activity",testId:"item-transactions",path:i.walletRoutePaths.activity,regularIcon:g["default"],hoverIcon:w["default"],activeIcon:S["default"]}];var x=s("../../node_modules/classnames/index.js");var P=s("../../node_modules/react-i18next/dist/es/index.js");var I=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var _=s.n(I);var D=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var N=s.n(D);var B=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var O=s.n(B);var j=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var V=s.n(j);var W=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var M=s.n(W);var L=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var F=s.n(L);var H=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/SideMenu/SideMenuLabel.module.scss");var $={};$.styleTagTransform=F();$.setAttributes=V();$.insert=O().bind(null,"head");$.domAPI=N();$.insertStyleElement=M();var U=_()(H["default"],$);const K=H["default"]&&H["default"].locals?H["default"].locals:void 0;const SideMenuLabel_SideMenuLabel=({children:e,className:t})=>React.createElement("p",{className:classnames(styles.text,t)},e);var G=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/SideMenu/SideMenuItem.module.scss");var q={};q.styleTagTransform=F();q.setAttributes=V();q.insert=O().bind(null,"head");q.domAPI=N();q.insertStyleElement=M();var Y=_()(G["default"],q);const z=G["default"]&&G["default"].locals?G["default"].locals:void 0;function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const SideMenuItem_SideMenuItem=({className:e,...t})=>React.createElement(Menu.Item,_extends({},t,{className:classnames(styles.menuItem,e)}));const getIcon=(e,t,s)=>{if(t===e.path){return e.activeIcon}if(s===e.id){return e.hoverIcon}return e.regularIcon};const SideMenuContent_SideMenuContent=({menuItems:e,activeItemId:t,hoveredItemId:s,onClick:a,onMouseEnter:n,onMouseLeave:o,menuItemClassName:r})=>{const{t:i}=useTranslation();return React.createElement(Menu,{className:styles.menuContainer,"data-testid":"side-menu",selectedKeys:[t],onClick:a,mode:"inline"},e.map(e=>React.createElement(SideMenuItem,{onMouseEnter:()=>n(e.id),onMouseLeave:o,"data-testid":e.testId,key:e.path,className:classnames(styles.menuItem,r)},React.createElement(getIcon(e,t,s),{className:classnames(styles.icon,e.iconClassName)}),React.createElement(SideMenuLabel,{className:styles.concealableMenuLabel},i(e.label)))))};var X=s("./src/stores/index.ts");var Q=s("./src/providers/PostHogClientProvider/index.ts");var J=s("./src/lib/scripts/types/feature-flags.ts");var Z=s("./src/config.ts");var ee=s("./src/multichain/index.ts");const{GOV_TOOLS_URLS:et}=(0,Z.config)();const isPathAvailable=e=>Object.values(routes).includes(e);const SideMenu=()=>{const{push:e,location:{pathname:t},listen:s}=useHistory();const a=useAnalyticsContext();const n=usePostHogClientContext();const o=n.isFeatureFlagEnabled(ExperimentName.DAPP_EXPLORER);const{isSharedWallet:r,environmentName:i}=useWalletStore();const{blockchain:l}=useCurrentBlockchain();const c=!!et[i];const[d,u]=useState();const[m,v]=useState(isPathAvailable(t)?t:routes.assets);useEffect(()=>{const e=s(e=>{v(isPathAvailable(e.pathname)?e.pathname:routes.assets)});return()=>e()},[s]);const sendAnalytics=e=>{if(e)void a.sendEventToPostHog(e)};const handleRedirection=t=>{switch(t.key){case routes.assets:sendAnalytics(PostHogAction.TokenTokensClick);break;case routes.staking:sendAnalytics(PostHogAction.StakingClick);break;case routes.activity:sendAnalytics(PostHogAction.ActivityActivityClick);break;case routes.voting:sendAnalytics(PostHogAction.VotingClick);break;case routes.nfts:sendAnalytics(PostHogAction.NFTsClick);break}e(t.key)};const onMouseEnterItem=e=>{u(e)};const onMouseLeaveItem=()=>u(void 0);const p=[];if(r)p.push(MenuItemList.STAKING);if(!o)p.push(MenuItemList.DAPPS);if(!c)p.push(MenuItemList.VOTING);const g=sideMenuConfig.filter(e=>!p.includes(e.id));return React.createElement(SideMenuContent,{menuItems:l===Blockchain.Cardano?g:bitcoinsideMenuConfig,activeItemId:m,hoveredItemId:d,onClick:handleRedirection,onMouseEnter:onMouseEnterItem,onMouseLeave:onMouseLeaveItem})}},"./src/views/browser-view/components/SocialNetworks/SocialNetworkIcon.tsx":(e,t,s)=>{s.d(t,{SocialNetwork:()=>P});var a=s("../../node_modules/react/index.js");var n=s("./src/providers/ExternalLinkOpenerProvider/index.ts");var o=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var w=s.n(g);var S=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/SocialNetworks/SocialNetworkIcon.module.scss");var y={};y.styleTagTransform=w();y.setAttributes=m();y.insert=d().bind(null,"head");y.domAPI=l();y.insertStyleElement=p();var f=r()(S["default"],y);const b=S["default"]&&S["default"].locals?S["default"].locals:void 0;var E=s("./src/assets/icons/facebook-icon.component.svg");var C=s("./src/assets/icons/site-icon.component.svg");var T=s("./src/assets/icons/feed-icon.component.svg");var k=s("./src/assets/icons/telegram-icon.component.svg");var h=s("./src/assets/icons/github-icon.component.svg");var R=s("./src/assets/icons/twitter-icon.component.svg");var A=s("./src/assets/icons/youtube-icon.component.svg");var x=s("./src/assets/icons/discord-logo.component.svg");const normalizeHref=e=>e&&!e.startsWith("https://")?`https://${e.replace(/^\/+/,"")}`:e;var P;(function(e){e[e["RSS_FEED"]=0]="RSS_FEED";e[e["WEBSITE"]=1]="WEBSITE";e[e["FACEBOOK"]=2]="FACEBOOK";e[e["TELEGRAM"]=3]="TELEGRAM";e[e["GITHUB"]=4]="GITHUB";e[e["TWITTER"]=5]="TWITTER";e[e["YOUTUBE"]=6]="YOUTUBE";e[e["DISCORD"]=7]="DISCORD"})(P||(P={}));const I={[P.RSS_FEED]:T["default"],[P.WEBSITE]:C["default"],[P.FACEBOOK]:E["default"],[P.TELEGRAM]:k["default"],[P.GITHUB]:h["default"],[P.TWITTER]:R["default"],[P.YOUTUBE]:A["default"],[P.DISCORD]:x["default"]};const SocialNetworkIcon=({name:e,href:t})=>{const s=I[e];const a=useExternalLinkOpener();return Icon&&React.createElement("div",{onClick:()=>a(normalizeHref(t)),className:styles.item,"data-testid":`${P[e]}-container`},React.createElement(Icon,{component:s,alt:P[e],className:styles.icon,"data-testid":`${P[e]}-icon`}))}},"./src/views/browser-view/components/TransactionCTAsBox/TransactionCTAsBox.module.scss":(e,t,s)=>{var a=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var n=s.n(a);var o=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var p=s.n(v);var g=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/TransactionCTAsBox/TransactionCTAsBox.module.scss");var w={};w.styleTagTransform=p();w.setAttributes=d();w.insert=l().bind(null,"head");w.domAPI=r();w.insertStyleElement=m();var S=n()(g["default"],w);var y=g["default"]&&g["default"].locals?g["default"].locals:void 0},"./src/views/browser-view/components/TransactionCTAsBox/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/core/dist/index.esm.js");var o=s("./src/views/browser-view/components/Drawer/index.ts");var r=s("./src/providers/AnalyticsProvider/index.ts");var i=s("./src/views/browser-view/components/TransactionCTAsBox/TransactionCTAsBox.module.scss");var l=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var c=s("./src/views/browser-view/features/send-transaction/index.ts");var d=s("./src/stores/index.ts");var u=s("./src/views/browser-view/components/TransactionCTAsBox/useOpenReceiveDrawer.tsx");var m=s("./src/multichain/index.ts");var v=s("./src/views/browser-view/components/TransactionCTAsBox/useBitcoinSendDrawer.tsx");const TransactionCTAsBox=()=>{const{isSharedWallet:e}=useWalletStore();const t=useAnalytics();const s=useOpenTransactionDrawer({content:DrawerContent.SEND_TRANSACTION});const a=useOpenTransactionDrawer({content:DrawerContent.CO_SIGN_TRANSACTION});const n=useBitcoinSendDrawer();const{setTriggerPoint:o}=useAnalyticsSendFlowTriggerPoint();const r=useOpenReceiveDrawer();const{blockchain:i}=useCurrentBlockchain();const openReceive=()=>{r();t.sendEventToPostHog(PostHogAction.ReceiveClick)};const openSend=()=>{e?t.sendEventToPostHog(PostHogAction.SharedWalletsSendClick):t.sendEventToPostHog(PostHogAction.SendClick,{trigger_point:SendFlowTriggerPoints.SEND_BUTTON});i===Blockchain.Cardano?s():n();o(SendFlowTriggerPoints.SEND_BUTTON)};const onCoSignClick=()=>{t.sendEventToPostHog(PostHogAction.SharedWalletsCosignClick);a()};return React.createElement(TransactionCTAs,{buttonClassName:styles.btn,onSendClick:openSend,onReceiveClick:openReceive,onCoSignClick:e?onCoSignClick:void 0})}},"./src/views/browser-view/components/TransactionCTAsBox/useBitcoinSendDrawer.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/browser-view/components/Drawer/DrawerUIContent.tsx");var o=s("./src/views/browser-view/stores/index.ts");var r=s("../../packages/common/dist/index.esm.js");var i=s("../../node_modules/react-i18next/dist/es/index.js");const useBitcoinSendDrawer=()=>{const{t:e}=useTranslation();const[t,s]=useDrawer();const a=useCallback(()=>{const e=(null==t?void 0:t.onClose)||(()=>s());e()},[null==t?void 0:t.onClose,s]);return useCallback(()=>{s({content:DrawerContent.SEND_BITCOIN_TRANSACTION,renderHeader:()=>React.createElement(DrawerNavigation,{title:React.createElement("div",null,e("browserView.transaction.send.title")),onCloseIconClick:a})})},[a,s,e])}},"./src/views/browser-view/components/TransactionCTAsBox/useOpenReceiveDrawer.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/browser-view/components/Drawer/DrawerUIContent.tsx");var o=s("./src/views/browser-view/components/TransactionCTAsBox/TransactionCTAsBox.module.scss");var r=s("./src/views/browser-view/stores/index.ts");var i=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var l=s.n(i);var c=s("../../packages/common/dist/index.esm.js");var d=s("../../node_modules/react-i18next/dist/es/index.js");var u=s("./src/hooks/index.ts");var m=s("./src/providers/index.ts");var v=s("./src/multichain/index.ts");const p=null;const useOpenReceiveDrawer=()=>{const[e,t]=useDrawer();const s=useAnalyticsContext();const{t:a}=useTranslation();const[n,{updateLocalStorage:o}]=useLocalStorage("isReceiveInAdvancedMode",false);const{blockchain:r}=useCurrentBlockchain();const i=useCallback(()=>{const a=(null==e?void 0:e.onClose)||(()=>t());a();s.sendEventToPostHog(PostHogAction.ReceiveYourWalletAddressXClick)},[s,null==e?void 0:e.onClose,t]);return useCallback(()=>{t({content:r===Blockchain.Cardano?DrawerContent.RECEIVE_TRANSACTION:DrawerContent.RECEIVE_BITCOIN_TRANSACTION,renderTitle:()=>React.createElement(Flex,{justifyContent:"space-between",alignItems:"center",className:styles.title},React.createElement(Box,null,React.createElement(DrawerHeader,{title:a("qrInfo.title"),subtitle:a("qrInfo.scanQRCodeToConnectWallet")})),p&&r===Blockchain.Cardano&&React.createElement(ToggleSwitch,{icon:React.createElement(Tooltip,{title:a("qrInfo.advancedMode.toggle.description")},React.createElement(InfoCircleOutlined,null)),defaultChecked:n,label:a("qrInfo.advancedMode.toggle.label"),onCheckedChange:e=>o(e),testId:"advanced-mode-"})),renderHeader:()=>React.createElement(DrawerNavigation,{title:React.createElement("div",null,a("browserView.receiveDrawer.title")),onCloseIconClick:i})})},[i,n,t,o,r,a])}},"./src/views/browser-view/components/WalletUsedAddressesDrawer/index.ts":(e,t,s)=>{var a=s("../../packages/common/dist/index.esm.js");var n=s("../../node_modules/react/index.js");var o=s("./src/stores/index.ts");var r=s("./src/views/browser-view/stores/index.ts");var i=s("../../packages/core/dist/index.esm.js");var l=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var v=s.n(m);var p=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var g=s.n(p);var w=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var S=s.n(w);var y=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var f=s.n(y);var b=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/WalletUsedAddressesDrawer/WalletUsedAddressesDrawer.module.scss");var E={};E.styleTagTransform=f();E.setAttributes=g();E.insert=v().bind(null,"head");E.domAPI=u();E.insertStyleElement=S();var C=c()(b["default"],E);const T=b["default"]&&b["default"].locals?b["default"].locals:void 0;var k=s("../../node_modules/react-i18next/dist/es/index.js");const WalletUsedAddressesDrawer=({usedAddresses:e=[],onCloseClick:t})=>{const{t:s}=useTranslation();const a=React.createElement("div",{className:styles.draweHeaderTitle},React.createElement("h1",{className:styles.title},s("core.receive.usedAddresses.title",{count:e.length})),React.createElement("h4",{className:styles.subtitle},s("core.receive.usedAddresses.subtitle")));return React.createElement(React.Fragment,null,React.createElement(DrawerNavigation,{onCloseIconClick:()=>t()}),React.createElement(DrawerHeader,{title:a}),React.createElement("div",{className:styles.infoContainer},React.createElement(WalletUsedAddressList,{translations:{copy:s("core.receive.usedAddresses.copy"),addressCopied:s("core.receive.usedAddresses.addressCopied")},items:e})))};const WalletUsedAddressesDrawer_WalletUsedAddressesDrawer=()=>{const{inMemoryWallet:e}=useWalletStore();const t=useMemo(()=>{return null==e?void 0:e.addresses$.pipe(map(e=>e.map((e,t)=>({address:e.address.toString(),id:isScriptAddress(e)?t:e.index}))))},[e]);const s=useObservable(t);const[,a]=useDrawer();return React.createElement(Component,{onCloseClick:a,usedAddresses:s})}},"./src/views/browser-view/components/index.ts":(e,t,s)=>{s.d(t,{FundWalletBanner:()=>n.FundWalletBanner,WarningModal:()=>d.WarningModal});var a=s("./src/views/browser-view/components/EducationalList/index.ts");var n=s("./src/views/browser-view/components/FundWalletBanner/index.tsx");var o=s("./src/views/browser-view/components/Layout/index.ts");var r=s("./src/views/browser-view/components/PortfolioBalance/index.ts");var i=s("./src/views/browser-view/components/QRInfoWalletDrawer/index.ts");var l=s("./src/views/browser-view/components/TransactionCTAsBox/index.ts");var c=s("./src/views/browser-view/components/SideMenu/index.ts");var d=s("./src/views/browser-view/components/WarningModal/index.ts");var u=s("./src/views/browser-view/components/SocialNetworks/SocialNetworkIcon.tsx");var m=s("./src/views/browser-view/components/WalletUsedAddressesDrawer/index.ts");var v=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var p=s("../../node_modules/react/index.js");var g=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var y=s.n(S);var f=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var b=s.n(f);var E=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var C=s.n(E);var T=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var k=s.n(T);var h=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var R=s.n(h);var A=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/TopUpWallet/TopUpWallet.module.scss");var x={};x.styleTagTransform=R();x.setAttributes=C();x.insert=b().bind(null,"head");x.domAPI=y();x.insertStyleElement=k();var P=w()(A["default"],x);const I=A["default"]&&A["default"].locals?A["default"].locals:void 0;var _=s("../../node_modules/react-i18next/dist/es/index.js");var D=s("./src/providers/index.ts");const TopUpWalletDialog_TopUpWalletDialog=({open:e,onCancel:t,onConfirm:s,triggerRef:a})=>{const{t:n}=useTranslation();const o=useExternalLinkOpener();const handleOpenTabBanxaHomepage=()=>{o(BANXA_HOMEPAGE_URL)};return React.createElement(Dialog.Root,{open:e,setOpen:t,zIndex:1e3,onCloseAutoFocusRef:a},React.createElement(Dialog.Title,null,n("browserView.assets.topupWallet.modal.title")),React.createElement(Dialog.Description,null,React.createElement(Box,{className:styles.disclaimerFullWrapper},React.createElement(Text.Body.Normal,{weight:"$medium",color:"secondary","data-testid":"top-up-wallet-dialog-disclaimer-part1"},n("browserView.assets.topupWallet.disclaimer.full.part1")),React.createElement(TextLink,{onClick:handleOpenTabBanxaHomepage,label:n("browserView.assets.topupWallet.disclaimer.full.banxaLinkCaption"),testId:"top-up-wallet-dialog-disclaimer-link-caption-1"}),React.createElement(Text.Body.Normal,{weight:"$medium",color:"secondary","data-testid":"top-up-wallet-dialog-disclaimer-part2"},n("browserView.assets.topupWallet.disclaimer.full.part2")),React.createElement(TextLink,{onClick:handleOpenTabBanxaHomepage,label:n("browserView.assets.topupWallet.disclaimer.full.banxaLinkCaption"),testId:"top-up-wallet-dialog-disclaimer-link-caption-2"}))),React.createElement(Dialog.Actions,null,React.createElement(Dialog.Action,{cancel:true,label:n("browserView.assets.topupWallet.modal.goBack"),onClick:t,testId:"top-up-wallet-dialog-go-back-button"}),React.createElement(Dialog.Action,{autoFocus:true,label:n("browserView.assets.topupWallet.modal.continue"),onClick:s,testId:"top-up-wallet-dialog-continue-button"})))};var N=s("../../packages/common/dist/index.esm.js");var B=s("./src/multichain/index.ts");function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const SvgBtcComponentTransparent_SvgBtcComponentTransparent=e=>React.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:25,height:25,fill:"none"},e),React.createElement("path",{d:"M10 6V4M14 6V4M14 6H7M14 6C15.6569 6 17 7.34315 17 9C17 10.6569 15.6569 12 14 12M9 18L9 12M9 6V12M10 20V18M14 20V18M9 12H15C16.6569 12 18 13.3431 18 15C18 16.6569 16.6569 18 15 18H7",stroke:"#FFFFFF"}));const O=null;const TopUpWalletButton_TopUpWalletButton=()=>{const e=useRef(null);const[t,s]=useState(false);const{t:a}=useTranslation();const n=useAnalyticsContext();const o=useExternalLinkOpener();const{blockchain:r}=useCurrentBlockchain();const i="bitcoin"===r;return React.createElement(React.Fragment,null,React.createElement(Button.CallToAction,{icon:i?React.createElement(SvgBtcComponentTransparent,null):React.createElement(AdaComponentTransparent,null),label:a(i?"browserView.assets.topupWallet.buyButton.captionBtc":"browserView.assets.topupWallet.buyButton.caption"),onClick:()=>{n.sendEventToPostHog(PostHogAction.TokenTokensTopYourWalletBuyAdaClick);s(true)},ref:e,"data-testid":"top-up-wallet-card-button"}),React.createElement(TopUpWalletDialog,{onCancel:()=>{n.sendEventToPostHog(PostHogAction.TokenBuyAdaDisclaimerGoBackClick);s(false)},open:t,triggerRef:e,onConfirm:()=>{n.sendEventToPostHog(PostHogAction.TokenBuyAdaDisclaimerContinueClick);o(BANXA_LACE_URL);s(false)}}))};const TopUpWalletCard=()=>{const{t:e}=useTranslation();const{blockchain:t}=useCurrentBlockchain();const s="bitcoin"===t;return React.createElement(Card.Outlined,{className:styles.card,"data-testid":"top-up-wallet-card"},React.createElement(Flex,{flexDirection:"column",mx:"$20",my:"$20",gap:"$6",alignItems:"stretch"},React.createElement("div",{className:styles.titleBadge,"data-testid":"top-up-wallet-card-badge"},React.createElement(Text.Label,{className:styles.badgeCaption,weight:"$medium"},e("browserView.assets.topupWallet.card.badge"))),React.createElement(Flex,{my:"$10"},React.createElement(Text.SubHeading,{weight:"$bold","data-testid":"top-up-wallet-card-title"},e("browserView.assets.topupWallet.card.title"))),React.createElement(Flex,{flexDirection:"column",alignItems:"stretch",gap:"$16",mt:"$10"},React.createElement(Text.Body.Normal,{weight:"$medium",color:"secondary","data-testid":"top-up-wallet-card-subtitle"},e(s?"browserView.assets.topupWallet.buyButtonBtc.title":"browserView.assets.topupWallet.buyButton.title")),React.createElement(TopUpWalletButton,null),React.createElement(Text.Label,{weight:"$medium",className:styles.disclaimerShort,"data-testid":"top-up-wallet-card-disclaimer"},e(s?"browserView.assets.topupWallet.disclaimer.shortBtc":"browserView.assets.topupWallet.disclaimer.short")))))};var j=s("./src/assets/icons/empty.svg");var V=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/EmptySearch/EmptySearch.module.scss");var W={};W.styleTagTransform=R();W.setAttributes=C();W.insert=b().bind(null,"head");W.domAPI=y();W.insertStyleElement=k();var M=w()(V["default"],W);const L=V["default"]&&V["default"].locals?V["default"].locals:void 0;const EmptySearch=({text:e})=>React.createElement("div",{className:styles.container},React.createElement(Image,{preview:false,src:Empty}),React.createElement("div",{className:styles.text},e))},"./src/views/browser-view/features/activity/components/ActivityDetail.tsx":(e,t,s)=>{s.d(t,{getTransactionData:()=>getTransactionData});var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/lodash/uniq.js");var o=s.n(n);var r=s("../../node_modules/lodash/flatMap.js");var i=s.n(r);var l=s("../../packages/cardano/dist/index.esm.js");var c=s("../../packages/core/dist/index.esm.js");var d=s("./src/stores/index.ts");var u=s("./src/providers/index.ts");var m=s("./src/features/address-book/context/index.ts");var v=s("./src/types/index.ts");var p=s("./src/utils/constants.ts");var g=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var w=s("./src/features/dapp/components/confirm-transaction/hooks.ts");var S=s("../../packages/common/dist/index.esm.js");var y=s("./src/utils/get-all-wallets-addresses.ts");var f=s("./src/lib/wallet-api-ui.ts");const b=(0,m.withAddressBookContext)(({name:e,activityInfo:t,direction:s,status:n,amountTransformer:o})=>{var r;const i=(0,u.useAnalyticsContext)();const{inMemoryWallet:l,walletInfo:b,walletUI:{cardanoCoin:E,appMode:C},currentChain:T}=(0,d.useWalletStore)();const k=C===p.APP_MODE_POPUP;const h=(0,u.useExternalLinkOpener)();const R=(0,y.getAllWalletsAddresses)((0,S.useObservable)(f.walletRepository.wallets$));const A=null===(r=(0,S.useObservable)(l.addresses$))||void 0===r?void 0:r.map(e=>e.address);const{list:x}=(0,m.useAddressBookContext)();const P=(0,w.useCexplorerBaseUrl)();const I=(0,a.useMemo)(()=>{return new Map(null==x?void 0:x.map(e=>[e.address,e.name]))},[x]);const getHeaderDescription=()=>{if(t.type===c.DelegationActivityType.delegation)return"1 token";return` (${null==t?void 0:t.assetAmount})`};const _=s===v.TxDirections.Incoming;const{addrOutputs:D,addrInputs:N,hash:B,includedUtcDate:O,includedUtcTime:j,fee:V,pools:W,deposit:M,depositReclaim:L,metadata:F,proposalProcedures:H,votingProcedures:$,certificates:U,collateral:K}=t.activity;const G=(0,a.useMemo)(()=>getTransactionData({addrOutputs:D,addrInputs:N,walletAddresses:b.addresses.map(e=>e.address.toString()),isIncomingTransaction:_}),[_,D,N,b.addresses]);const handleOpenExternalHashLink=()=>{i.sendEventToPostHog(g.PostHogAction.ActivityActivityDetailTransactionHashClick);const e=`${P}/${B}`;e&&n===c.ActivityStatus.SUCCESS&&h(e)};return a.createElement(c.TransactionDetails,{name:e,hash:B,status:n,includedDate:O,includedTime:j,addrInputs:N,addrOutputs:D,fee:V,pools:W,deposit:M,depositReclaim:L,metadata:F,amountTransformer:o,headerDescription:getHeaderDescription()||E.symbol,txSummary:G,ownAddresses:R.length>0?R:A,addressToNameMap:I,coinSymbol:E.symbol,isPopupView:k,sendAnalyticsInputs:()=>i.sendEventToPostHog(g.PostHogAction.ActivityActivityDetailInputsClick),sendAnalyticsOutputs:()=>i.sendEventToPostHog(g.PostHogAction.ActivityActivityDetailOutputsClick),proposalProcedures:H,votingProcedures:$,certificates:U,handleOpenExternalHashLink:handleOpenExternalHashLink,collateral:K,chainNetworkId:T.networkId,cardanoCoin:E,explorerBaseUrl:P})});var E=s("../../node_modules/react-i18next/dist/es/index.js");var C=s("./src/hooks/index.ts");var T=s("./src/views/browser-view/features/activity/index.ts");var k=s("./src/lib/scripts/background/util.ts");const formatRows=({txSummary:e,amountTransformer:t,cardanoCoin:s,addressToNameMap:a})=>e.map(({amount:e,assetList:n,addr:o})=>{const r={assetAmount:`${e} ${s.symbol}`,fiatAmount:t(e)};const i=n.map(({amount:e,fiatBalance:t})=>({assetAmount:e,fiatAmount:t}));return{list:[r,...i],recipientAddress:o[0],recipientName:a.get(o[0])}});const h=(0,m.withAddressBookContext)(({amountTransformer:e,activityInfo:t,direction:s})=>{var n;const{walletUI:{cardanoCoin:o},walletInfo:r,activityDetail:i}=(0,d.useWalletStore)();const{walletRepository:l}=(0,C.useWalletManager)();const u=(0,S.useObservable)(l.wallets$);const p=(0,C.useCurrentWallet)();const g=(0,k.getParentWalletCIP1854Account)({wallets:u,activeWallet:p});const w=null==g?void 0:g.extendedAccountPublicKey;const y=null==p?void 0:null===(n=p.metadata)||void 0===n?void 0:n.coSigners;const f=(0,c.useSignPolicy)(p,"payment");const[b,E]=(0,a.useState)([]);const{list:h}=(0,m.useAddressBookContext)();(0,a.useEffect)(()=>{(async()=>{if(!y)return;const e=i.activity;const t=e.witness.signatures;const s=await Promise.all(y.map(async e=>({...e,signed:await (0,c.hasSigned)(e.sharedWalletKey,"payment",t)})));E(s)})()},[i.activity,y,w]);const R=(0,a.useMemo)(()=>{return new Map(null==h?void 0:h.map(e=>[e.address,e.name]))},[h]);const{addrOutputs:A,addrInputs:x,fee:P}=t.activity;const I=(0,a.useMemo)(()=>(0,T.getTransactionData)({addrOutputs:A,addrInputs:x,walletAddresses:r.addresses.map(e=>e.address.toString()),isIncomingTransaction:s===v.TxDirections.Incoming}),[A,x,r.addresses,s]);const _=(0,a.useMemo)(()=>formatRows({txSummary:I,amountTransformer:e,cardanoCoin:o,addressToNameMap:R}),[R,e,o,I]);return a.createElement(c.SharedWalletTransactionDetails,{amountTransformer:e,coinSymbol:o.symbol,cosigners:b,fee:P,ownSharedKey:w,rows:_,signPolicy:{requiredCosigners:null==f?void 0:f.requiredCosigners,signers:(null==f?void 0:f.signers)||[]},status:c.ActivityStatus.AWAITING_COSIGNATURES,txInitiator:w})});const R=5;const getTransactionData=({addrOutputs:e,addrInputs:t,walletAddresses:s,isIncomingTransaction:a})=>{if(!e||!t||!s){return[]}if(a){const n=e.filter(e=>s.includes(e.addr));const r=o()(i()(t,e=>s.includes(e.addr)?[]:[e.addr]));return n.map(e=>({...e,addr:r.slice(0,R),type:c.TransactionActivityType.incoming}))}return e.filter(e=>!s.includes(e.addr)).map(e=>({...e,...!Array.isArray(e.addr)&&{addr:[e.addr]},type:c.TransactionActivityType.outgoing}))};const getCurrentTransactionStatus=(e,t)=>{const s=e.find(e=>"Today"===e.title);const a=null==s?void 0:s.items.find(e=>e.id===String(t));return null==a?void 0:a.status};const getTypeLabel=e=>{if(e===DelegationActivityType.delegationRegistration||e===ConwayEraCertificatesTypes.Registration)return"core.activityDetails.registration";if(e===DelegationActivityType.delegationDeregistration||e===ConwayEraCertificatesTypes.Unregistration)return"core.activityDetails.deregistration";if(e===TransactionActivityType.incoming)return"core.activityDetails.received";if(e===TransactionActivityType.outgoing)return"core.activityDetails.sent";if(e===TransactionActivityType.awaitingCosignatures)return"core.activityDetails.awaitingCosignatures";return`core.activityDetails.${e}`};const ActivityDetail=({price:e})=>{const{walletUI:{cardanoCoin:t}}=useWalletStore();const{t:s}=useTranslation();const{getActivityDetail:a,activityDetail:n,fetchingActivityInfo:o,walletActivities:r}=useWalletStore();const[i,l]=useState();const{fiatCurrency:c}=useCurrencyStore();var d;const u=useMemo(()=>{return n.type!==TransactionActivityType.rewards&&null!==(d=getCurrentTransactionStatus(r,n.activity.id))&&void 0!==d?d:null==i?void 0:i.status},[n.activity,n.type,null==i?void 0:i.status,r]);const m=useCallback(async()=>{const t=await a({coinPrices:e,fiatCurrency:c});l(t)},[a,l,e,c]);useEffect(()=>{m()},[]);if(o||!i)return React.createElement(Skeleton,{"data-testid":"transaction-details-skeleton"});const v=s(i.status===ActivityStatus.PENDING?"core.activityDetails.sending":getTypeLabel(i.type));const amountTransformer=t=>{var s;return`${Wallet.util.convertAdaToFiat({ada:t,fiat:null==e?void 0:null===(s=e.cardano)||void 0===s?void 0:s.price})} ${null==c?void 0:c.code}`};if(i.type===TransactionActivityType.rewards){return React.createElement(RewardsDetails,{name:v,includedDate:i.activity.includedUtcDate,includedTime:i.activity.includedUtcTime,amountTransformer:amountTransformer,coinSymbol:t.symbol,rewards:i.activity.rewards})}if(i.type===TransactionActivityType.awaitingCosignatures){return React.createElement(SharedWalletTransactionDetailsWrapper,{amountTransformer:amountTransformer,activityInfo:i,direction:n.direction})}return React.createElement(TransactionDetailsProxy,{name:v,activityInfo:i,direction:n.direction,status:u,amountTransformer:amountTransformer})}},"./src/views/browser-view/features/activity/index.ts":(e,t,s)=>{s.d(t,{getTransactionData:()=>n.getTransactionData});var a=s("./src/views/browser-view/features/activity/components/ActivityLayout.tsx");var n=s("./src/views/browser-view/features/activity/components/ActivityDetail.tsx")},"./src/views/browser-view/features/assets/components/AssetEducationalList/AssetEducationalList.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-i18next/dist/es/index.js");var o=s("./src/assets/icons/book.svg");var r=s("./src/assets/icons/light.svg");var i=s("./src/assets/icons/video.svg");var l=s("./src/views/browser-view/components/EducationalList/index.ts");const c="educationalBanners.title.faq";const getEducationalList=e=>[{title:e("educationalBanners.title.glossary"),subtitle:e("educationalBanners.subtitle.whatIsADigitalAsset"),src:Book,link:"https://www.lace.io/glossary?term=asset"},{title:e(c),subtitle:e("educationalBanners.subtitle.howToSendReceiveFunds"),src:LightBulb,link:"https://www.lace.io/faq?question=how-do-i-send-and-receive-digital-assets"},{title:e("educationalBanners.title.video"),subtitle:e("educationalBanners.subtitle.secureSelfCustody"),src:Video,link:"https://www.lace.io/learn?video=how-lace-gives-you-full-control-of-your-private-keys"},{title:e("educationalBanners.title.video"),subtitle:e("educationalBanners.subtitle.connectingDApps"),src:Video,link:"https://www.lace.io/learn?video=connecting-to-dapps-with-lace"},{title:e(c),subtitle:e("educationalBanners.subtitle.conwayEra"),src:LightBulb,link:"https://www.lace.io/faq?question=how-is-the-conway-ledger-era-also-called-governance-era-supported-by-lace"},{title:e(c),subtitle:e("educationalBanners.subtitle.governanceFeatures"),src:LightBulb,link:"https://www.lace.io/faq?question=what-type-of-governance-features-are-supported-in-lace-using-the-govtool-in-the-current"},{title:e(c),subtitle:e("educationalBanners.subtitle.governanceActions"),src:LightBulb,link:"https://www.lace.io/faq?question=what-type-of-governance-actions-are-supported-by-lace"}];const AssetEducationalList=()=>{const{t:e}=useTranslation();const t=useMemo(()=>getEducationalList(e),[e]);return React.createElement(EducationalList,{items:t,title:e("browserView.sidePanel.aboutYourWallet")})}},"./src/views/browser-view/features/assets/components/AssetsPortfolio/AssetPortfolioContent.tsx":(e,t,s)=>{s.d(t,{searchToken:()=>searchToken});var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var o=s.n(n);var r=s("./src/views/browser-view/components/index.ts");var i=s("../../packages/core/dist/index.esm.js");var l=s("./src/components/Layout/index.ts");var c=s("./src/utils/constants.ts");var d=s("../../node_modules/react-i18next/dist/es/index.js");var u=s("./src/stores/index.ts");var m=s("./src/views/browser-view/features/assets/components/AssetsPortfolio/AssetsPortfolio.module.scss");const v=10;const p=["name","policyId","fingerprint","ticker"];const searchToken=(e,t)=>{return p.some(s=>{var a;return s in e&&(null===(a=e[s])||void 0===a?void 0:a.toLowerCase().includes(t))})};const searchTokens=(e,t)=>{const s=t.toLowerCase();return e.filter(e=>searchToken(e,s))};const AssetPortfolioContent=({assetList:e,totalAssets:t,isPortfolioBalanceLoading:s,onRowClick:a,onTableScroll:n,isPopupView:o})=>{const{t:r}=useTranslation();const[i,l]=useState("");const[c,d]=useState({data:e,total:t});const{walletInfo:u}=useWalletStore();useEffect(()=>{d({data:i?c.data:e,total:i?c.total:t})},[e,c.data,c.total,i,t]);const m=useCallback(t=>{const s=searchTokens(e,t);l(t);d({data:s,total:s.length})},[e]);return React.createElement(React.Fragment,null,t>v&&React.createElement("div",{className:styles.searchBoxContainer},React.createElement(SearchBox,{placeholder:r("browserView.assets.searchPlaceholder"),onChange:m,"data-testid":"assets-search-input",value:i,onClear:()=>l("")})),i&&0===c.total&&React.createElement(EmptySearch,{text:r("browserView.assets.emptySearch")}),!i&&0===c.total&&React.createElement(FundWalletBanner,{title:r("browserView.assets.welcome"),subtitle:r("browserView.assets.startYourWeb3Journey"),prompt:r("browserView.fundWalletBanner.prompt"),walletAddress:u.addresses[0].address.toString()}),React.createElement(Skeleton,{loading:s||!c.data},c.total>0&&React.createElement(AssetTable,{rows:c.data,onRowClick:a,totalItems:c.total,scrollableTargetId:o?CONTENT_LAYOUT_ID:LACE_APP_ID,onLoad:n,popupView:o})))}},"./src/views/browser-view/features/assets/components/AssetsPortfolio/AssetsPortfolio.module.scss":(e,t,s)=>{var a=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var n=s.n(a);var o=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var p=s.n(v);var g=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/assets/components/AssetsPortfolio/AssetsPortfolio.module.scss");var w={};w.styleTagTransform=p();w.setAttributes=d();w.insert=l().bind(null,"head");w.domAPI=r();w.insertStyleElement=m();var S=n()(g["default"],w);var y=g["default"]&&g["default"].locals?g["default"].locals:void 0},"./src/views/browser-view/features/assets/components/MidnightEventBanner.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/core/dist/index.esm.js");var o=s("./src/stores/index.ts");var r=s("./src/utils/constants.ts");var i=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var l=s.n(i);var c=s("../../node_modules/webextension-polyfill/dist/browser-polyfill.js");var d=s.n(c);var u=s("./src/lib/scripts/types/index.ts");var m=s("../../node_modules/react-i18next/dist/es/index.js");const v=Number.parseInt("129600000");const MidnightEventBanner=()=>{const{t:e}=useTranslation();const{walletUI:{appMode:t}}=useWalletStore();const s=t===APP_MODE_POPUP;const[a,n]=useState({isLoading:true,isDialogOpen:false,data:void 0});useEffect(()=>{const loadStorage=async()=>{const e=await storage.local.get(MIDNIGHT_EVENT_BANNER_KEY);var t;n({isLoading:false,isDialogOpen:false,data:null!==(t=e[MIDNIGHT_EVENT_BANNER_KEY])&&void 0!==t?t:{lastSeen:0,closed:false}})};loadStorage()},[]);const shouldHide=()=>{if(true){return true}if(a.isLoading){return true}if(a.data.closed){return true}if(a.data.lastSeen>0&&a.data.lastSeen>Date.now()-v){return true}return false};if(shouldHide()){return React.createElement(Fragment,null)}const updateState=async e=>{await storage.local.set({[MIDNIGHT_EVENT_BANNER_KEY]:e});n(t=>({...t,data:e}))};const handleReminder=async()=>{const e={...a.data,lastSeen:Date.now()};await updateState(e)};const hideBanner=async()=>{const e={...a.data,closed:true};await updateState(e)};const handleDialog=e=>{n(t=>({...t,isDialogOpen:e}))};return React.createElement(React.Fragment,null,React.createElement(Dialog.Root,{open:a.isDialogOpen,setOpen:handleDialog,zIndex:999},React.createElement(Dialog.Title,null,e("midnightEventBanner.dialog.title")),React.createElement(Dialog.Description,null,e("midnightEventBanner.dialog.description")),React.createElement(Dialog.Actions,null,React.createElement(Dialog.Action,{cancel:true,label:e("midnightEventBanner.dialog.cancel"),onClick:()=>{handleDialog(false)}}),React.createElement(Dialog.Action,{label:e("midnightEventBanner.dialog.confirm"),onClick:()=>{handleDialog(false);hideBanner()}}))),React.createElement(Box,{className:sx({mb:{mediumScreen:"$20",popupScreen:"$16"}})},React.createElement(View,{translations:{title:e(s?"midnightEventBanner.popup.title":"midnightEventBanner.desktop.title"),description:e(s?"midnightEventBanner.popup.description":"midnightEventBanner.desktop.description"),moreDetails:e("midnightEventBanner.moreDetails"),reminder:e("midnightEventBanner.reminder")},onReminder:handleReminder,onClose:()=>handleDialog(true)})))}},"./src/views/browser-view/features/assets/components/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/lodash/isNil.js");var o=s("../../packages/cardano/dist/index.esm.js");var r=s("../../packages/core/dist/index.esm.js");var i=s("../../packages/common/dist/index.esm.js");var l=s("./src/hooks/index.ts");var c=s("./src/stores/index.ts");var d=s("./src/providers/currency/index.ts");var u=s("./src/utils/assets-transformers.ts");var m=s("./src/views/browser-view/components/index.ts");var v=s("./src/views/browser-view/components/Drawer/index.ts");var p=s("./src/routes/index.ts");var g=s("./src/utils/constants.ts");var w=s("./src/components/Layout/index.ts");var S=s("./src/providers/index.ts");var y=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var f=s("./src/views/browser-view/features/send-transaction/index.ts");var b=s("../../node_modules/bignumber.js/bignumber.js");const utils_sortAssets=({sortBy:e},{sortBy:t})=>{if(void 0!==e.fiatBalance&&void 0===t.fiatBalance)return -1;if(void 0===e.fiatBalance&&void 0!==t.fiatBalance)return 1;if(e.fiatBalance!==t.fiatBalance)return t.fiatBalance-e.fiatBalance;if(void 0!==e.amount&&void 0===t.amount)return -1;if(void 0===e.amount&&void 0!==t.amount)return 1;const s=new BigNumber(e.amount);const a=new BigNumber(t.amount);if(void 0!==e.amount&&void 0!==t.amount&&!s.isEqualTo(a))return a.minus(s).isLessThan(0)?-1:1;if(void 0!==e.metadataName&&void 0===t.metadataName)return -1;if(void 0===e.metadataName&&void 0!==t.metadataName)return 1;if(e.metadataName>t.metadataName)return 1;if(e.metadataName<t.metadataName)return -1;if(e.fingerprint>t.fingerprint)return 1;if(e.fingerprint<t.fingerprint)return -1;return 0};const utils_getTotalWalletBalance=(e,t,s,a,n)=>{if(!s)return e;const o=t?[...t.entries()].reduce((e,[t,{priceInAda:o}])=>{const r=null==s?void 0:s.get(t);const i=null==n?void 0:n.get(t);if((null==i?void 0:i.tokenMetadata)!==void 0&&r){const l=Wallet.util.calculateAssetBalance(r,i);const c=getTokenAmountInFiat(l,o,a);return e.plus(c)}return e},new BigNumber(0)):new BigNumber(0);return o.plus(e).toString()};var E=s("../../node_modules/dayjs/dayjs.min.js");var C=s("../../node_modules/react-i18next/dist/es/index.js");var T=s("./src/components/Layout/SectionTitle.tsx");var k=s("./src/utils/format-number.ts");var h=s("./src/hooks/useFetchCoinPrice.ts");var R=s("./src/hooks/useRedirection.ts");var A=s("./src/routes/wallet-paths.ts");var x=s("./src/providers/AnalyticsProvider/index.ts");var P=s("./src/views/browser-view/features/assets/components/AssetsPortfolio/AssetsPortfolio.module.scss");var I=s("./src/views/browser-view/features/assets/components/AssetsPortfolio/AssetPortfolioContent.tsx");var _=s("./src/hooks/useIsSmallerScreenWidthThan.ts");var D=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");const N=3;const AssetsPortfolio_AssetsPortfolio=({appMode:e,assetList:t,portfolioTotalBalance:s,isBalanceLoading:a=false,isLoadingFirstTime:n=false,onRowClick:o,onTableScroll:r,totalAssets:i=0})=>{const l=useFetchCoinPrice();const c=useAnalyticsContext();const{t:d}=useTranslation();const{walletUI:{canManageBalancesVisibility:u,areBalancesVisible:m},currentChain:v}=useWalletStore();const{fiatCurrency:p}=useCurrencyStore();const g=useRedirection(walletRoutePaths.receive);const w=useRedirection(walletRoutePaths.send);const S=useIsSmallerScreenWidthThan(BREAKPOINT_SMALL);const y=e===APP_MODE_POPUP;const f=(null==v?void 0:v.networkMagic)===Wallet.Cardano.NetworkMagics.Mainnet;const b=useMemo(()=>new BigNumber(s),[s]);const E=useMemo(()=>new BigNumber(s).isNaN()||a,[a,s]);const handleRedirectToReceive=()=>{c.sendEventToPostHog(PostHogAction.ReceiveClick);g()};const openSend=()=>{c.sendEventToPostHog(PostHogAction.SendClick,{trigger_point:SendFlowTriggerPoints.SEND_BUTTON});w({params:{id:"1"}})};const C=useMemo(()=>"error"===l.status&&l.timestamp?dayjs().diff(l.timestamp,"minutes")>=N:"error"===l.status,[l]);return React.createElement(Skeleton,{loading:n},React.createElement(SectionTitle,{title:d("browserView.assets.title"),sideText:`(${i})`,classname:styles.headerContainer}),React.createElement("div",{className:styles.portfolio},React.createElement(PortfolioBalance,{loading:E,balance:compactNumberWithUnit(b.toString()),currencyCode:p.code,label:d("browserView.assets.totalWalletBalance"),isPriceOutdatedBannerVisible:C,lastPriceFetchedDate:l.timestamp,showInfoTooltip:true,showBalanceVisibilityToggle:!b.eq(0)&&u,isBalanceVisible:m||b.eq(0)})),y&&b.gt(0)&&React.createElement(TransactionCTAs,{onSendClick:openSend,onReceiveClick:handleRedirectToReceive,popupView:true,buttonClassName:styles.testPopupClass}),!y&&S&&USE_FOOR_TOPUP&&f&&React.createElement(Flex,{flexDirection:"column",gap:"$10",mb:"$16",testId:"top-up-wallet-small-card"},React.createElement(Text.Body.Normal,{weight:"$medium",color:"secondary","data-testid":"top-up-wallet-small-card-title"},d("browserView.assets.topupWallet.buyButton.title")),React.createElement(Flex,{flexDirection:"column",alignItems:"stretch",w:"$294"},React.createElement(TopUpWalletButton,null)),React.createElement(Text.Label,{weight:"$medium",className:styles.topupWalletDisclaimerShort,"data-testid":"top-up-wallet-small-card-disclaimer"},d("browserView.assets.topupWallet.disclaimer.short"))),React.createElement(AssetPortfolioContent,{totalAssets:i,assetList:t,isPortfolioBalanceLoading:E,onRowClick:o,onTableScroll:r,isPopupView:y}))};var B=s("../../node_modules/classnames/index.js");var O=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var j=s.n(O);var V=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var W=s.n(V);var M=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var L=s.n(M);var F=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var H=s.n(F);var $=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var U=s.n($);var K=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var G=s.n(K);var q=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/assets/components/AssetDetailsDrawer/AssetDrawerTitle.module.scss");var Y={};Y.styleTagTransform=G();Y.setAttributes=H();Y.insert=L().bind(null,"head");Y.domAPI=W();Y.insertStyleElement=U();var z=j()(q["default"],Y);const X=q["default"]&&q["default"].locals?q["default"].locals:void 0;const AssetDrawerTitle_AssetDrawerTitle=({logo:e,defaultLogo:t,title:s,code:a})=>React.createElement("div",{className:styles.assetDetailsHeader,"data-testid":"asset-details-header"},React.createElement(ImageWithFallback,{src:e,fallbackSrc:t,alt:"asset-logo","data-testid":"token-logo"}),React.createElement("div",{className:styles.assetName},React.createElement("h1",{"data-testid":"token-name"},s),React.createElement("p",{"data-testid":"token-ticker"},a)));var Q=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/assets/components/AssetDetailsDrawer/AssetDetailsDrawer.module.scss");var J={};J.styleTagTransform=G();J.setAttributes=H();J.insert=L().bind(null,"head");J.domAPI=W();J.insertStyleElement=U();var Z=j()(Q["default"],J);const ee=Q["default"]&&Q["default"].locals?Q["default"].locals:void 0;var et=s("./src/hooks/useEnterKeyPress.ts");var es=s("../../node_modules/lodash/flatten.js");var ea=s("./src/views/browser-view/components/PortfolioBalance/index.ts");var en=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/assets/components/AssetDetailsDrawer/AssetDetails.module.scss");var eo={};eo.styleTagTransform=G();eo.setAttributes=H();eo.insert=L().bind(null,"head");eo.domAPI=W();eo.insertStyleElement=U();var er=j()(en["default"],eo);const ei=en["default"]&&en["default"].locals?en["default"].locals:void 0;var el=s("../../node_modules/antd/es/typography/index.js");var ec=s("./src/providers/ExternalLinkOpenerProvider/index.ts");var ed=s("./src/config.ts");const{Text:eu}=el["default"];const{CEXPLORER_BASE_URL:em,CEXPLORER_URL_PATHS:ev}=(0,ed.config)();const AssetDetails_AssetDetails=({balance:e,assetSymbol:t,policyId:s,fingerprint:a,fiatPrice:n,fiatCode:o,fiatPriceVariation:r,balanceInFiat:i,activityList:l,activityListStatus:c,onViewAllClick:d,popupView:u=false,isDrawerView:m=false})=>{const{t:v}=useTranslation();const{environmentName:p}=useWalletStore();const g=useExternalLinkOpener();const w=useMemo(()=>em[p],[p]);const S=c===StateStatus.IDLE||c===StateStatus.LOADING;return React.createElement("div",{className:classnames(styles.detailsContainer,u&&styles.popupDetails)},React.createElement("div",{"data-testid":"token-price"},React.createElement(PortfolioBalance,{balance:n,currencyCode:"-"===n?"":o,balanceSubtitle:{value:r,isPercentage:"-"!==r},label:v(u?"browserView.assetDetails.price":"browserView.assetDetails.assetPrice"),textSize:"medium",showInfoTooltip:!m})),React.createElement("div",{"data-testid":"token-balance"},React.createElement(PortfolioBalance,{balance:e,currencyCode:t,balanceSubtitle:{value:i,isPercentage:false},label:v("browserView.assetDetails.assetBalance"),textSize:"medium",showInfoTooltip:!m})),React.createElement(Skeleton,{loading:S},React.createElement("div",{className:styles.separator}),React.createElement("div",{className:styles.listHeader},React.createElement("div",{className:styles.activityListWrapper},React.createElement("div",{className:styles.activityListHeader},React.createElement(eu,{className:styles.listTitle,"data-testid":"asset-activity-list-title"},v("browserView.assetDetails.recentTransactions")),React.createElement(Button,{variant:"text",color:"primary",className:styles.viewAll,onClick:d,"data-testid":"view-all-button"},v("browserView.assetDetails.viewAll"))),React.createElement(AssetActivityList,{items:l,isDrawerView:m})))),a&&s&&React.createElement(React.Fragment,null,React.createElement("div",{className:styles.separator}),React.createElement("div",{className:styles.listHeader},React.createElement("div",{"data-testid":"token-information",className:styles.tokenInformationWrapper},React.createElement(eu,{className:styles.listTitle,"data-testid":"token-information-title"},v("browserView.assetDetails.tokenInformation")),React.createElement(InlineInfoList,{items:[{name:v("browserView.assetDetails.fingerprint"),value:a,showCopyIcon:true,onClick:()=>g(`${w}/${ev.Asset}/${a}`)},{name:v("browserView.assetDetails.policyId"),value:s,showCopyIcon:true,onClick:()=>g(`${w}/${ev.Policy}/${s}`)}]})))))};var ep=s("./src/lib/scripts/types/index.ts");var eg=s("./src/providers/BackgroundServiceAPI/index.ts");var ew=s("./src/hooks/useWalletActivities.ts");const eS="asset-drawer-body";const ey=3;const AssetDetailsContainer_AssetDetailsContainer=({popupView:e,fiatCode:t})=>{const s=useRedirection(walletRoutePaths.activity);const{assetDetails:a,setAssetDetails:n}=useWalletStore();const o=useBackgroundServiceAPIContext();const r=useAnalyticsContext();const{walletActivities:i,walletActivitiesStatus:l}=useWalletActivities();const setVisibility=()=>n();useEffect(()=>{const e=document.querySelector(".ant-drawer-body");if(e)null==e?void 0:e.setAttribute("id",eS)},[]);const handleOpenTransaction=async()=>{r.sendEventToPostHog(PostHogAction.TokenTokenDetailViewAllClick);if(e)await o.handleOpenBrowser({section:BrowserViewSections.TRANSACTION});else{setVisibility();s()}};const c=flatten(i.slice(0,ey).map((e,t,s)=>{const a=flatten(s.slice(0,t).map(e=>e.items)).length;return e.items.slice(0,a<ey?ey-a:0)}).filter(e=>e.length>0));return React.createElement(AssetDetails,{balance:null==a?void 0:a.balance,assetSymbol:null==a?void 0:a.ticker,fiatPrice:null==a?void 0:a.price,policyId:null==a?void 0:a.policyId,fingerprint:null==a?void 0:a.fingerprint,fiatCode:t,fiatPriceVariation:(null==a?void 0:a.variation)||"-",balanceInFiat:(null==a?void 0:a.fiatBalance)==="-"?null==a?void 0:a.fiatBalance:`${null==a?void 0:a.fiatBalance}`,activityList:c,activityListStatus:l,onViewAllClick:handleOpenTransaction,popupView:e,isDrawerView:true})};const renderFooter=(e,t,s)=>React.createElement("div",{className:classnames(styles.footerContainer,{[styles.footerContainerPopup]:s})},React.createElement(Button,{id:buttonIds.tokenBtnId,onClick:e,className:styles.footerButton},t));const AssetDetailsDrawer_AssetDetailsDrawer=({fiatCode:e,openSendDrawer:t,popupView:s=false})=>{const{t:a}=useTranslation();const{blockchainProvider:n,assetDetails:o,setAssetDetails:r}=useWalletStore();const i=useAnalyticsContext();const l=!!o;const c=useCallback(()=>r(),[r]);useEffect(()=>{const e=document.querySelector(".ant-drawer-body");if(e)e.setAttribute("id",ASSET_DRAWER_BODY_ID)},[]);const handleOpenSend=()=>{return t(null==o?void 0:o.id)};useEffect(()=>{c()},[n,c]);return React.createElement(Drawer,{className:styles.drawer,navigation:React.createElement(DrawerNavigation,{title:a("browserView.assetDetails.title"),onCloseIconClick:()=>{i.sendEventToPostHog(PostHogAction.TokenTokenDetailXClick);c()}}),footer:renderFooter(handleOpenSend,a("browserView.assets.send"),s),open:l,destroyOnClose:true,onClose:c,popupView:s,closable:true},React.createElement("div",{className:classnames(styles.container,{[styles.popupContainer]:s})},React.createElement(AssetDrawerTitle,{logo:null==o?void 0:o.logo,defaultLogo:null==o?void 0:o.defaultLogo,title:null==o?void 0:o.name,code:null==o?void 0:o.ticker}),React.createElement(AssetDetailsContainer,{fiatCode:e,popupView:s})))};var ef=s("./src/views/browser-view/features/activity/index.ts");const AssetActivityDetails_AssetActivityDetails=({afterOpenChange:e,appMode:t,onBack:s,onClose:a,isVisible:n})=>{const{priceResult:o}=useFetchCoinPrice();const{activityDetail:r}=useWalletStore();return React.createElement(Drawer,{afterOpenChange:e,open:n,onClose:a,navigation:React.createElement(DrawerNavigation,{onCloseIconClick:a,onArrowIconClick:s}),popupView:t===APP_MODE_POPUP},r&&o&&React.createElement(ActivityDetail,{price:o}))};var eb=s("./src/views/browser-view/features/assets/components/AssetEducationalList/AssetEducationalList.tsx");var eE=s("./src/views/browser-view/features/assets/components/MidnightEventBanner.tsx");const eC=80;const eT="output1";const ek=2;const Assets_Assets=({topSection:e})=>{var t,s,a,n;const o=useAnalyticsContext();const r=useOpenTransactionDrawer({content:DrawerContent.SEND_TRANSACTION});const{priceResult:i,status:l}=useFetchCoinPrice();const{fiatCurrency:c}=useCurrencyStore();const d=useRedirection(walletRoutePaths.send);const{inMemoryWallet:u,walletUI:{cardanoCoin:m,appMode:v,areBalancesVisible:p,getHiddenBalancePlaceholder:g},setAssetDetails:w,assetDetails:S,activityDetail:y,resetActivityState:f,blockchainProvider:b,environmentName:E,currentChain:C}=useWalletStore();const T=v===APP_MODE_POPUP;const k=g();const{setPickedCoin:h}=useCoinStateSelector(eT);const{setTriggerPoint:R}=useAnalyticsSendFlowTriggerPoint();const A=useIsSmallerScreenWidthThan(BREAKPOINT_SMALL);const x=(null==C?void 0:C.networkMagic)===Wallet.Cardano.NetworkMagics.Mainnet;const[P,I]=useState(false);const[_,D]=useState();const N=useItemsPageSize(eC);const[B,O]=useState(N);const[j,V]=useState();useEffect(()=>{O(N)},[N]);const W=useObservable(u.assetInfo$);const{balance:M}=useBalances(null==i?void 0:null===(t=i.cardano)||void 0===t?void 0:t.price);const L=useObservable(u.balance.utxo.total$);const F=useObservable(u.balance.rewardAccounts.rewards$);const H=useMemo(()=>{return BigInt((null==L?void 0:L.coins)||0)+BigInt(F||0)},[F,L]);const $=!L||!i.cardano;const U=useMemo(()=>{var e;if(isNil(null==L?void 0:L.assets)||(null==L?void 0:null===(e=L.assets)||void 0===e?void 0:e.size)===0)return false;for(const[t]of L.assets){const s=null==W?void 0:W.get(t);if(!s||!isNFT(s))return true}return false},[W,null==L?void 0:L.assets]);const K=useCallback((e,t=true)=>{var s,a;const n=null==W?void 0:W.get(e);const o=null==i?void 0:null===(s=i.cardano)||void 0===s?void 0:s.price;const r=null==i?void 0:null===(a=i.tokens)||void 0===a?void 0:a.get(e);return n&&!isNFT(n)?assetTransformer({key:e,fiat:o,token:n,total:L,pricesInfo:r,fiatCurrency:c,areBalancesVisible:t||p,balancesPlaceholder:k}):void 0},[p,W,k,c,null==i?void 0:null===(s=i.cardano)||void 0===s?void 0:s.price,null==i?void 0:i.tokens,L]);const G=useCallback(e=>{return cardanoTransformer({total:{...L,coins:H},fiatPrice:null==i?void 0:i.cardano,cardanoCoin:m,fiatCode:null==c?void 0:c.code,areBalancesVisible:e||p,balancesPlaceholder:k})},[p,k,m,null==c?void 0:c.code,null==i?void 0:i.cardano,L,H]);const q=useMemo(()=>U&&_.length<ek,[U,_]);const Y=useMemo(()=>{return null==_?void 0:_.slice(0,B)},[_,B]);const onAssetRowClick=e=>{o.sendEventToPostHog(PostHogAction.TokenTokensTokenRowClick);const t=e===m.id?G(true):K(e,true);w(t);V(e)};const z=useMemo(()=>{var e,t;return getTotalWalletBalance(null==M?void 0:null===(e=M.total)||void 0===e?void 0:e.fiatBalance,i.tokens,null==L?void 0:L.assets,(null==i?void 0:null===(t=i.cardano)||void 0===t?void 0:t.price)||0,W)},[W,null==M?void 0:null===(a=M.total)||void 0===a?void 0:a.fiatBalance,null==i?void 0:null===(n=i.cardano)||void 0===n?void 0:n.price,i.tokens,null==L?void 0:L.assets]);const closeActivityDetailsDrawer=()=>I(false);const X=useCallback(()=>{f();closeActivityDetailsDrawer();w(_.find(e=>e.id===j))},[j,_,f,w]);const Q=useCallback(e=>{if(!e&&y)f()},[y,f]);const onSendAssetClick=e=>{const t={trigger_point:SendFlowTriggerPoints.TOKENS};h(eT,{prev:m.id,next:e});R(SendFlowTriggerPoints.TOKENS);o.sendEventToPostHog(PostHogAction.SendClick,t);if(T)d({params:{id:e}});else{w();r()}};useEffect(()=>{if(y)w();if(!S&&y)I(true)},[S,y,w]);useEffect(()=>{const e=[];if(U){for(const[t,s]of L.assets){if(s<=0)return;const a=K(t,false);if(a)e.push(a)}}e.sort(sortAssets);const n=H>BigInt(0)?[G(false)]:[];D([...n,...e])},[W,L,m,i,c,U,p,K,G,H,E,k]);useEffect(()=>{closeActivityDetailsDrawer()},[b]);var J;const Z=React.createElement(AssetsPortfolio,{appMode:v,assetList:Y,portfolioTotalBalance:z,isBalanceLoading:q,isLoadingFirstTime:$,onRowClick:onAssetRowClick,onTableScroll:()=>O(e=>e+N),totalAssets:null!==(J=null==_?void 0:_.length)&&void 0!==J?J:0});const ee=React.createElement(React.Fragment,null,React.createElement(AssetActivityDetails,{afterOpenChange:Q,appMode:v,isVisible:P,onClose:closeActivityDetailsDrawer,onBack:X}),React.createElement(AssetDetailsDrawer,{fiatCode:c.code,openSendDrawer:onSendAssetClick,popupView:T,isBalanceDataFetchedCorrectly:"fetched"===l}));return T?React.createElement(React.Fragment,null,React.createElement(ContentLayout,{hasCredit:(null==_?void 0:_.length)>0},React.createElement(MidnightEventBanner,null),Z),ee):React.createElement(Layout,null,React.createElement(SectionLayout,{hasCredit:(null==_?void 0:_.length)>0,sidePanelContent:React.createElement(Flex,{flexDirection:"column",gap:"$28"},USE_FOOR_TOPUP&&x&&!A&&React.createElement(TopUpWalletCard,null),React.createElement(AssetEducationalList,null))},React.createElement(MidnightEventBanner,null),e,Z,ee))};const AssetsView=()=>React.createElement(Assets,null)},"./src/views/browser-view/features/assets/index.ts":(e,t,s)=>{var a=s("./src/views/browser-view/features/assets/components/index.ts")},"./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.module.scss":(e,t,s)=>{var a=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var n=s.n(a);var o=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var p=s.n(v);var g=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.module.scss");var w={};w.styleTagTransform=p();w.setAttributes=d();w.insert=l().bind(null,"head");w.domAPI=r();w.insertStyleElement=m();var S=n()(g["default"],w);var y=g["default"]&&g["default"].locals?g["default"].locals:void 0},"./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.tsx":(e,t,s)=>{s.d(t,{sectionsWithArrowIcon:()=>a.sectionsWithArrowIcon,useHandleClose:()=>a.useHandleClose});var a=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/HeaderView.tsx")},"./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/HeaderView.tsx":(e,t,s)=>{s.d(t,{sectionsWithArrowIcon:()=>h,useHandleClose:()=>useHandleClose});var a=s("../../node_modules/react/index.js");var n=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.module.scss");var o=s("./src/lib/scripts/types/index.ts");var r=s("../../packages/common/dist/index.esm.js");var i=s("./src/views/browser-view/features/send-transaction/types.ts");var l=s("./src/views/browser-view/features/send-transaction/store/index.ts");var c=s("./src/views/browser-view/features/send-transaction/index.ts");var d=s("./src/views/browser-view/stores/index.ts");var u=s("../../node_modules/react-i18next/dist/es/index.js");var m=s("./src/hooks/index.ts");var v=s("./src/routes/index.ts");var p=s("./src/providers/BackgroundServiceAPI/index.ts");var g=s("./src/providers/index.ts");var w=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var S=s("./src/stores/index.ts");var y=s("./src/utils/constants.ts");var f=s("./src/components/AssetSelectionButton/SelectTokensButton.tsx");var b=s("./src/components/AssetSelectionButton/AssetCounter.tsx");var E=s("./src/views/browser-view/features/send-transaction/helpers.ts");var C=s("./src/features/address-book/store/index.tsx");var T=s("./src/views/browser-view/components/Drawer/index.ts");var k=s("../../packages/core/dist/index.esm.js");const useHandleClose=()=>{const{walletUI:{appMode:e},isInMemoryWallet:t}=(0,S.useWalletStore)();const s=e===y.APP_MODE_POPUP;const[,n]=(0,l.useWarningModal)();const o=(0,l.useResetStore)();const r=(0,l.useResetUiStore)();const{hasOutput:c}=(0,l.useTransactionProps)();const[,u]=(0,d.useDrawer)();const{currentSection:p,resetSection:g}=(0,l.useSections)();const w=(0,m.useRedirection)(v.walletRoutePaths.activity);const f=(0,m.useRedirection)(v.walletRoutePaths.assets);const b=(0,a.useCallback)(()=>{o();r();g()},[o,r,g]);const E=(0,a.useCallback)(()=>{u();b()},[b,u]);const C=(0,a.useCallback)(()=>{b();f()},[b,f]);const T=(0,a.useCallback)(()=>{if(s){b();w()}else{E();w()}if(!t)window.location.reload()},[E,t,s,w,b]);const k=(0,a.useCallback)(()=>{if(c)n(true);else s?C():E()},[c,n,s,C,E]);const h=(0,a.useCallback)(()=>{if(p.currentSection===i.Sections.SUCCESS_TX){s?C():E();if(!t)window.location.reload()}else{k()}},[p.currentSection,s,C,E,t,k]);return{onClose:h,onCloseSubmitedTransaction:T}};const h=[i.Sections.SUMMARY,i.Sections.ADDRESS_LIST,i.Sections.ADDRESS_FORM,i.Sections.CONFIRMATION,i.Sections.ASSET_PICKER];const R=new Set([i.Sections.ASSET_PICKER,i.Sections.ADDRESS_LIST]);const A="output1";const HeaderNavigation=({isPopupView:e,flow:t=DrawerContent.SEND_TRANSACTION})=>{const{t:s}=useTranslation();const{onClose:a}=useHandleClose();const{currentSection:n,setPrevSection:o}=useSections();const{password:r,clearSecrets:i}=useSecrets();const l=useBackgroundServiceAPIContext();const{setSubmitingTxState:c}=useSubmitingState();const d=useAnalyticsContext();const[u,m]=useMultipleSelection();const{selectedTokenList:v,resetTokenList:p}=useSelectedTokenList();const{triggerPoint:g}=useAnalyticsSendFlowTriggerPoint();const{isSharedWallet:w}=useWalletStore();const S=e?[...h,Sections.FORM].includes(n.currentSection):h.includes(n.currentSection);const y=e&&n.currentSection===Sections.FORM;const f=e&&n.currentSection===Sections.ASSET_PICKER;const b=!R.has(n.currentSection);const onArrowIconClick=()=>{const t=e&&[Sections.SUCCESS_TX,Sections.FORM,Sections.FAIL_TX,Sections.UNAUTHORIZED_TX].includes(n.currentSection);if(r){i();c({isPasswordValid:true})}if(n.currentSection===Sections.ASSET_PICKER)m(false);if(t)a();else o()};const onCrossIconClick=()=>{if(n.currentSection===Sections.SUCCESS_TX)d.sendEventToPostHog(PostHogAction[w?"SharedWalletsSendAllDoneXClick":"SendAllDoneXClick"],{trigger_point:g,[TX_CREATION_TYPE_KEY]:TxCreationType.Internal});else if(n.currentSection===Sections.FAIL_TX||n.currentSection===Sections.UNAUTHORIZED_TX)d.sendEventToPostHog(PostHogAction[w?"SharedWalletsSendSomethingWentWrongXClick":"SendSomethingWentWrongXClick"],{trigger_point:g,[TX_CREATION_TYPE_KEY]:TxCreationType.Internal});setTimeout(()=>{a()},300)};const{uiOutputs:E}=useCoinStateSelector(A);const{address:C}=useAddressState(A);const openTabExtensionSendFlow=()=>{saveTemporaryTxDataInStorage({tempAddress:C,tempOutputs:E,tempSource:"popup"});l.handleOpenBrowser({section:BrowserViewSections.SEND_ADVANCED})};const T=s(v.length>0?"multipleSelection.clear":"multipleSelection.cancel");const k=v.length>0?p:()=>m(!u);const x={[DrawerContent.SEND_TRANSACTION]:s("browserView.transaction.send.drawer.send"),[DrawerContent.CO_SIGN_TRANSACTION]:s("browserView.transaction.send.drawer.coSignTransaction")};return React.createElement(DrawerNavigation,{title:e?void 0:React.createElement("div",null,x[t]),onArrowIconClick:S?onArrowIconClick:void 0,rightActions:y?React.createElement(Button,{className:styles.customSizeBtn,color:"secondary",variant:"outlined",onClick:openTabExtensionSendFlow,"data-testid":"add-bundle-button"},s("browserView.transaction.send.drawer.addBundle")):f?React.createElement(SelectTokenButton,{testId:u?v.length>0?"clear-button":"cancel-button":"select-multiple-button",label:u?T:s("multipleSelection.selectMultiple"),onClick:k,btnStyle:u?{width:"112px",minWidth:"112px"}:{width:"152px",minWidth:"152px"}}):b?React.createElement(NavigationButton,{icon:"cross",onClick:onCrossIconClick}):void 0})};const useGetHeaderText=()=>{const{addressToEdit:e}=useAddressBookStore();const{isSharedWallet:t}=useWalletStore();return{[Sections.FORM]:{title:"browserView.transaction.send.drawer.newTransaction"},[Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON]:{},[Sections.SUMMARY]:t?{}:{title:"browserView.transaction.send.drawer.transactionSummary",subtitle:"browserView.transaction.send.drawer.breakdownOfYourTransactionCost"},[Sections.CONFIRMATION]:{title:"browserView.transaction.send.confirmationTitle",subtitle:"browserView.transaction.send.signTransactionWithPassword"},[Sections.SUCCESS_TX]:{},[Sections.FAIL_TX]:{},[Sections.UNAUTHORIZED_TX]:{},[Sections.ADDRESS_LIST]:{title:"browserView.transaction.send.drawer.addressBook"},[Sections.ADDRESS_FORM]:{title:"browserView.transaction.send.drawer.addressForm"},[Sections.ASSET_PICKER]:{title:"core.coinInputSelection.assetSelection"},[Sections.ADDRESS_CHANGE]:{title:"addressBook.reviewModal.title",name:e.name}}};const HeaderTitle=({popup:e,titleSlot:t})=>{var s,a;const{t:n}=useTranslation();const{currentSection:o}=useSections();const[r,i]=useMultipleSelection();const{selectedTokenList:l,resetTokenList:c}=useSelectedTokenList();const d=useGetHeaderText();const u=![Sections.FORM,Sections.FAIL_TX,Sections.UNAUTHORIZED_TX].includes(o.currentSection);const m=u&&(null===(s=d[o.currentSection])||void 0===s?void 0:s.title)?n(d[o.currentSection].title,{name:d[o.currentSection].name}):void 0;const v=(null===(a=d[o.currentSection])||void 0===a?void 0:a.subtitle)?n(d[o.currentSection].subtitle):void 0;const p=n(l.length>0?"multipleSelection.clear":"multipleSelection.cancel");const g=l.length>0?c:()=>i(!r);const w=e?l.length>0?React.createElement(AssetsCounter,{count:l.length}):null:React.createElement(SelectTokenButton,{testId:r?l.length>0?"clear-button":"cancel-button":"select-multiple-button",count:l.length>0?l.length:void 0,label:r?p:n("multipleSelection.selectMultiple"),onClick:g,btnStyle:r?{width:"112px"}:{width:"152px"}});return u&&React.createElement(DrawerHeader,{popupView:e,title:React.createElement("div",{className:styles.header},React.createElement("div",{className:styles.title},m),t,o.currentSection===Sections.ASSET_PICKER&&w),subtitle:v})}},"./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/index.ts":(e,t,s)=>{s.d(t,{Footer:()=>n.Footer,sectionsWithArrowIcon:()=>a.sectionsWithArrowIcon,useHandleClose:()=>a.useHandleClose});var a=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.tsx");var n=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Footer.tsx")},"./src/views/browser-view/features/send-transaction/components/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/browser-view/features/send-transaction/store/index.ts");var o=s("./src/views/browser-view/features/send-transaction/types.ts");var r=s("./src/views/browser-view/features/send-transaction/components/SendTransactionSummary.tsx");var i=s("./src/views/browser-view/features/send-transaction/components/ConfirmPassword.tsx");var l=s("./src/views/browser-view/features/send-transaction/components/TransactionSuccess.tsx");var c=s("./src/views/browser-view/features/send-transaction/components/TransactionFail.tsx");var d=s("./src/views/browser-view/features/send-transaction/components/UnauthorizedTransaction.tsx");var u=s("./src/views/browser-view/features/send-transaction/components/AddressList.tsx");var m=s("./src/views/browser-view/features/send-transaction/components/AddressForm.tsx");var v=s("./src/views/browser-view/features/send-transaction/components/SendTransactionLayout.tsx");var p=s("./src/views/browser-view/features/send-transaction/components/Form/index.ts");var g=s("./src/views/browser-view/features/send-transaction/components/AssetPicker.tsx");var w=s("../../packages/common/dist/index.esm.js");var S=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/index.ts");var y=s("./src/features/address-book/components/AddressChangeDetail.tsx");var f=s("./src/features/address-book/store/index.tsx");var b=s("./src/features/address-book/context/index.ts");var E=s("./src/hooks/index.ts");var C=s("./src/stores/index.ts");var T=s("./src/views/browser-view/features/send-transaction/components/ImportSharedWalletTransaction.tsx");const k=(0,b.withAddressBookContext)(({flow:e,isPopupView:t,scrollableTargetId:s,scrollableContainerRef:k})=>{var h,R,A,x;const{currentSection:P,setPrevSection:I}=(0,n.useSections)();const{onClose:_}=(0,S.useHandleClose)();const{list:D}=(0,b.useAddressBookContext)();const{addressToEdit:{name:N,address:B}}=(0,f.useAddressBookStore)();const O=(0,E.useHandleResolver)();const{environmentName:j}=(0,C.useWalletStore)();const{getCustomSubmitApiForNetwork:V}=(0,E.useCustomSubmitApi)();const W=(0,E.useUpdateAddressStatus)(D,O);(0,w.useKeyboardShortcut)(["Escape"],()=>{if(S.sectionsWithArrowIcon.includes(P.currentSection))I();else _()});(0,a.useEffect)(()=>{if(k&&k.current)k.current.scrollTop=0},[P.currentSection,k]);var M,L;const F={..."send"===e&&{[o.Sections.FORM]:a.createElement(p.TransactionForm,{isPopupView:t})},..."co-sign"===e&&{[o.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON]:a.createElement(T.ImportSharedWalletTransaction,null)},[o.Sections.SUMMARY]:a.createElement(r.SendTransactionSummary,{isPopupView:t}),[o.Sections.CONFIRMATION]:a.createElement(i.ConfirmPassword,null),[o.Sections.SUCCESS_TX]:a.createElement(l.TransactionSuccess,null),[o.Sections.FAIL_TX]:a.createElement(c.TransactionFail,{showCustomApiBanner:V(j).status}),[o.Sections.UNAUTHORIZED_TX]:a.createElement(d.UnauthorizedTransaction,null),[o.Sections.ADDRESS_LIST]:a.createElement(u.AddressList,{isPopupView:t,scrollableTargetId:s}),[o.Sections.ADDRESS_FORM]:a.createElement(m.AddressForm,{isPopupView:t}),[o.Sections.ASSET_PICKER]:a.createElement(g.AssetPicker,{isPopupView:t}),[o.Sections.ADDRESS_CHANGE]:a.createElement(y.AddressChangeDetail,{name:N,isPopupView:t,expectedAddress:null!==(M=null===(h=W[B])||void 0===h?void 0:null===(R=h.error)||void 0===R?void 0:R.expectedAddress)&&void 0!==M?M:"",actualAddress:null!==(L=null===(A=W[B])||void 0===A?void 0:null===(x=A.error)||void 0===x?void 0:x.actualAddress)&&void 0!==L?L:""})};return a.createElement(v.SendTransactionLayout,{isPopupView:t},F[P.currentSection])})},"./src/views/browser-view/features/send-transaction/helpers.ts":(e,t,s)=>{s.d(t,{calculateSpentBalance:()=>calculateSpentBalance,clearTemporaryTxDataFromStorage:()=>clearTemporaryTxDataFromStorage,formatRow:()=>formatRow,getNextInsufficientBalanceInputs:()=>getNextInsufficientBalanceInputs,getOutputValues:()=>getOutputValues,getReachedMaxAmountList:()=>getReachedMaxAmountList,getTemporaryTxDataFromStorage:()=>getTemporaryTxDataFromStorage,getTokensProperty:()=>getTokensProperty,hasReachedMaxAmountAda:()=>hasReachedMaxAmountAda});var a=s("../../packages/cardano/dist/index.esm.js");var n=s("./src/views/browser-view/features/send-transaction/types.ts");var o=s("../../node_modules/bignumber.js/bignumber.js");var r=s.n(o);var i=s("../../node_modules/lodash/isNil.js");var l=s.n(i);var c=s("./src/utils/is-nft.ts");var d=s("../../node_modules/lodash/flatMapDeep.js");var u=s.n(d);var m=s("./src/api/transformers.ts");var v=s("../../node_modules/lodash/isUndefined.js");var p=s.n(v);var g=s("./src/utils/assets-transformers.ts");const calculateSpentBalance=e=>{let t={};const s=Object.values(e);for(const{assets:a}of s){for(const n of a){const o=t[n.id]||"0";const i=new(r())(o.toString()).plus((null==n?void 0:n.value)||"0");t={...t,[n.id]:i.isNaN()?"0":i.toString()}}}return t};const getOutputValues=(e,t)=>{const s=new Map;let n="0";for(const o of e)if(t.id===o.id)n=a.Wallet.util.adaToLovelacesString(o.value||"0");else{try{if(o.value&&Number(o.value)&&!Number.isNaN(Number(o.value)))s.set(a.Wallet.Cardano.AssetId(o.id),o.value)}catch{}}return{coins:n,assets:0===s.size?void 0:s}};const getNextInsufficientBalanceInputs=(e,t,s)=>a=>{const n=t.has(s);const o=a.includes(e);if(n&&!o){return[...a,e]}if(!n&&o){return a.filter(e=>e.split(".")[1]!==s)}return a};const hasReachedMaxAmountAda=({tokensUsed:e,balance:t,exceed:s=false,cardanoCoin:n,availableRewards:o=BigInt(0)})=>!!e[n.id]&&!!t&&new(r())(e[n.id])[s?"gt":"gte"](a.Wallet.util.lovelacesToAdaString((BigInt(t)+BigInt(o)).toString()));const getReachedMaxAmountList=({assets:e=new Map,tokensUsed:t,balance:s,exceed:n=false,cardanoCoin:o,availableRewards:r=BigInt(0)})=>{var i;const l=hasReachedMaxAmountAda({tokensUsed:t,balance:null==s?void 0:s.coins,cardanoCoin:o,availableRewards:r});const c=(null==s?void 0:null===(i=s.assets)||void 0===i?void 0:i.size)?[...s.assets].filter(([s,o])=>{if(t[s.toString()]){const r=a.Wallet.util.assetBalanceToBigInt(t[s.toString()],e.get(s));return n?r>o:r>=o}return false}).map(([e])=>e):[];return l?[...c,o.id]:c};const saveTemporaryTxDataInStorage=({tempAddress:e,tempOutputs:t,tempSource:s})=>{if(!isNil(e))localStorage.setItem(TemporaryTransactionDataKeys.TEMP_ADDRESS,e);if(!isNil(t))localStorage.setItem(TemporaryTransactionDataKeys.TEMP_OUTPUTS,JSON.stringify(t));if(!isNil(s))localStorage.setItem(TemporaryTransactionDataKeys.TEMP_SOURCE,s)};const getTemporaryTxDataFromStorage=()=>{const e=localStorage.getItem(n.TemporaryTransactionDataKeys.TEMP_ADDRESS);const t=localStorage.getItem(n.TemporaryTransactionDataKeys.TEMP_OUTPUTS);const s=localStorage.getItem(n.TemporaryTransactionDataKeys.TEMP_SOURCE);return{tempAddress:e,tempSource:s,tempOutputs:l()(t)?t:JSON.parse(t)}};const clearTemporaryTxDataFromStorage=e=>{if(!e||e.includes(n.TemporaryTransactionDataKeys.TEMP_ADDRESS))localStorage.removeItem(n.TemporaryTransactionDataKeys.TEMP_ADDRESS);if(!e||e.includes(n.TemporaryTransactionDataKeys.TEMP_OUTPUTS))localStorage.removeItem(n.TemporaryTransactionDataKeys.TEMP_OUTPUTS);if(!e||e.includes(n.TemporaryTransactionDataKeys.TEMP_SOURCE))localStorage.removeItem(n.TemporaryTransactionDataKeys.TEMP_SOURCE)};const getCardanoCoinAnalyticsProperties=(e,t)=>({id:e.id,name:e.name,ticker:e.symbol,amount:t});const getAssetAnalyticsProperties=(e,t,s)=>{var n,o,r;const i=e.get(a.Wallet.Cardano.AssetId(t));const l=(0,c.isNFT)(i)?null==i?void 0:null===(n=i.nftMetadata)||void 0===n?void 0:n.name:null==i?void 0:null===(o=i.tokenMetadata)||void 0===o?void 0:o.name;const d=null==i?void 0:null===(r=i.tokenMetadata)||void 0===r?void 0:r.ticker;return{id:null==i?void 0:i.fingerprint,amount:s,name:l,ticker:d}};const getTokensProperty=(e,t,s)=>{const a=new Map;const n=Object.values(e).map(({assets:e})=>e);const o=u()(n);for(const{id:i,value:l}of o){const c=a.get(i);if(c){const d=new(r())(c.amount).plus(l).toString();a.set(i,{...c,amount:d})}else{const m=i===s.id?getCardanoCoinAnalyticsProperties(s,l):getAssetAnalyticsProperties(t,i,l);a.set(i,m)}}return[...a.values()]};const formatRow=({output:e,assetInfo:t,cardanoCoin:s,fiatCurrency:n,prices:o})=>{var r;const i=(0,m.walletBalanceTransformer)(e.value.coins.toString(),null==o?void 0:null===(r=o.cardano)||void 0===r?void 0:r.price);const l={assetAmount:`${i.coinBalance} ${s.symbol}`,fiatAmount:`${i.fiatBalance} ${null==n?void 0:n.code}`};if(p()(e.value.assets))return[l];const c=[...e.value.assets.entries()];const d=[];for(const[u,v]of c){const w=null==t?void 0:t.get(u);if(w){var S,y,f,b,E,C;var T,k;const h=null!==(k=null!==(T=null===(S=w.nftMetadata)||void 0===S?void 0:S.name)&&void 0!==T?T:null===(y=w.tokenMetadata)||void 0===y?void 0:y.ticker)&&void 0!==k?k:null===(f=w.tokenMetadata)||void 0===f?void 0:f.name;const R=a.Wallet.util.calculateAssetBalance(v,w);const A=null===(E=null==o?void 0:null===(b=o.tokens)||void 0===b?void 0:b.get(u))||void 0===E?void 0:E.priceInAda;const x=void 0!==w.tokenMetadata&&A?`${(0,g.parseFiat)(Number((0,g.getTokenAmountInFiat)(R,A,null==o?void 0:null===(C=o.cardano)||void 0===C?void 0:C.price)))} ${null==n?void 0:n.code}`:"-";d.push({assetAmount:`${R} ${null!=h?h:w.assetId}`,fiatAmount:x})}}return[l,...d]}},"./src/views/browser-view/features/send-transaction/index.ts":(e,t,s)=>{s.d(t,{Sections:()=>o.Sections,SendFlowTriggerPoints:()=>o.SendFlowTriggerPoints,useAnalyticsSendFlowTriggerPoint:()=>n.useAnalyticsSendFlowTriggerPoint,useBuiltTxState:()=>n.useBuiltTxState,useMaxAdaStatus:()=>n.useMaxAdaStatus,useMetadata:()=>n.useMetadata,useOutputInitialState:()=>n.useOutputInitialState,useOutputs:()=>n.useOutputs,useSections:()=>n.useSections,useTransactionProps:()=>n.useTransactionProps});var a=s("./src/views/browser-view/features/send-transaction/components/index.ts");var n=s("./src/views/browser-view/features/send-transaction/store/index.ts");var o=s("./src/views/browser-view/features/send-transaction/types.ts");var r=s("./src/views/browser-view/features/send-transaction/useOpenTransactionDrawer.tsx")},"./src/views/browser-view/features/send-transaction/store/index.ts":(e,t,s)=>{s.d(t,{useAddressState:()=>a.useAddressState,useAnalyticsSendFlowTriggerPoint:()=>a.useAnalyticsSendFlowTriggerPoint,useAssetOverlaySection:()=>useAssetOverlaySection,useBuiltTxState:()=>a.useBuiltTxState,useCoinStateSelector:()=>a.useCoinStateSelector,useCurrentCoinIdToChange:()=>a.useCurrentCoinIdToChange,useCurrentRow:()=>a.useCurrentRow,useLastFocusedInput:()=>a.useLastFocusedInput,useMaxAdaStatus:()=>a.useMaxAdaStatus,useMetadata:()=>a.useMetadata,useMultipleSelection:()=>a.useMultipleSelection,useOutputInitialState:()=>a.useOutputInitialState,useOutputs:()=>a.useOutputs,useResetStore:()=>a.useResetStore,useResetUiStore:()=>useResetUiStore,useSections:()=>useSections,useSelectedTokenList:()=>a.useSelectedTokenList,useSpentBalances:()=>a.useSpentBalances,useSubmitingState:()=>a.useSubmitingState,useTransactionProps:()=>a.useTransactionProps,useWarningModal:()=>useWarningModal});var a=s("./src/views/browser-view/features/send-transaction/store/store.ts");var n=s("../../node_modules/zustand/esm/index.js");var o=s("./src/views/browser-view/features/send-transaction/types.ts");var r=s("./src/views/browser-view/stores/index.ts");var i=s("./src/views/browser-view/features/send-transaction/constants.ts");var l=s("./src/views/browser-view/components/Drawer/index.ts");const c={isWarningModalVisible:false,formPickedOption:o.FormOptions.SIMPLE};const d=(0,n["default"])(e=>({...c,setWarnigModalVisibility:t=>e({isWarningModalVisible:t}),resetUiStates:()=>e(e=>({...e,...c})),setFormType:t=>e({formPickedOption:t}),setOverlaySection:t=>e({overlaySection:t})}));const u=(0,r.createSectionsStore)({section:i.sectionsConfig[o.Sections.FORM],config:i.sectionsConfig});const m=(0,r.createSectionsStore)({section:i.sharedWalletCoSignSectionsConfig[o.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON],config:i.sharedWalletCoSignSectionsConfig});const makeUseSections=e=>()=>e(({currentSection:e,setSection:t,setPrevSection:s,resetSection:a})=>({currentSection:e,setSection:t,setPrevSection:s,resetSection:a}));const v=makeUseSections(u);const p=makeUseSections(m);const getTransactionSectionsHook=e=>{const t={[l.DrawerContent.SEND_TRANSACTION]:v,[l.DrawerContent.CO_SIGN_TRANSACTION]:p};return t[e===l.DrawerContent.SEND_TRANSACTION||e===l.DrawerContent.CO_SIGN_TRANSACTION?e:l.DrawerContent.SEND_TRANSACTION]};const useSections=()=>{const[e]=(0,r.useDrawer)();const t=getTransactionSectionsHook(null==e?void 0:e.content);return t()};const useWarningModal=()=>d(e=>[e.isWarningModalVisible,e.setWarnigModalVisibility]);const useResetUiStore=()=>d(e=>e.resetUiStates);const useFormPickedOption=()=>d(e=>[e.formPickedOption,e.setFormType]);const useAssetOverlaySection=()=>{return d(e=>{return[null==e?void 0:e.overlaySection,e.setOverlaySection]})}},"./src/views/browser-view/features/send-transaction/useOpenTransactionDrawer.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/browser-view/components/Drawer/DrawerUIContent.tsx");var o=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/index.ts");var r=s("./src/views/browser-view/features/send-transaction/store/index.ts");var i=s("./src/views/browser-view/features/send-transaction/types.ts");var l=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/HeaderView.tsx");var c=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var y=s.n(S);var f=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var b=s.n(f);var E=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/send-transaction/useOpenTransactionDrawer.module.scss");var C={};C.styleTagTransform=b();C.setAttributes=w();C.insert=p().bind(null,"head");C.domAPI=m();C.insertStyleElement=y();var T=d()(E["default"],C);const k=E["default"]&&E["default"].locals?E["default"].locals:void 0;var h=s("./src/views/browser-view/stores/index.ts");const R="output1";const useOpenTransactionDrawer=({content:e=DrawerContent.SEND_TRANSACTION,isPopupView:t=false,config:s}={})=>{const[,a]=useDrawer();const{onClose:n}=useHandleClose();const[o]=useCurrentRow();const{setAddressValue:r}=useAddressState(o||R);const i=getTransactionSectionsHook(e);const{currentSection:{currentSection:l},setSection:c}=i();const[d]=useMultipleSelection();const u=d&&l===Sections.ASSET_PICKER;const m=![Sections.ADDRESS_LIST,Sections.ADDRESS_FORM,Sections.ASSET_PICKER].includes(l)||u;return useCallback(()=>{a({content:e,wrapperClassName:styles.drawer,onClose:n,renderHeader:()=>React.createElement(HeaderNavigation,{isPopupView:t,flow:e}),renderTitle:()=>React.createElement(HeaderTitle,{popup:t}),...m?{renderFooter:()=>React.createElement(Footer,{key:l,isPopupView:t,onHandleChangeConfirm:e=>{"DELETE"===e&&r(o,"");c({currentSection:Sections.FORM,nextSection:Sections.SUMMARY})}})}:{},...s})},[s,e,l,t,n,o,r,a,c,m])}},"./src/views/browser-view/features/settings/components/SettingsRemoveWallet.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("./src/views/browser-view/features/settings/components/index.tsx");var o=s("../../node_modules/react-i18next/dist/es/index.js");var r=s("../../node_modules/antd/es/typography/index.js");var i=s("../../packages/common/dist/index.esm.js");var l=s("./src/views/browser-view/components/WarningModal/index.ts");var c=s("./src/views/browser-view/features/settings/components/SettingsLayout.module.scss");var d=s("./src/hooks/index.ts");var u=s("./src/stores/index.ts");var m=s("./src/providers/BackgroundServiceAPI/index.ts");var v=s("./src/lib/scripts/types/index.ts");var p=s("./src/providers/index.ts");var g=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var w=s("../../node_modules/classnames/index.js");var S=s.n(w);var y=s("./src/lib/wallet-api-ui.ts");const{Title:f,Text:b}=r["default"];const SettingsRemoveWallet=({popupView:e})=>{const{t}=useTranslation();const[s,a]=useState(false);const{deleteWallet:n,getActiveWalletName:o,walletManager:r}=useWalletManager();const{setDeletingWallet:i,isSharedWallet:l}=useWalletStore();const c=useBackgroundServiceAPIContext();const[d,u]=useState("");const m=useAnalyticsContext();useEffect(()=>{o().then(e=>{u(e)})},[o]);const v=useObservable(r.activeWalletId$);const p=useObservable(walletRepository.wallets$);const g=!l&&(null==p?void 0:p.some(e=>{return e.type===WalletType.Script&&e.ownSigners[0].walletId===(null==v?void 0:v.walletId)}));const toggleRemoveWalletAlert=()=>{if(g)return;a(!s);m.sendEventToPostHog(s?PostHogAction.SettingsHoldUpBackClick:PostHogAction.SettingsRemoveWalletClick)};const removeWallet=async()=>{i(true);await m.sendEventToPostHog(PostHogAction.SettingsHoldUpRemoveWalletClick,{$set:{wallet_accounts_quantity:await getWalletAccountsQtyString(walletRepository)}});const t=await n();i(false);if(t)return;if(e)await c.handleOpenBrowser({section:BrowserViewSections.HOME});location.reload()};return React.createElement(React.Fragment,null,React.createElement(WarningModal,{header:t("browserView.settings.wallet.general.removeWalletAlert.title"),content:React.createElement("span",{className:styles.removeWalletContent},t("browserView.settings.wallet.general.removeWalletAlert.content")),visible:s,onCancel:toggleRemoveWalletAlert,onConfirm:removeWallet,cancelLabel:t("browserView.settings.wallet.general.removeWalletAlert.cancel"),confirmLabel:t("browserView.settings.wallet.general.removeAction"),confirmCustomClassName:styles.settingsConfirmButton,isPopupView:e}),React.createElement(SettingsCard,null,React.createElement(f,{level:5,className:styles.heading5,"data-testid":"remove-wallet-heading"},t("browserView.settings.wallet.general.removeWallet")),React.createElement("div",{className:styles.removeDescriptionRow},React.createElement(b,{style:{width:e?"100%":"50%"},className:styles.modalDescription,"data-testid":"remove-wallet-description"},t(g?"browserView.settings.wallet.general.removeSharedWalletDescription":"browserView.settings.wallet.general.removeWalletDescription")),React.createElement(Button,{size:"medium",className:cn(styles.settingsButton,styles.settingsRemoveWalletButton),onClick:toggleRemoveWalletAlert,block:e,"data-testid":"remove-wallet-button",disabled:g},t("browserView.settings.wallet.general.removeAction",{walletName:d})))))}},"./src/views/browser-view/features/settings/components/index.tsx":(e,t,s)=>{s.d(t,{NetworkChoice:()=>D.NetworkChoice});var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-i18next/dist/es/index.js");var o=s("./src/views/browser-view/features/settings/components/SettingsLayout.module.scss");var r=s("../../node_modules/antd/es/typography/index.js");var i=s("./src/stores/index.ts");var l=s("../../packages/common/dist/index.esm.js");var c=s("./src/views/browser-view/components/SocialNetworks/SocialNetworkIcon.tsx");var d=s("./src/multichain/index.ts");var u=s("./src/utils/get-network-name.ts");function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const{Title:m}=r["default"];const v=8;const p=4;const g=[{name:c.SocialNetwork.WEBSITE,href:"https://www.lace.io"},{name:c.SocialNetwork.TWITTER,href:"https://twitter.com/lace_io"},{name:c.SocialNetwork.YOUTUBE,href:"https://www.youtube.com/c/Laceio"},{name:c.SocialNetwork.DISCORD,href:"https://discord.gg/lace-1073034511664824360"},{name:c.SocialNetwork.GITHUB,href:"https://github.com/input-output-hk"}];const SettingsAbout_SettingsAbout=({...e})=>{const{t}=useTranslation();const s=addEllipsis("2d3a946629324f34680956a4591123c82f731963\n",v,p);const{environmentName:a}=useWalletStore();const{blockchain:n}=useCurrentBlockchain();const o=`${e["data-testid"]||""}`;return React.createElement("div",{className:styles.listContainer,"data-testid":o},React.createElement(m,{className:styles.title,level:2,"data-testid":"settings-about-title"},t("browserView.settings.wallet.about.content.title",{name:"Lace"})),React.createElement("div",{className:styles.aboutGrid},React.createElement("div",{className:styles.aboutGridLabel,"data-testid":"about-network-label"},t("browserView.settings.wallet.about.content.network")),React.createElement("div",{className:styles.aboutGridValue,"data-testid":"about-network-value"},getNetworkName(n,a)),React.createElement("div",{className:styles.aboutGridLabel,"data-testid":"about-version-label"},t("browserView.settings.wallet.about.content.currentVersion")),React.createElement("div",{className:styles.aboutGridValue,"data-testid":"about-version-value"},"1.22.0"),s&&React.createElement(React.Fragment,null,React.createElement("div",{className:styles.aboutGridLabel,"data-testid":"about-commit-label"},t("browserView.settings.wallet.about.content.commit")),React.createElement("div",{className:styles.aboutGridValue,"data-testid":"about-commit-value"},s))),React.createElement("div",{className:styles.social},g.map(e=>React.createElement(SocialNetworkIcon,_extends({key:e.name},e)))))};var w=s("./src/components/Layout/index.ts");var S=s("./src/views/browser-view/components/Layout/index.ts");var y=s("./src/views/browser-view/features/settings/components/SettingsRemoveWallet.tsx");var f=s("../../packages/core/dist/index.esm.js");var b=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var E=s("../../packages/core/src/ui/assets/images/midnight-launch-event-sidebar-banner.png");const SettingsLayout=({defaultPassphraseVisible:e,defaultMnemonic:t})=>{const{t:s}=useTranslation();const a=React.createElement("div",null,void 0,React.createElement(SettingsAbout,{"data-testid":"about-container"}));return React.createElement(Layout,null,React.createElement(SectionLayout,{sidePanelContent:a},React.createElement(PageTitle,{"data-testid":"settings-page-title"},s("browserView.settings.heading")),React.createElement(SettingsWallet,null),React.createElement(SettingsPreferences,null),React.createElement(SettingsSecurity,{defaultPassphraseVisible:e,defaultMnemonic:t}),React.createElement(SettingsHelp,null),React.createElement(SettingsLegal,null),React.createElement(SettingsRemoveWallet,null)))};const SettingsCard_SettingsCard=({children:e})=>React.createElement("div",{"data-testid":"settings-card",className:styles.settingsCard},e);function SettingsLink_extends(){SettingsLink_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return SettingsLink_extends.apply(this,arguments)}const SettingsLink_SettingsLink=({children:e,description:t,addon:s,...a})=>{const n=a["data-testid"]||"";return React.createElement("div",{className:styles.wrapper},React.createElement("div",{className:styles.separator}),React.createElement("div",SettingsLink_extends({className:styles.settingsLink},a),React.createElement("div",{className:styles.infoContainer},React.createElement("div",{className:styles.label,"data-testid":`${n}-title`},e),React.createElement("div",{className:styles.description,"data-testid":`${n}-description`},t||"Description here")),s&&React.createElement("div",{className:styles.value,"data-testid":`${n}-addon`},s)))};var C=s("./src/views/browser-view/features/dapp/components/DappList/DeleteDappModal.tsx");var T=s("./src/views/browser-view/features/dapp/components/DappList/DappListEmpty.tsx");var k=s("./src/views/browser-view/features/dapp/components/DappList/DappList.module.scss");var h=s("./src/assets/icons/delete-icon.component.svg");var R=s("./src/features/dapp/context/index.ts");var A=s("./src/views/browser-view/features/dapp/components/DappList/localDappService.ts");var x=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");const{Text:P}=r["default"];const I=3;const _=(0,R.withDappContext)(({onCancelClick:e,visible:t,popupView:s=false,sendAnalyticsEvent:o})=>{const{t:r}=(0,n.useTranslation)();const i=(0,R.useDappContext)();const[c,d]=(0,a.useState)();const u=(0,a.useMemo)(()=>{return(null==i?void 0:i.map(e=>({...e,url:e.url.replace(/^https?:\/\/(www.)?/,""),onDelete:()=>{d(e);o(x.PostHogAction.SettingsAuthorizedDappsTrashBinIconClick)}})))||[]},[i,o]);const m=(null==i?void 0:i.length)>0;const handleCancelDeleteDapp=()=>{d(null);o(x.PostHogAction.SettingsAuthorizedDappsHoldUpBackClick)};return a.createElement(l.Drawer,{width:s?"100%":void 0,className:k["default"].drawer,onClose:e,title:a.createElement(l.DrawerHeader,{popupView:s,title:r("dapp.list.title")}),navigation:a.createElement(l.DrawerNavigation,{title:r("browserView.settings.heading"),onCloseIconClick:s?void 0:e,onArrowIconClick:s?e:void 0}),visible:t,popupView:s},a.createElement(a.Fragment,null,a.createElement(P,{className:k["default"].description,"data-testid":"dapp-list-subtitle"},m?r("dapp.list.subTitle"):r("dapp.list.subTitleEmpty")),t&&(m?a.createElement("div",null,a.createElement("div",{className:k["default"].list},a.createElement(f.ConnectedDappList,{items:u,locale:{emptyText:true},total:i.length,popupView:s})),a.createElement(C.DeleteDappModal,{onCancel:handleCancelDeleteDapp,onConfirm:()=>{A.localDappService.removeAuthorizedDapp(c.url).then(e=>{if(e){l.toast.notify({text:r("dapp.list.removedSuccess"),duration:I,icon:h["default"]});o(x.PostHogAction.SettingsAuthorizedDappsHoldUpDisconnectDappClick)}else{throw new Error(r("dapp.list.removedFailure"))}}).catch(e=>{l.toast.notify({text:e,duration:I});throw new Error(e)}).finally(()=>{d(void 0)})},visible:!!c,isPopupView:s})):a.createElement("div",{className:k["default"].container},a.createElement(T.DappListEmpty,null)))))});var D=s("./src/views/browser-view/features/settings/components/NetworkChoice.tsx");const{Text:N}=r["default"];const NetworkChoiceDrawer_NetworkChoiceDrawer=({visible:e,onClose:t,popupView:s=false})=>{const{t:a}=useTranslation();return React.createElement(Drawer,{visible:e,onClose:t,title:React.createElement(DrawerHeader,{popupView:s,title:a("browserView.settings.wallet.network.title")}),navigation:React.createElement(DrawerNavigation,{title:a("browserView.settings.heading"),onCloseIconClick:s?void 0:t,onArrowIconClick:s?t:void 0}),popupView:s},React.createElement("div",{className:s?styles.popupContainer:void 0},React.createElement(N,{className:styles.drawerDescription},a("browserView.settings.wallet.network.drawerDescription")),React.createElement("div",{className:styles.radios},React.createElement(NetworkChoice,{section:"settings"}))))};const AboutDrawer_AboutDrawer=({visible:e,onClose:t,popupView:s})=>{const{t:a}=useTranslation();return React.createElement(Drawer,{visible:e,onClose:t,title:React.createElement(DrawerHeader,{popupView:s}),navigation:React.createElement(DrawerNavigation,{title:a("browserView.settings.heading"),onCloseIconClick:s?void 0:t,onArrowIconClick:s?t:void 0}),popupView:s},React.createElement(SettingsAbout,{"data-testid":"about-container"}))};var B=s("./src/config.ts");var O=s("./src/hooks/index.ts");var j=s("./src/lib/scripts/types/index.ts");var V=s("./src/providers/index.ts");var W=s("./src/routes/wallet-paths.ts");var M=s("../../node_modules/lodash/uniq.js");var L=s("./src/lib/communication/addresses-discoverer.ts");var F=s("./src/lib/scripts/background/storage.ts");var H=s("./src/assets/icons/switch.component.svg");var $=s("./src/assets/icons/address-error-icon.component.svg");var U=s("./src/assets/icons/play-icon.component.svg");var K=s("./src/assets/icons/pause-icon.component.svg");const{Text:G}=r["default"];const q="https://github.com/IntersectMBO/cardano-node/tree/master/cardano-submit-api";const{DEFAULT_SUBMIT_API:Y}=(0,B.config)();const CustomSubmitApiDrawer_CustomSubmitApiDrawer=({visible:e,onClose:t,popupView:s=false})=>{const{t:a}=useTranslation();const{enableCustomNode:n}=useWalletManager();const{environmentName:o}=useWalletStore();const r=useAnalyticsContext();const[i,l]=useState(Y);const[c,d]=useState(false);const{getCustomSubmitApiForNetwork:u}=useCustomSubmitApi();const m=u(o).status;useEffect(()=>{getBackgroundStorage().then(e=>{l(e.customSubmitTxUrl||Y)}).catch(logger.error)},[]);const handleCustomTxSubmitEndpoint=async e=>{if(e&&!isValidURL(i)){d(true);return}d(false);const t=e?i:void 0;try{await n(o,t);toast.notify({text:t?a("browserView.settings.wallet.customSubmitApi.usingCustomTxSubmitEndpoint"):a("browserView.settings.wallet.customSubmitApi.usingStandardTxSubmitEndpoint"),withProgressBar:true,icon:SwitchIcon});if(e)void r.sendEventToPostHog(PostHogAction.SettingsCustomSubmitApiEnableClick)}catch(s){logger.error("Error switching TxSubmit endpoint",s);toast.notify({text:a("general.errors.somethingWentWrong"),icon:ErrorIcon})}};return React.createElement(Drawer,{open:e,onClose:t,title:React.createElement(DrawerHeader,{popupView:s,title:a("browserView.settings.wallet.customSubmitApi.title")}),navigation:React.createElement(DrawerNavigation,{title:a("browserView.settings.heading"),onCloseIconClick:s?void 0:t,onArrowIconClick:s?t:void 0}),popupView:s},React.createElement("div",{className:s?styles.popupContainer:void 0},React.createElement(G,{className:styles.drawerDescription,"data-testid":"custom-submit-api-description"},a("browserView.settings.wallet.customSubmitApi.description")," ",React.createElement("a",{href:q,target:"_blank",rel:"noopener noreferrer","data-testid":"custom-submit-api-learn-more-url"},a("browserView.settings.wallet.customSubmitApi.descriptionLink"))),React.createElement(G,{className:styles.drawerText,"data-testid":"custom-submit-api-default-address"},a("browserView.settings.wallet.customSubmitApi.defaultAddress",{url:Y})),React.createElement("div",{className:styles.customApiContainer},React.createElement(TextBox,{label:a("browserView.settings.wallet.customSubmitApi.inputLabel"),w:"$fill",value:i,onChange:e=>l(e.target.value),disabled:m,"data-testid":"custom-submit-api-url"}),React.createElement(Button.Primary,{label:m?a("browserView.settings.wallet.customSubmitApi.disable"):a("browserView.settings.wallet.customSubmitApi.enable"),icon:m?React.createElement(PauseIcon,null):React.createElement(PlayIcon,null),onClick:()=>handleCustomTxSubmitEndpoint(!m),"data-testid":`custom-submit-button-${m?"disable":"enable"}`})),c&&React.createElement(G,{className:styles.validationError,"data-testid":"custom-submit-api-validation-error"},a("browserView.settings.wallet.customSubmitApi.validationError"))))};var z=s("./src/utils/constants.ts");const{Title:X}=r["default"];var Q;(function(e){e["about"]="about";e["collateral"]="collateral";e["dappList"]="dappList";e["general"]="general";e["networkChoice"]="networkChoice";e["customSubmitApi"]="customSubmitApi"})(Q||(Q={}));const SettingsWalletBase=({renderLocalNodeSlot:e,popupView:t=false})=>{var s;const{activeDrawer:a}=useSearchParams(["activeDrawer"]);const n=useRedirection(walletRoutePaths.settings);const o=useCallback(e=>n({search:{activeDrawer:e}}),[n]);const r=useRedirection(walletRoutePaths.settings);const{blockchain:i}=useCurrentBlockchain();const l="bitcoin"===i;const{t:c}=useTranslation();const{environmentName:d,inMemoryWallet:u,walletInfo:m,setHdDiscoveryStatus:v,isSharedWallet:p}=useWalletStore();const{AVAILABLE_CHAINS:g}=config();const w=useObservable(null==u?void 0:null===(s=u.balance)||void 0===s?void 0:s.utxo.unspendable$);const S=useMemo(()=>{return(null==w?void 0:w.coins)>=COLLATERAL_AMOUNT_LOVELACES},[null==w?void 0:w.coins]);const y=useBackgroundServiceAPIContext();const f=useAnalyticsContext();const{getCustomSubmitApiForNetwork:b}=useCustomSubmitApi();const E=g.length>1;const C=!p;useEffect(()=>{const openCollateralDrawer=async()=>{var e,t;const s=await y.getBackgroundStorage();if(!s)return;if((null===(e=s.message)||void 0===e?void 0:e.type)===MessageTypes.OPEN_COLLATERAL_SETTINGS&&(null===(t=s.message)||void 0===t?void 0:t.data.section)===BrowserViewSections.COLLATERAL_SETTINGS){await y.clearBackgroundStorage({keys:["message"]});o(Q.collateral)}};openCollateralDrawer()},[y,o]);const handleOpenDrawer=(e,t)=>{o(e);f.sendEventToPostHog(t)};const handleCloseDrawer=e=>{r();f.sendEventToPostHog(e)};const handleOpenNetworkChoiceDrawer=()=>handleOpenDrawer(Q.networkChoice,PostHogAction.SettingsNetworkClick);const handleOpenDappListDrawer=()=>handleOpenDrawer(Q.dappList,PostHogAction.SettingsAuthorizedDappsClick);const handleOpenCollateralDrawer=()=>handleOpenDrawer(Q.collateral,PostHogAction.SettingsCollateralClick);const handleOpenGeneralSettingsDrawer=()=>handleOpenDrawer(Q.general,PostHogAction.SettingsYourKeysClick);const handleOpenCustomSubmitApiDrawer=()=>handleOpenDrawer(Q.customSubmitApi,PostHogAction.SettingsCustomSubmitApiClick);const handleCloseNetworkChoiceDrawer=()=>handleCloseDrawer(PostHogAction.SettingsNetworkXClick);const handleCloseGeneralSettingsDrawer=()=>handleCloseDrawer(PostHogAction.SettingsYourKeysShowPublicKeyXClick);const handleCloseCustomSubmitApiDrawer=()=>handleCloseDrawer(PostHogAction.SettingsCustomSubmitApiXClick);const handleSendAnalyticsEvent=e=>f.sendEventToPostHog(e);const T=React.createElement(Button,{size:"medium",className:styles.settingsButton,onClick:async()=>{f.sendEventToPostHog(PostHogAction.SettingsWalletHdWalletSyncSyncClick);var e;const t=uniq((null!==(e=null==m?void 0:m.addresses)&&void 0!==e?e:[]).map(({index:e})=>e)).length;v(AddressesDiscoveryStatus.InProgress);try{const s=await u.discoverAddresses();const a=uniq(s.filter(isKeyHashAddress).map(({index:e})=>e)).length;const n=a>t;v(AddressesDiscoveryStatus.Idle);if(n)f.sendEventToPostHog(PostHogAction.SettingsWalletHdWalletSyncSyncNewAddresses)}catch{v(AddressesDiscoveryStatus.Error)}},block:t,"data-testid":"settings-wallet-wallet-sync-cta"},c("browserView.settings.wallet.walletSync.ctaLabel"));return React.createElement(React.Fragment,null,React.createElement(GeneralSettingsDrawer,{visible:a===Q.general,onClose:handleCloseGeneralSettingsDrawer,popupView:t,sendAnalyticsEvent:handleSendAnalyticsEvent}),React.createElement(CustomSubmitApiDrawer,{visible:a===Q.customSubmitApi,onClose:handleCloseCustomSubmitApiDrawer,popupView:t}),React.createElement(SettingsCard,null,React.createElement(X,{level:5,className:styles.heading5,"data-testid":"wallet-settings-heading"},c("browserView.settings.wallet.title")),void 0,t&&React.createElement(React.Fragment,null,React.createElement(AboutDrawer,{visible:a===Q.about,onClose:r,popupView:t}),React.createElement(SettingsLink,{onClick:()=>o(Q.about),description:c("browserView.settings.wallet.about.description"),"data-testid":"settings-wallet-about-link"},c("browserView.settings.wallet.about.title"))),E&&React.createElement(React.Fragment,null,React.createElement(NetworkChoiceDrawer,{visible:a===Q.networkChoice,onClose:handleCloseNetworkChoiceDrawer,popupView:t}),React.createElement(SettingsLink,{onClick:handleOpenNetworkChoiceDrawer,description:c("browserView.settings.wallet.network.description"),addon:getNetworkName(i,d),"data-testid":"settings-wallet-network-link"},c("browserView.settings.wallet.network.title"))),!l&&React.createElement(SettingsLink,{description:c("browserView.settings.wallet.customSubmitApi.settingsLinkDescription"),onClick:handleOpenCustomSubmitApiDrawer,addon:c(b(d).status?"browserView.settings.wallet.customSubmitApi.enabled":"browserView.settings.wallet.customSubmitApi.disabled"),"data-testid":"settings-wallet-custom-submit-api-link"},c("browserView.settings.wallet.customSubmitApi.settingsLinkTitle")),!l&&C&&React.createElement(React.Fragment,null,React.createElement(DappListDrawer,{visible:a===Q.dappList,onCancelClick:r,popupView:t,sendAnalyticsEvent:handleSendAnalyticsEvent}),React.createElement(SettingsLink,{onClick:handleOpenDappListDrawer,description:c("browserView.settings.wallet.authorizedDApps.description"),"data-testid":"settings-wallet-authorized-dapps-link"},c("browserView.settings.wallet.authorizedDApps.title"))),!l&&React.createElement(SettingsLink,{onClick:handleOpenGeneralSettingsDrawer,description:c("browserView.settings.wallet.general.description"),"data-testid":"settings-wallet-general-link"},c("browserView.settings.wallet.general.title")),e&&e({activeDrawer:a,closeDrawer:r,openDrawer:o}),!p&&!l&&React.createElement(React.Fragment,null,React.createElement(SettingsLink,{onClick:handleOpenCollateralDrawer,description:c("browserView.settings.wallet.collateral.description"),"data-testid":"settings-wallet-collateral-link",addon:c(S?"browserView.settings.wallet.collateral.active":"browserView.settings.wallet.collateral.inactive")},c("browserView.settings.wallet.collateral.title")),React.createElement(Collateral.CollateralDrawer,{visible:a===Q.collateral,onClose:r,hasCollateral:S,unspendableLoaded:(null==w?void 0:w.coins)!==void 0,sendAnalyticsEvent:handleSendAnalyticsEvent}),React.createElement(SettingsLink,{description:c("browserView.settings.wallet.walletSync.description"),"data-testid":"settings-wallet-wallet-sync",addon:!t&&T},c("browserView.settings.wallet.walletSync.title")),t&&T)))};var J=s("./src/providers/PostHogClientProvider/index.ts");const{Title:Z}=r["default"];const SettingsSecurity_SettingsSecurity=({popupView:e=false,defaultPassphraseVisible:t,defaultMnemonic:s})=>{var a,n;const o=usePostHogClientContext();const r=null==o?void 0:o.isFeatureFlagEnabled("create-paper-wallet");const[i,l]=useState(false);const[c,d]=useState(false);const[u,m]=useState(true);const[v,p]=useState(false);const{t:g}=useTranslation();const{isWalletLocked:w,isInMemoryWallet:S,isSharedWallet:y,isNamiWallet:f}=useWalletStore();const[b]=useAppSettingsContext();const{mnemonicVerificationFrequency:E}=b;const{blockchain:C}=useCurrentBlockchain();const T=null===(a=PHRASE_FREQUENCY_OPTIONS.find(({value:e})=>e===E))||void 0===a?void 0:a.label;const[k,{updateLocalStorage:h}]=useLocalStorage(ENHANCED_ANALYTICS_OPT_IN_STATUS_LS_KEY,EnhancedAnalyticsOptInStatus.OptedOut);const R=useAnalyticsContext();const A=false;const x="bitcoin"===C;const handleAnalyticsChoice=async e=>{const t=e?EnhancedAnalyticsOptInStatus.OptedIn:EnhancedAnalyticsOptInStatus.OptedOut;if(e){await R.setOptedInForEnhancedAnalytics(t);await R.sendEventToPostHog(PostHogAction.SettingsAnalyticsAgreeClick);await R.sendAliasEvent()}else{await R.sendEventToPostHog(PostHogAction.SettingsAnalyticsSkipClick);await R.setOptedInForEnhancedAnalytics(t)}h(t)};const P=useCallback(async()=>{m(w()||!S)},[S,w]);const handleCloseShowPassphraseDrawer=async()=>{d(false);await R.sendEventToPostHog(PostHogAction.SettingsShowRecoveryPhraseYourRecoveryPhraseXClick);window.location.reload()};const handleOpenShowPassphraseDrawer=()=>{d(true);R.sendEventToPostHog(PostHogAction.SettingsShowRecoveryPhraseClick)};const handleOpenShowPaperWalletDrawer=()=>{p(true);R.sendEventToPostHog(PostHogAction.SettingsOpenGeneratePaperWalletDrawer)};useEffect(()=>{P()},[P]);return React.createElement(React.Fragment,null,React.createElement(PassphraseSettingsDrawer,{visible:i,onClose:()=>l(false),popupView:e}),React.createElement(ShowPassphraseDrawer,{visible:c,onClose:handleCloseShowPassphraseDrawer,popupView:e,defaultPassphraseVisible:t,defaultMnemonic:s,sendAnalyticsEvent:e=>R.sendEventToPostHog(e)}),S&&r&&React.createElement(PaperWalletSettingsDrawer,{isOpen:v,onClose:()=>p(false),popupView:e}),React.createElement(SettingsCard,null,React.createElement(Z,{level:5,className:styles.heading5,"data-testid":"security-settings-heading"},g("browserView.settings.security.title")),!u&&!y&&!f&&React.createElement(React.Fragment,null,React.createElement(SettingsLink,{onClick:handleOpenShowPassphraseDrawer,description:g("browserView.settings.security.showPassphrase.description"),"data-testid":"settings-show-recovery-phrase-link"},g("browserView.settings.security.showPassphrase.title"))),!x&&S&&r&&!e&&React.createElement(SettingsLink,{description:g("browserView.settings.generatePaperWallet.description"),onClick:handleOpenShowPaperWalletDrawer,"data-testid":"settings-generate-paperwallet-link"},g("browserView.settings.generatePaperWallet.title")),A&&S&&React.createElement(SettingsLink,{onClick:()=>l(true),description:g("browserView.settings.security.passphrasePeriodicVerification.description"),addon:`${null===(n=null==T?void 0:T.charAt(0))||void 0===n?void 0:n.toUpperCase()}${null==T?void 0:T.slice(1)}`,"data-testid":"settings-passphrase-verification-link"},g("browserView.settings.security.passphrasePeriodicVerification.title")),React.createElement(SettingsLink,{description:g("browserView.settings.security.analytics.description"),addon:React.createElement(Switch,{testId:"settings-analytics-switch",checked:k===EnhancedAnalyticsOptInStatus.OptedIn,onChange:handleAnalyticsChoice,className:styles.analyticsSwitch}),"data-testid":"settings-analytics-section"},g("browserView.settings.security.analytics.title"))))};const{Title:ee}=r["default"];const et=null;const es=null;const ea=null;const SettingsLegal_SettingsLegal=()=>{const e=useAnalyticsContext();const t=useExternalLinkOpener();const{t:s}=useTranslation();const openTermsOfUse=()=>{t(es);e.sendEventToPostHog(PostHogAction.SettingsTermsAndConditionsClick)};const openPrivacyPolicy=()=>{t(et);e.sendEventToPostHog(PostHogAction.SettingsPrivacyPolicyClick)};const openCookiePolicy=()=>{t(ea);e.sendEventToPostHog(PostHogAction.SettingsCookiePolicyClick)};return React.createElement(React.Fragment,null,React.createElement(SettingsCard,null,React.createElement(ee,{level:5,className:styles.heading5,"data-testid":"legal-settings-heading"},s("browserView.settings.legal.title")),React.createElement(SettingsLink,{description:s("browserView.settings.legal.tnc.description"),onClick:openTermsOfUse,"data-testid":"settings-legal-tnc-link"},s("browserView.settings.legal.tnc.title")),React.createElement(SettingsLink,{description:s("browserView.settings.legal.privacyPolicy.description"),onClick:openPrivacyPolicy,"data-testid":"settings-legal-privacy-policy-link"},s("browserView.settings.legal.privacyPolicy.title")),React.createElement(SettingsLink,{description:s("browserView.settings.legal.cookiePolicy.description"),onClick:openCookiePolicy,"data-testid":"settings-legal-cookie-policy-link"},s("browserView.settings.legal.cookiePolicy.title"))))};var en=s("./src/providers/ExternalLinkOpenerProvider/index.ts");const{Title:eo}=r["default"];const SettingsHelp_SettingsHelp=({popupView:e=false})=>{const{t}=useTranslation();const s=useExternalLinkOpener();const[a,n]=useState(false);const o=useAnalyticsContext();const toggleSupportDrawer=()=>{n(!a);const e=a?PostHogAction.SettingsHelpXClick:PostHogAction.SettingsHelpClick;o.sendEventToPostHog(e)};const handleDrawerPosthogEvent=async e=>{await o.sendEventToPostHog(e)};const handleFaqClick=async()=>{await o.sendEventToPostHog(PostHogAction.SettingsFaqsClick);s("https://www.lace.io/faq")};return React.createElement(React.Fragment,null,React.createElement(SupportDrawer,{visible:a,onClose:toggleSupportDrawer,popupView:e,sendPostHogEvent:handleDrawerPosthogEvent}),React.createElement(SettingsCard,null,React.createElement(eo,{level:5,className:styles.heading5,"data-testid":"support-settings-heading"},t("browserView.settings.help.title")),React.createElement(SettingsLink,{description:t("browserView.settings.help.faqs.description"),onClick:handleFaqClick,"data-testid":"settings-support-faqs-link"},t("browserView.settings.help.faqs.title")),React.createElement(SettingsLink,{description:t("browserView.settings.help.support.createASupportTicket"),onClick:toggleSupportDrawer,"data-testid":"settings-support-help-link"},t("browserView.settings.help.support.help"))))};var er=s("./src/providers/ThemeProvider/index.ts");var ei=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var el=s.n(ei);var ec=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var ed=s.n(ec);var eu=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var em=s.n(eu);var ev=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var ep=s.n(ev);var eg=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var ew=s.n(eg);var eS=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var ey=s.n(eS);var ef=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/components/QRPublicKeyDrawer/QRPublicKeyDrawer.module.scss");var eb={};eb.styleTagTransform=ey();eb.setAttributes=ep();eb.insert=em().bind(null,"head");eb.domAPI=ed();eb.insertStyleElement=ew();var eE=el()(ef["default"],eb);const eC=ef["default"]&&ef["default"].locals?ef["default"].locals:void 0;var eT=s("./src/lib/scripts/background/util.ts");const useWalletInformation=()=>{const{walletRepository:e}=useWalletManager();const t=useObservable(e.wallets$);const s=useCurrentWallet();const a=getParentWalletCIP1854Account({wallets:t,activeWallet:s});return useWalletStore(e=>{var t;return{name:null==e?void 0:null===(t=e.walletInfo)||void 0===t?void 0:t.name,publicKey:(null==e?void 0:e.isSharedWallet)?null==a?void 0:a.extendedAccountPublicKey:null==e?void 0:e.cardanoWallet.source.account.extendedAccountPublicKey}})};const QRPublicKeyDrawer_QRPublicKeyDrawer=({isPopup:e,sendAnalyticsEvent:t})=>{const{name:s,publicKey:a}=useWalletInformation();const{theme:n}=useTheme();const{t:o}=useTranslation();const r={copy:o("core.infoWallet.copy"),copiedMessage:o("general.clipboard.copiedToClipboard")};return React.createElement("div",{className:styles.container},React.createElement(InfoWallet,{onClick:()=>t(PostHogAction.SettingsYourKeysShowPublicKeyCopyClick),getQRCodeOptions:()=>getQRCodeOptions(n,e&&168),isPopupView:e,walletInfo:{name:s,qrData:null==a?void 0:a.toString()},translations:r}))};const{Text:ek}=r["default"];const GeneralSettingsDrawer_GeneralSettingsDrawer=({visible:e,onClose:t,popupView:s,sendAnalyticsEvent:a})=>{const[n,o]=useState(false);const{t:r}=useTranslation();const handleGoBackDrawer=()=>{if(n)o(false);else t()};const handleClose=()=>{t();o(false)};useKeyboardShortcut(["Escape"],()=>e&&handleGoBackDrawer());const handleShowPubKeyButtonClick=()=>{o(true);a(PostHogAction.SettingsYourKeysShowPublicKeyClick)};return React.createElement(React.Fragment,null,React.createElement(Drawer,{visible:e,onClose:handleClose,title:React.createElement(DrawerHeader,{popupView:s,title:r(n?"qrInfo.publicKey":"browserView.settings.wallet.general.title")}),navigation:React.createElement(DrawerNavigation,{title:r("browserView.settings.heading"),onCloseIconClick:s?void 0:handleClose,onArrowIconClick:s||n?handleGoBackDrawer:void 0}),popupView:s,destroyOnClose:true},React.createElement("div",{className:s?styles.popupContainer:void 0},n?React.createElement(QRPublicKeyDrawer,{isPopup:s,sendAnalyticsEvent:a}):React.createElement(SettingsCard,null,React.createElement(ek,{className:styles.drawerDescription},r("browserView.settings.wallet.general.showPubKeyDescription")),React.createElement(Button,{size:"large",color:"primary",block:true,"data-testid":"show-public-key-button",className:styles.drawerButton,onClick:handleShowPubKeyButtonClick},r("browserView.settings.wallet.general.showPubKeyAction"))))))};var eh=s("./src/assets/icons/edit.component.svg");const{Text:eR}=r["default"];const PassphraseSettingsDrawer_PassphraseSettingsDrawer=({visible:e,onClose:t,popupView:s=false})=>{const{t:a}=useTranslation();const[n,o]=useAppSettingsContext();const{mnemonicVerificationFrequency:r}=n;const onPassphrasePeriodChange=e=>{o({...n,mnemonicVerificationFrequency:e.target.value});toast.notify({text:a("browserView.settings.security.periodicVerification.success"),withProgressBar:true,...!s&&{style:{textAlign:"right",paddingRight:`${DRAWER_WIDTH/2+DRAWER_PADDING}px`},className:styles.networkToast},icon:EditIcon}).then(()=>{t()});return e};return React.createElement(Drawer,{visible:e,onClose:t,title:React.createElement(DrawerHeader,{popupView:s,title:a("browserView.settings.security.periodicVerification.title")}),navigation:React.createElement(DrawerNavigation,{title:a("browserView.settings.heading"),onCloseIconClick:s?void 0:t,onArrowIconClick:s?t:void 0}),popupView:s,destroyOnClose:true,keyboard:false},React.createElement("div",{className:s?styles.popupContainer:void 0},React.createElement(eR,{className:styles.drawerDescription},a("browserView.settings.security.periodicVerification.description")),React.createElement("div",{className:styles.radios},React.createElement(Radio.Group,{className:styles.radioGroup,onChange:onPassphrasePeriodChange,value:r},PHRASE_FREQUENCY_OPTIONS.map(({value:e,label:t})=>React.createElement("a",{key:e,className:styles.radio},React.createElement(Radio,{key:e,value:e,className:styles.radioLabel},t)))))))};const{Title:eA,Text:ex}=r["default"];const SupportDrawer_SupportDrawer=({visible:e,onClose:t,popupView:s=false,sendPostHogEvent:a})=>{const{t:n}=useTranslation();const o=useExternalLinkOpener();const onCreateSupportTicketClick=async()=>{await a(PostHogAction.SettingsHelpCreateSupportTicketClick);o("https://iohk.zendesk.com/hc/en-us/requests/new")};return React.createElement(Drawer,{visible:e,onClose:t,title:React.createElement(DrawerHeader,{popupView:s,title:n("browserView.settings.help.support.help")}),navigation:React.createElement(DrawerNavigation,{title:n("browserView.settings.heading"),onCloseIconClick:s?void 0:t,onArrowIconClick:s?t:void 0}),popupView:s},React.createElement("div",{className:s?styles.popupContainer:void 0},React.createElement(ex,{className:styles.drawerDescription,"data-testid":"help-description"},n("browserView.settings.help.support.description")),React.createElement(eA,{level:5,className:`${s?"mt-5":"mt-4"} mb-3 font-weight-600 line-height-3 font-body-large`,"data-testid":"help-zen-title"},n("browserView.settings.help.support.iogZenDesk")),React.createElement(Button,{size:"large",color:"primary",block:true,"data-testid":"create-new-ticket-button",onClick:onCreateSupportTicketClick},n("browserView.settings.help.support.createASupportTicket"))))};var eP=s("../../node_modules/buffer/index.js")["Buffer"];const eI=null;const{Text:e_}=r["default"];const eD="browserView.settings.security.showPassphraseDrawer.showPassphrase";const ShowPassphraseDrawer_ShowPassphraseDrawer=({visible:e,onClose:t,popupView:s=false,defaultPassphraseVisible:a=false,defaultMnemonic:n=[],sendAnalyticsEvent:o})=>{const{t:r}=useTranslation();const[i,l]=useState(false);const[c,d]=useState(n);const[u,m]=useState(a);const[{isProcessing:v,isPasswordValid:p},g]=useState({isProcessing:false,isPasswordValid:true});const w=useSecrets();const{unlockWallet:S,getMnemonic:y}=useWalletManager();const f=!u&&(!w.password.value||v);const handleChange=e=>w.setPassword(e);const toggleBlurWords=()=>{l(!i);if(!i)o(PostHogAction.SettingsShowRecoveryPhraseYourRecoveryPhraseHidePassphraseClick)};const b=useCallback(async e=>{const t=await y(eP.from(e));d(t)},[y]);const handleVerifyPass=async()=>{if(v)return;g({isPasswordValid:true,isProcessing:true});try{await S();await b(w.password.value);m(true);g({isPasswordValid:true,isProcessing:false});w.clearSecrets();o(PostHogAction.SettingsShowRecoveryPhraseEnterYourPasswordShowRecoveryPhraseClick)}catch{w.clearSecrets();m(false);g({isPasswordValid:false,isProcessing:false})}};const handleShowPassphrase=async()=>{if(u)toggleBlurWords();else await handleVerifyPass()};const getButtonLabel=()=>{if(u){return i?r(eD):r("browserView.settings.security.showPassphraseDrawer.hidePassphrase")}return r(eD)};const handleOnClose=()=>{g({isPasswordValid:true,isProcessing:false});l(false);d([]);w.clearSecrets();m(false);t()};useKeyboardShortcut(["Escape"],()=>handleOnClose());useAutoFocus(eI,!u&&e);return React.createElement(Drawer,{visible:e,onClose:handleOnClose,title:React.createElement(DrawerHeader,{popupView:s,title:u?r("browserView.settings.security.showPassphraseDrawer.YourRecoveryPhrase"):r("browserView.settings.security.showPassphraseDrawer.title")}),navigation:React.createElement(DrawerNavigation,{title:r("browserView.settings.heading"),onCloseIconClick:s?void 0:handleOnClose,onArrowIconClick:s?handleOnClose:void 0}),popupView:s,footer:React.createElement(React.Fragment,null,React.createElement(Button,{size:"large",block:true,loading:v,disabled:f,onClick:handleShowPassphrase,"data-testid":getButtonLabel()===r(eD)?"show-passphrase-button":"hide-passphrase-button"},getButtonLabel()))},React.createElement("div",null,!u&&React.createElement(e_,{className:styles.drawerDescription,"data-testid":"passphrase-drawer-description"},r("browserView.settings.security.showPassphraseDrawer.description")),!u&&React.createElement(React.Fragment,null,React.createElement("div",{className:styles.warningBanner},React.createElement(Banner,{withIcon:true,message:r("browserView.settings.security.showPassphraseDrawer.warning")})),React.createElement("div",{className:styles.passwordContainer},React.createElement("div",{className:styles.password},React.createElement(Password,{className:styles.passwordInput,onChange:handleChange,error:!p,errorMessage:r("browserView.transaction.send.error.invalidPassword"),label:r("browserView.transaction.send.password.placeholder"),id:eI,autoFocus:true})))),u&&React.createElement("div",{className:styles.passphraseContainer},React.createElement(MnemonicWordsWritedown,{firstWordNumber:1,words:c,fourColumnView:true,blurWords:i}))))};var eN=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/settings/components/Collateral/Collateral.module.scss");var eB={};eB.styleTagTransform=ey();eB.setAttributes=ep();eB.insert=em().bind(null,"head");eB.domAPI=ed();eB.insertStyleElement=ew();var eO=el()(eN["default"],eB);const ej=eN["default"]&&eN["default"].locals?eN["default"].locals:void 0;var eV=s("./src/views/browser-view/features/settings/components/Collateral/types.ts");var eW=s("./src/views/browser-view/stores/index.ts");const eM=(0,eW.createSectionsStore)({config:eV.sectionsConfig,section:eV.sectionsConfig.reclaim});const store_useSections=()=>eM(({currentSection:e,setSection:t,setPrevSection:s})=>({currentSection:e,setSection:t,setPrevSection:s}));var eL=s("./src/components/MainLoader/index.ts");var eF=s("./src/lib/wallet-api-ui.ts");const CollateralFooterSend_CollateralFooterSend=({onClose:e,onClaim:t,walletType:s,setIsPasswordValid:a,popupView:n,secretsUtil:o,submitCollateralTx:r,hasEnoughAda:i,isInitializing:l,isSubmitting:c,setCurrentStep:d})=>{const{t:u}=useTranslation();const m=useBackgroundServiceAPIContext();const v=s===WalletType.InMemory;const submitTx=async()=>withSignTxConfirmation(r,o.password.value);const handleClick=async()=>{if(!i){return e()}try{if(n&&!v)return await (null==m?void 0:m.handleOpenBrowser({section:BrowserViewSections.COLLATERAL_SETTINGS}));await submitTx();t();toast.notify({text:u("browserView.settings.wallet.collateral.toast.add")});if(v)e()}catch{if(v)a(false);else d({currentSection:Sections.FAIL_TX})}return true};const p=useMemo(()=>{if(i){if(v){return u("browserView.settings.wallet.collateral.confirm")}if(n){return u("browserView.settings.wallet.collateral.continueInAdvancedView")}return u("browserView.settings.wallet.collateral.confirmWithDevice",{hardwareWallet:s})}return u("browserView.settings.wallet.collateral.close")},[i,v,s,n,u]);const g=v&&!o.password.value;const w=i&&g;return React.createElement(Button,{"data-testid":"collateral-confirmation-btn",disabled:c||l||w,loading:c||l,className:styles.confirmBtn,size:"large",onClick:handleClick},p)};var eH=s("./src/views/browser-view/features/send-transaction/components/TransactionSuccess.tsx");var e$=s("./src/views/browser-view/features/send-transaction/components/TransactionFail.tsx");var eU=s("./src/views/browser-view/features/send-transaction/index.ts");var eK=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Footer.module.scss");var eG=s("./src/routes/index.ts");const eq={[eV.Sections.SUCCESS_TX]:"browserView.transaction.send.footer.viewTransaction",[eV.Sections.FAIL_TX]:"browserView.transaction.send.footer.fail"};const FooterHW_FooterHW=({currentSection:e,setCurrentStep:t,hideDrawer:s})=>{const{t:a}=useTranslation();const n=useRedirection(walletRoutePaths.activity);const o=useBackgroundServiceAPIContext();const{clearBuiltTxData:r}=useBuiltTxState();const i=useRedirection(walletRoutePaths.settings);const l=useCallback(()=>{if(e===Sections.SUCCESS_TX){s();r();t({currentSection:Sections.RECLAIM});n()}else{r();t({currentSection:Sections.SEND})}window.location.reload()},[e,s,r,t,n]);const c=useCallback(async()=>{var e,t;const s=await o.getBackgroundStorage();if(!s)return;if((null===(e=s.message)||void 0===e?void 0:e.type)===MessageTypes.OPEN_COLLATERAL_SETTINGS&&(null===(t=s.message)||void 0===t?void 0:t.data.section)===BrowserViewSections.COLLATERAL_SETTINGS)await o.clearBackgroundStorage({keys:["message"]});i();window.location.reload()},[o,i]);return React.createElement("div",{className:styles.footer},React.createElement(Button,{size:"large",block:true,onClick:l,"data-testid":"collateral-tx-next-btn"},a(eq[e])),React.createElement(Button,{color:"secondary",size:"large",block:true,onClick:c,"data-testid":"collateral-tx-cancel-btn"},a(e===Sections.SUCCESS_TX?"browserView.transaction.send.footer.close":"browserView.transaction.send.footer.cancel")))};const CollateralDrawer=({visible:e,onClose:t,hasCollateral:s,unspendableLoaded:a,sendAnalyticsEvent:n})=>{var o;const{t:r}=useTranslation();const{currentSection:i,setSection:l}=useSections();const{isInMemoryWallet:c,walletType:d,walletUI:{appMode:u}}=useWalletStore();const m=u===APP_MODE_POPUP;const v=useSecrets();const[p,g]=useState(true);const w=useSyncingTheFirstTime();const{initializeCollateralTx:S,submitCollateralTx:y,isInitializing:f,isSubmitting:b,hasEnoughAda:E,txFee:C}=useCollateral();const{builtTxData:T,clearBuiltTxData:k}=useBuiltTxState();const h=!w&&a;const R=useCallback(async()=>{n(PostHogAction.SettingsCollateralXClick);if([Sections.FAIL_TX,Sections.SUCCESS_TX].includes(i.currentSection)&&!c)window.location.reload();else t()},[c,t,i.currentSection,n]);useEffect(()=>{if(!e)return;k();S()},[S,e,k]);useEffect(()=>{l({currentSection:Sections.RECLAIM})},[l]);useEffect(()=>{if(!c||!h)return;l({currentSection:s?Sections.RECLAIM:Sections.SEND})},[s,c,l,h]);useEffect(()=>{if(c||!h)return;if(!s&&i.currentSection===Sections.RECLAIM)l({currentSection:Sections.SEND})},[s,c,i.currentSection,l,h]);useEffect(()=>{var e;if(c||!(null==T?void 0:null===(e=T.uiTx)||void 0===e?void 0:e.hash))return;l({currentSection:Sections.SUCCESS_TX})},[null==T?void 0:null===(o=T.uiTx)||void 0===o?void 0:o.hash,c,l]);const handleReclaimCollateral=()=>{t();n(PostHogAction.SettingsCollateralReclaimCollateralClick)};const handleConfirmCollateral=()=>{t();n(PostHogAction.SettingsCollateralConfirmClick)};const A={[Sections.RECLAIM]:React.createElement(CollateralStepReclaim,{popupView:m}),[Sections.SEND]:React.createElement(CollateralStepSend,{popupView:m,setPassword:v.setPassword,isInMemory:c,isPasswordValid:p,setIsPasswordValid:g,txFee:C,hasEnoughAda:E}),[Sections.SUCCESS_TX]:React.createElement(TransactionSuccess,null),[Sections.FAIL_TX]:React.createElement(TransactionFail,null)};const x={[Sections.RECLAIM]:React.createElement(CollateralFooterReclaim,{setCurrentStep:l,onClose:handleReclaimCollateral,onClaim:v.clearSecrets,isInitializing:f,isSubmitting:b}),[Sections.SEND]:React.createElement(CollateralFooterSend,{setCurrentStep:l,onClose:handleConfirmCollateral,onClaim:v.clearSecrets,walletType:d,setIsPasswordValid:g,popupView:m,secretsUtil:v,submitCollateralTx:y,hasEnoughAda:E,isInitializing:f,isSubmitting:b}),[Sections.SUCCESS_TX]:React.createElement(FooterHW,{hideDrawer:t,currentSection:i.currentSection,setCurrentStep:l}),[Sections.FAIL_TX]:React.createElement(FooterHW,{hideDrawer:t,currentSection:i.currentSection,setCurrentStep:l})};return React.createElement(Drawer,{visible:e,onClose:R,title:React.createElement(DrawerHeader,{popupView:m,title:r("browserView.settings.wallet.collateral.title")}),navigation:React.createElement(DrawerNavigation,{title:r("browserView.settings.heading"),onCloseIconClick:m?void 0:R,onArrowIconClick:m?R:void 0}),popupView:m,className:styles.collateralDrawer,footer:x[i.currentSection]},h?A[i.currentSection]:React.createElement(MainLoader,null))};const CollateralFooterReclaim_CollateralFooterReclaim=({setCurrentStep:e,onClose:t,onClaim:s,isSubmitting:a,isInitializing:n})=>{const{t:o}=useTranslation();const{inMemoryWallet:r}=useWalletStore();const handleClick=async()=>{s();await r.utxo.setUnspendable([]);toast.notify({text:o("browserView.settings.wallet.collateral.toast.claim")});e({currentSection:Sections.SEND});t();return true};return React.createElement(Button,{"data-testid":"collateral-confirmation-btn",disabled:n,loading:a||n,className:styles.confirmBtn,size:"large",onClick:handleClick},o("browserView.settings.wallet.collateral.reclaimCollateral"))};var eY=s("../../packages/cardano/dist/index.esm.js");var ez=s("../../packages/core/src/ui/assets/icons/sad-face.component.svg");const eX=null;const{Text:eQ}=r["default"];const CollateralStepSend_CollateralStepSend=({popupView:e=false,setPassword:t,isInMemory:s,isPasswordValid:a,setIsPasswordValid:n,txFee:o,hasEnoughAda:r})=>{var i;const{t:l}=useTranslation();const handlePasswordChange=e=>{n(true);return t(e)};const{priceResult:c}=useFetchCoinPrice();const{fiatCurrency:d}=useCurrencyStore();useAutoFocus(eX,true);return React.createElement("div",{"data-testid":"collateral-send",className:e?styles.popupContainer:void 0,style:{height:"100%"}},React.createElement("div",{className:collateralStyles.collateralContainer},React.createElement("div",{className:collateralStyles.contentContainer},React.createElement(eQ,{className:styles.drawerDescription,"data-testid":"collateral-description"},l("browserView.settings.wallet.collateral.amountDescription")),r&&React.createElement("div",{className:styles.bannerContainer},React.createElement(Banner,{withIcon:true,message:l("browserView.settings.wallet.collateral.reclaimBanner")})),s&&r&&React.createElement("div",{"data-testid":"collateral-password",className:styles.passwordContainerCollateral},React.createElement(Spin,{spinning:false},React.createElement(Password,{onChange:handlePasswordChange,error:false===a,errorMessage:l("browserView.transaction.send.error.invalidPassword"),label:l("browserView.transaction.send.password.placeholder"),id:eX,autoFocus:true}))),!r&&React.createElement("div",{className:collateralStyles.notEnoughContainer},React.createElement(SadFaceIcon,{className:collateralStyles.sadFace,"data-testid":"collateral-sad-face-icon"}),React.createElement(eQ,{className:collateralStyles.sadFaceText,"data-testid":"collateral-not-enough-ada-error"},l("browserView.settings.wallet.collateral.notEnoughAda")))),r&&o&&React.createElement(RowContainer,null,renderLabel({label:l("staking.confirmation.transactionFee"),dataTestId:"sp-confirmation-staking-fee",tooltipContent:l("send.theAmountYoullBeChargedToProcessYourTransaction")}),React.createElement("div",null,renderAmountInfo(Wallet.util.getFormattedAmount({amount:o.toString(),cardanoCoin}),`${Wallet.util.convertAdaToFiat({ada:Wallet.util.lovelacesToAdaString(o.toString()),fiat:(null==c?void 0:null===(i=c.cardano)||void 0===i?void 0:i.price)||0})} ${null==d?void 0:d.code}`)))))};const{Text:eJ}=r["default"];const CollateralStepReclaim_CollateralStepReclaim=({popupView:e})=>{const{t}=useTranslation();return React.createElement("div",{className:e?styles.popupContainer:void 0,style:{height:"100%"}},React.createElement("div",{className:collateralStyles.collateralContainer},React.createElement("div",{className:collateralStyles.contentContainer},React.createElement(eJ,{className:styles.drawerDescription,"data-testid":"collateral-description"},t("browserView.settings.wallet.collateral.reclaimDescription")),React.createElement("div",{className:styles.bannerContainer},React.createElement(Banner,{withIcon:true,message:t("browserView.settings.wallet.collateral.reclaimBanner")})))))};const{Text:eZ}=r["default"];const CurrencyDrawer_CurrencyDrawer=({visible:e,onClose:t,popupView:s=false,sendCurrencyChangeEvent:a})=>{const{t:n}=useTranslation();const{fiatCurrency:o,supportedCurrencies:r,setFiatCurrency:i}=useCurrencyStore();const{blockchain:l}=useCurrentBlockchain();const c="bitcoin"===l;const handleCurrencyChange=e=>{try{i(e.target.value);toast.notify({text:n("browserView.settings.preferences.currency.toast"),withProgressBar:true,icon:SwithIcon});if(a)a(e.target.value)}catch(t){logger.error("Error updating currency",t);toast.notify({text:n("general.errors.somethingWentWrong"),icon:ErrorIcon})}return e};const d={code:CARDANO_COIN_SYMBOL[Wallet.Cardano.NetworkId.Mainnet]};const u=[d,...r];return React.createElement(Drawer,{visible:e,onClose:t,title:React.createElement(DrawerHeader,{title:n("browserView.settings.preferences.currency.title"),subtitle:s?void 0:n("browserView.settings.preferences.currency.description"),popupView:s}),navigation:React.createElement(DrawerNavigation,{title:n("browserView.settings.heading"),onCloseIconClick:s?void 0:t,onArrowIconClick:s?t:void 0}),popupView:s},React.createElement("div",{className:s?styles.popupContainer:void 0},s&&React.createElement(eZ,{className:styles.drawerDescription},n("browserView.settings.preferences.currency.description")),React.createElement("div",{className:styles.radios},React.createElement(Radio.Group,{className:styles.radioGroup,onChange:handleCurrencyChange,value:null==o?void 0:o.code,"data-testid":"network-choice-radio-group"},u.map(({code:e})=>React.createElement("a",{className:styles.radio,key:e},React.createElement(Radio,{value:e,className:styles.radioLabel,"data-testid":`currency-${e.toLowerCase()}-radio-button`},React.createElement("span",{className:styles.currencyWrapper},React.createElement("span",null,c&&"ADA"===e?"BTC":e),React.createElement("span",{className:styles.currency},c&&"ADA"===e?"Bitcoin":n(`browserView.settings.preferences.currency.list.${e}`))))))))))};var e0=s("./src/components/MainMenu/DropdownMenuOverlay/components/index.ts");const{Title:e1}=r["default"];const SettingsPreferences_SettingsPreferences=({popupView:e=false})=>{var t;const s=useAnalyticsContext();const[a,n]=useState(false);const[o,r]=useState(false);const{t:i}=useTranslation();const{fiatCurrency:l}=useCurrencyStore();const c=usePostHogClientContext();const[d,u]=useState(false);const{blockchain:m}=useCurrentBlockchain();const v="bitcoin"===m;useEffect(()=>{const e=c.hasOptedInBeta().subscribe(e=>{u(e)});(async()=>{const e=await getBackgroundStorage();r("debug"===e.logLevel)})();return()=>{e.unsubscribe()}},[c]);const handleLoggingOnChange=async()=>{await setBackgroundStorage({logLevel:o?"info":"debug"});r(!o);void s.sendEventToPostHog(o?PostHogAction.SettingsDebuggingOffClick:PostHogAction.SettingsDebuggingOnClick)};const handleOpenCurrencyDrawer=()=>{n(true);s.sendEventToPostHog(PostHogAction.SettingsCurrencyClick)};const handleCloseCurrencyDrawer=()=>{n(false);s.sendEventToPostHog(PostHogAction.SettingsCurrencyXClick)};const handleSendCurrencyChangeEvent=e=>s.sendEventToPostHog(PostHogAction.SettingsCurrencySelectCurrencyClick,{currency:e});const handleBetaOptInChoice=async e=>{await c.setOptedInBeta(e);u(e);await s.sendEventToPostHog(e?PostHogAction.SettingsBetaProgramOptInClick:PostHogAction.SettingsBetaProgramOptOutClick)};return React.createElement(React.Fragment,null,React.createElement(CurrencyDrawer,{visible:a,onClose:handleCloseCurrencyDrawer,popupView:e,sendCurrencyChangeEvent:handleSendCurrencyChangeEvent}),React.createElement(SettingsCard,null,React.createElement(e1,{level:5,className:styles.heading5,"data-testid":"wallet-preferences-heading"},i("browserView.settings.preferences.title")),React.createElement(SettingsLink,{onClick:handleOpenCurrencyDrawer,description:i("browserView.settings.preferences.currency.description"),addon:v&&(null==l?void 0:l.code)==="ADA"?"BTC":null==l?void 0:null===(t=l.code)||void 0===t?void 0:t.toUpperCase(),"data-testid":"settings-wallet-currency-link"},i("browserView.settings.preferences.currency.title")),React.createElement(SettingsLink,{description:i("browserView.settings.preferences.theme.description"),"data-testid":"settings-wallet-theme",addon:React.createElement(ThemeSwitch,{section:"settings"})},i("browserView.settings.preferences.theme.title")),React.createElement(SettingsLink,{description:i("browserView.settings.preferences.betaProgram.description"),addon:React.createElement(Switch,{testId:"settings-beta-program-switch",checked:d,onChange:handleBetaOptInChoice,className:styles.analyticsSwitch}),"data-testid":"settings-beta-program-section"},i("browserView.settings.preferences.betaProgram.title")),React.createElement(SettingsLink,{onClick:handleLoggingOnChange,description:i("browserView.settings.preferences.debugging.description"),addon:React.createElement(Switch,{testId:"settings-logging-switch",checked:o,onChange:()=>r(!o),className:styles.analyticsSwitch}),"data-testid":"settings-logging-level-section"},i("browserView.settings.preferences.debugging.title"))))};var e2=s("../../packages/translation/dist/index.esm.js");var e8=s("./src/utils/PaperWallet/index.ts");const e4=null;const PassphraseStage_PassphraseStage=({setPassword:e,isPasswordValid:t})=>{useAutoFocus(e4,true);return React.createElement(Flex,{mt:"$8",flexDirection:"column",gap:"$8"},React.createElement(Flex,{gap:"$32",flexDirection:"column",alignItems:"center"},React.createElement("div",{className:styles.warningBanner},React.createElement(Banner,{withIcon:true,message:i18n.t("browserView.settings.security.showPassphraseDrawer.warning")})),React.createElement("div",{className:styles.passwordContainer},React.createElement("div",{className:styles.password},React.createElement(Password,{className:styles.passwordInput,onChange:e,error:!t,errorMessage:i18n.t("browserView.transaction.send.error.invalidPassword"),label:i18n.t("browserView.transaction.send.password.placeholder"),id:e4,autoFocus:true,onSubmit:null})))))};var e6=s("./src/utils/pgp.ts");var e3=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/settings/components/PaperWallet/SecureStage.module.scss");var e5={};e5.styleTagTransform=ey();e5.setAttributes=ep();e5.insert=em().bind(null,"head");e5.domAPI=ed();e5.insertStyleElement=ew();var e9=el()(e3["default"],e5);const e7=e3["default"]&&e3["default"].locals?e3["default"].locals:void 0;const SecureStage_SecureStage=({setPgpInfo:e,pgpInfo:t})=>{const[s,a]=useState({error:null,success:null});const n=pgpPublicKeyVerification(e,a);const handlePgpReferenceChange=s=>{e({...t,pgpKeyReference:s.target.value})};return React.createElement(Flex,{my:"$16",h:"$fill"},React.createElement(PgpPublicKeyEntry,{handlePgpPublicKeyBlockChange:n,handlePgpReferenceChange:handlePgpReferenceChange,validation:s,pgpInfo:t,textareaWrapperClassName:styles.fullHeight}))};const SaveStage_SaveStage=({walletName:e})=>React.createElement(Flex,{gap:"$16",mt:"$8",flexDirection:"column"},React.createElement(PaperWalletInfoCard,{walletName:e}));var te=s("../../node_modules/buffer/index.js")["Buffer"];const tt="incorrect stage supplied";const ts={pgpPublicKey:null,pgpKeyReference:null};const ta={blob:null,loading:true,url:null,error:null};const PaperWalletSettingsDrawer_PaperWalletSettingsDrawer=({isOpen:e,onClose:t,popupView:s=false})=>{const[a,n]=useState("secure");const[o,r]=useState(ts);const[{isProcessing:i,isPasswordValid:l},c]=useState({isProcessing:false,isPasswordValid:true});const[d,u]=useState(ta);const{password:m,setPassword:v,clearSecrets:p}=useSecrets();const{unlockWallet:g,getMnemonic:w}=useWalletManager();const{walletInfo:S}=useWalletStore();const{CHAIN:y}=config();const[f,b]=useState([]);const E=useRef(m);E.current=m;const C=useAnalyticsContext();const T=useCallback(()=>{n("secure");r(ts);p();b([]);t()},[n,r,p,b,t]);const k=useCallback(async e=>{if(i)return;c({isPasswordValid:true,isProcessing:true});try{await g();const t=await w(te.from(e.value));b(t);C.sendEventToPostHog(PostHogAction.SettingsPaperWalletPasswordNextClick);n("save");c({isPasswordValid:true,isProcessing:false});p()}catch{p();c({isPasswordValid:false,isProcessing:false})}},[i,g,w,p,C]);useEffect(()=>{if((null==S?void 0:S.addresses[0].address)&&f&&o.pgpPublicKey)generatePaperWalletPdf({walletAddress:S.addresses[0].address,walletName:S.name,pgpInfo:o,mnemonic:f,chain:y}).then(e=>u(e)).catch(e=>{u({error:e,loading:false})});return()=>{u(ta)}},[f,o,S,y,u]);var h;const R=i18n.t("core.paperWallet.savePaperWallet.walletName",{walletName:replaceWhitespace(null!==(h=null==S?void 0:S.name)&&void 0!==h?h:"","_").trim()});const A=useMemo(()=>{switch(a){case"secure":return React.createElement(SecureStage,{setPgpInfo:r,pgpInfo:o});case"passphrase":return React.createElement(PassphraseStage,{setPassword:v,isPasswordValid:l});case"save":return React.createElement(SaveStage,{walletName:R});default:throw new Error(tt)}},[a,l,r,o,v,R]);const x=useMemo(()=>{switch(a){case"secure":return React.createElement(Button.CallToAction,{disabled:!o.pgpPublicKey,label:i18n.t("send.form.next"),onClick:()=>{C.sendEventToPostHog(PostHogAction.SettingsPaperWalletPublicKeyNextClick);n("passphrase")},w:"$fill","data-testid":"next-button"});case"passphrase":return React.createElement(Button.CallToAction,{w:"$fill",disabled:!E.current.value,label:i18n.t("browserView.settings.generatePaperWallet.title"),onClick:()=>k(E.current),"data-testid":"generate-paper-wallet-button"});case"save":return React.createElement(Flex,{flexDirection:"column",gap:"$8",className:styles.actionButtonContainer},React.createElement("a",{href:d.url,download:R,target:"_blank",className:styles.fullWidth,"aria-disabled":d.loading||!!d.error,onClick:()=>{C.sendEventToPostHog(PostHogAction.SettingsPaperWalletDownloadClick)}},React.createElement(Button.Primary,{disabled:d.loading||!!d.error,w:"$fill",label:i18n.t("paperWallet.savePaperWallet.downloadBtnLabel"),icon:React.createElement(DownloadIcon,null),"data-testid":"download-button"})),React.createElement(Button.Secondary,{onClick:()=>{C.sendEventToPostHog(PostHogAction.SettingsPaperWalletPrintClick);const e=window.open(URL.createObjectURL(d.blob));e.print()},w:"$fill",disabled:d.loading||!!d.error,icon:React.createElement(PrinterIcon,null),label:i18n.t("paperWallet.savePaperWallet.printBtnLabel"),"data-testid":"print-button"}));default:throw new Error(tt)}},[a,o,n,k,d,R,C]);const P=useMemo(()=>{switch(a){case"secure":return React.createElement(DrawerHeader,{popupView:s,title:i18n.t("paperWallet.securePaperWallet.title"),subtitle:i18n.t("paperWallet.securePaperWallet.description")});case"passphrase":return React.createElement(DrawerHeader,{popupView:s,title:i18n.t("paperWallet.SettingsDrawer.passphraseStage.title"),subtitle:i18n.t("paperWallet.SettingsDrawer.passphraseStage.subtitle")});case"save":return React.createElement(DrawerHeader,{popupView:s,title:i18n.t("paperWallet.savePaperWallet.title"),subtitle:i18n.t("paperWallet.savePaperWallet.description")});default:throw new Error(tt)}},[a,s]);return React.createElement(React.Fragment,null,React.createElement(Drawer,{open:e,dataTestId:"paper-wallet-settings-drawer",onClose:T,popupView:s,title:P,navigation:React.createElement(DrawerNavigation,{title:i18n.t("browserView.settings.heading"),onCloseIconClick:s?void 0:T,onArrowIconClick:s?T:void 0}),footer:x,destroyOnClose:true},A))}},"./src/views/browser-view/features/settings/index.tsx":(e,t,s)=>{s.d(t,{NetworkChoice:()=>a.NetworkChoice});var a=s("./src/views/browser-view/features/settings/components/index.tsx")},"./src/views/browser-view/features/sign-message/SignMessageDrawer.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-i18next/dist/es/index.js");var o=s("./src/stores/index.ts");var r=s("../../packages/common/dist/index.esm.js");var i=s("./src/lib/wallet-api-ui.ts");var l=s("../../packages/cardano/dist/index.esm.js");var c=s("./src/providers/index.ts");var d=s("../../packages/core/dist/index.esm.js");const useSignMessageState_useSignMessageState=()=>{const{t:e}=useTranslation();const t=useAnalyticsContext();const{clearSecrets:s}=useSecrets();const{inMemoryWallet:a,isHardwareWallet:n}=useWalletStore();const[o,r]=useState(false);const[i,l]=useState();const[c,d]=useState("");const[u,m]=useState();const[v,p]=useState("");const g=useObservable(null==a?void 0:a.addresses$);const w=useCallback(()=>{r(false);d("");p("");m(void 0);l(void 0)},[]);const S=useCallback(async(o,i,c)=>{r(true);d("");p("");m(void 0);try{const u=HexBlob.fromBytes(new TextEncoder().encode(i));n?t.sendEventToPostHog(PostHogAction.SignMessageAskingHardwareWalletInteraction):t.sendEventToPostHog(PostHogAction.SignMessageAskingForPassword);const v=await withSignDataConfirmation(async()=>await a.signData({signWith:o,payload:u}),n?{}:c,s);l(v)}catch(g){logger.error("Error signing message:",g);m(parseError(g));if(n&&"object"==typeof g&&null!==g&&"message"in g&&"string"==typeof g.message&&g.message.includes("Failed to execute 'requestDevice' on 'USB'"))p(e("core.signMessage.hardwareWalletNotConnected"));else g instanceof Wallet.KeyManagement.errors.AuthenticationError?d(e("core.signMessage.incorrectPassword")):d(e("core.signMessage.signingFailed"))}finally{r(false)}},[n,t,s,a,e]);const y=(null==g?void 0:g.map((e,t)=>({address:e.address.toString(),id:t})))||[];return{usedAddresses:y,isSigningInProgress:o,signatureObject:i,error:c,errorObj:u,hardwareWalletError:v,isHardwareWallet:n,performSigning:S,resetSigningState:w}};var u=s("./src/views/browser-view/stores/index.ts");var m=s("./src/views/browser-view/components/Drawer/index.ts");var v=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var y=s.n(S);var f=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var b=s.n(f);var E=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var C=s.n(E);var T=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var k=s.n(T);var h=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/sign-message/SignMessageDrawer.module.scss");var R={};R.styleTagTransform=k();R.setAttributes=b();R.insert=y().bind(null,"head");R.domAPI=w();R.insertStyleElement=C();var A=p()(h["default"],R);const x=h["default"]&&h["default"].locals?h["default"].locals:void 0;const useDrawerConfiguration_useDrawerConfiguration=({selectedAddress:e,message:t,isSigningInProgress:s,isHardwareWallet:a,handleSign:n,error:o,clearSecrets:r,signatureObject:i,goBack:l,signAnotherMessage:c})=>{const{t:d}=useTranslation();const[,u]=useDrawer();const[,m]=useDrawer();const v=useCallback(()=>{if(s)return d("core.signMessage.signingInProgress");if(a){return o?d("core.signMessage.back"):d("core.signMessage.signWithHardwareWalletButton")}return d("core.signMessage.signButton")},[s,d,a,o]);const p=useCallback(()=>{a&&o?l():n()},[a,o,l,n]);const g=useCallback(()=>{if((null==i?void 0:i.signature)&&!o){return React.createElement(Button,{onClick:c,"data-testid":"sign-another-message-button"},d("core.signMessage.signAnotherMessage"))}return React.createElement(Button,{onClick:p,disabled:!e||!t||s,"data-testid":"sign-message-button"},v())},[null==i?void 0:i.signature,o,p,e,t,s,v,c,d]);useKeyboardShortcut(["Escape"],()=>m());useKeyboardShortcut(["Enter"],()=>n());const w=useCallback(()=>React.createElement("div",{className:styles.buttonContainer},g(),React.createElement(Button,{color:"secondary",onClick:()=>{m();r()},"data-testid":"close-button"},o&&a?d("core.signMessage.cancelButton"):d("core.signMessage.closeButton"))),[g,o,a,d,m,r]);useEffect(()=>{u({content:DrawerContent.SIGN_MESSAGE,renderHeader:()=>React.createElement(DrawerNavigation,{title:d("core.signMessage.title"),onCloseIconClick:()=>{m();r()}}),renderFooter:w})},[u,m,d,w,r])};var P=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var I=s("./src/components/MainLoader/index.ts");var _=s("./src/components/ResultMessage/index.ts");var D=s("./src/assets/icons/circle-check-gradient.svg");var N=s("./src/assets/icons/copy.component.svg");var B=s("../../node_modules/react-copy-to-clipboard/lib/index.js");const renderCopyToClipboard=({text:e,handleCopy:t,t:s,testId:a})=>React.createElement(CopyToClipboard,{text:e},React.createElement(Box,{className:styles.copyButton,onClick:t},React.createElement(Text.Button,{color:"accent",weight:"$semibold","data-testid":null!=a?a:"copy-to-clipboard-button"},React.createElement(Flex,{alignItems:"center"},React.createElement(CopyToClipboardImg,{className:styles.copyIcon}),s("core.signMessage.copyToClipboard")))));const O=null;const SignMessageDrawer=()=>{const{t:e}=useTranslation();const t=useAnalyticsContext();const{usedAddresses:s,isSigningInProgress:a,signatureObject:n,error:o,errorObj:r,hardwareWalletError:i,isHardwareWallet:l,performSigning:c,resetSigningState:d}=useSignMessageState();const{password:u,setPassword:m,clearSecrets:v}=useSecrets();const[p,g]=useState("");const[w,S]=useState("");const[y,f]=useState(false);const[b,E]=useState(false);const[C,T]=useState(false);const k=useRef(u);k.current=u;useEffect(()=>{if(o)l?E(true):f(true)},[o,l]);const h=useCallback(()=>{if(l||k.current.value){t.sendEventToPostHog(PostHogAction.SignMessageAskingHardwareWalletInteraction);c(p,w,k.current)}else{t.sendEventToPostHog(PostHogAction.SignMessageAskingForPassword);f(true)}},[l,t,c,p,w]);const R=useCallback(()=>{toast.notify({text:e("general.clipboard.copiedToClipboard"),withProgressBar:true});t.sendEventToPostHog(PostHogAction.SignMessageCopySignatureClick)},[t,e]);const A=useCallback(()=>{v();f(false);E(false);d()},[v,d]);const x=useCallback(()=>{S("");g("");A()},[A]);useDrawerConfiguration({selectedAddress:p,message:w,isSigningInProgress:a,isHardwareWallet:l,error:o,handleSign:h,clearSecrets:v,signatureObject:n,goBack:A,signAnotherMessage:x});const renderInitialState=()=>React.createElement(React.Fragment,null,React.createElement(Text.Body.Large,{weight:"$bold","data-testid":"drawer-header-title"},e("core.signMessage.instructions")),React.createElement(Text.Body.Normal,{className:styles.subtitle,"data-testid":"drawer-header-subtitle"},e("core.signMessage.subtitle")),l&&i&&React.createElement("div",{className:styles.errorMessage},React.createElement(Text.Body.Normal,{color:"error"},i)),React.createElement("div",{className:styles.inputGroup},React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"address-label"},e("core.signMessage.addressLabel")),React.createElement(WalletOwnAddressDropdown,{addresses:s,onSelect:g,placeholder:p?shortenWalletOwnAddress(p):e("core.signMessage.selectAddress")})),React.createElement("div",{className:styles.inputGroup},React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"message-to-sign-label"},e("core.signMessage.messageLabel")),React.createElement(TextArea,{placeholder:e("core.signMessage.messagePlaceholder"),value:w,onChange:e=>S(e.target.value),dataTestId:"sign-message-input",rows:4,className:styles.customTextArea})));const renderPasswordPrompt=()=>React.createElement(React.Fragment,null,React.createElement(Text.Body.Large,{weight:"$bold","data-testid":"drawer-header-title"},e("core.signMessage.passwordTitle")),React.createElement(Text.Body.Normal,{className:styles.subtitle,"data-testid":"drawer-header-subtitle"},e("core.signMessage.passwordSubtitle")),React.createElement(PasswordInput,{onChange:m,label:e("core.signMessage.passwordLabel"),dataTestId:"password-input",error:!!o,errorMessage:o,wrapperClassName:styles.passwordWrapper,id:O}));const renderSignature=()=>React.createElement("div",{className:styles.inputGroup},React.createElement(ResultMessage,{customBgImg:CheckSuccessImg,title:e("core.signMessage.successTitle")}),React.createElement("div",{className:styles.inputGroup},React.createElement(Flex,{justifyContent:"space-between",alignItems:"center"},React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"result-message-signature-label"},e("core.signMessage.signature")),renderCopyToClipboard({text:n.signature,handleCopy:R,t:e,testId:"signature-copy-to-clipboard-button"})),React.createElement(TextArea,{value:n.signature,dataTestId:"sign-message-signature",rows:4,className:styles.customTextArea})),React.createElement("div",{className:styles.inputGroup},React.createElement(Flex,{justifyContent:"space-between",alignItems:"center"},React.createElement(Text.Body.Normal,{weight:"$medium","data-testid":"result-message-key-label"},e("core.signMessage.key")),renderCopyToClipboard({text:n.key,handleCopy:R,t:e,testId:"public-key-copy-to-clipboard-button"})),React.createElement(TextArea,{value:n.key,dataTestId:"sign-message-key",rows:4,className:styles.customTextArea})));const renderHardwareSigningError=()=>React.createElement(Flex,{flexDirection:"column",alignItems:"center",gap:"$16",justifyContent:"center",className:styles.hardwareErrorContainer},React.createElement(ResultMessage,{fullWidth:true,status:"error",title:React.createElement("div",{"data-testid":"sign-message-error-title"},e("browserView.transaction.fail.oopsSomethingWentWrong")),description:React.createElement(React.Fragment,null,React.createElement("div",{"data-testid":"sign-message-error-description"},e("browserView.transaction.fail.problemSubmittingYourTransaction")),React.createElement("div",{"data-testid":"sign-message-error-description2",className:styles.message},e("browserView.transaction.fail.clickBackAndTryAgain")),"object"==typeof r&&r.message&&React.createElement(Box,{w:"$fill"},React.createElement(SummaryExpander,{onClick:()=>T(!C),open:C,title:e("browserView.transaction.fail.error-details.label"),plain:true},React.createElement(TransactionSummary.Other,{label:r.name||e("browserView.transaction.fail.error-details.error-name-fallback"),text:r.message}))))}));useAutoFocus(O,y);const renderContent=()=>{if(a){return React.createElement(MainLoader,null)}if(n){return renderSignature()}if(y){return renderPasswordPrompt()}if(b){return renderHardwareSigningError()}return renderInitialState()};return React.createElement("div",{"data-testid":"sign-message",className:styles.container},renderContent())}},"./src/views/browser-view/features/staking/components/StakeFundsBanner/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/classnames/index.js");var o=s("../../node_modules/react-i18next/dist/es/index.js");var r=s("./src/assets/images/start_staking_bg.png");var i=s("./src/assets/images/start_staking_bg_popup.png");var l=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var v=s.n(m);var p=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var g=s.n(p);var w=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var S=s.n(w);var y=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var f=s.n(y);var b=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakeFundsBanner/StakeFundsBanner.module.scss");var E={};E.styleTagTransform=f();E.setAttributes=g();E.insert=v().bind(null,"head");E.domAPI=u();E.insertStyleElement=S();var C=c()(b["default"],E);const T=b["default"]&&b["default"].locals?b["default"].locals:void 0;var k=s("./src/stores/index.ts");const StakeFundsBanner=({balance:e,popupView:t})=>{const{t:s}=useTranslation();const{walletUI:{cardanoCoin:a}}=useWalletStore();return React.createElement("div",{className:cn(styles.container,{[styles.popupView]:t})},React.createElement("img",{className:styles.bg,src:t?bgPopup:BG}),React.createElement("div",{className:styles.content},React.createElement("div",{className:styles.title},s("browserView.staking.stakingInfo.StakeFundsBanner.title")),React.createElement("div",{className:styles.description},s("browserView.staking.stakingInfo.StakeFundsBanner.description"))),React.createElement("div",{className:styles.content},React.createElement("div",{className:styles.balanceTitle},s("browserView.staking.stakingInfo.StakeFundsBanner.balanceTitle")),React.createElement("div",{className:styles.balance},React.createElement("span",null,e),React.createElement("span",{className:styles.currency},a.symbol))))}},"./src/views/browser-view/features/staking/components/StakePoolDetails/index.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../packages/common/dist/index.esm.js");var o=s("./src/views/browser-view/features/staking/store/index.ts");var r=s("./src/views/browser-view/features/staking/types/index.ts");var i=s("./src/stores/index.ts");var l=s("./src/views/browser-view/features/send-transaction/index.ts");var c=s("./src/features/delegation/stores/index.ts");var d=s("../../node_modules/react-i18next/dist/es/index.js");var u=s("./src/providers/index.ts");var m=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var v=s("../../packages/core/dist/index.esm.js");const StakePoolDetailsDrawer_StakePoolDetailsDrawer=({children:e,footer:t,popupView:s,showCloseIcon:a,showBackIcon:n,showExitConfirmation:o})=>{const{setExitStakingVisible:r,isDrawerVisible:i,setIsDrawerVisible:l,setSection:c,setPrevSection:d,simpleSendConfig:u,resetStates:m}=useStakePoolDetails();const{t:v}=useTranslation();const{setIsRestaking:p}=useSubmitingState();const{isInMemoryWallet:g}=useWalletStore();const{clearSecrets:w}=useSecrets();const{setDelegationTxBuilder:S}=useDelegationStore();const y=useAnalyticsContext();const f=useCallback(()=>{if(null==o?void 0:o(u.currentSection))r(true);else{S();m();w();l(false)}p(false);if(u.currentSection===Sections.SUCCESS_TX)y.sendEventToPostHog(PostHogAction.StakingManageDelegationHurrayXClick);if(u.currentSection===Sections.FAIL_TX)y.sendEventToPostHog(PostHogAction.StakingManageDelegationSomethingWentWrongXClick)},[o,u.currentSection,r,S,m,w,l,p,y]);const b=useCallback(()=>{w();if(u.currentSection===Sections.CONFIRMATION&&!g){return c(sectionsConfig[Sections.DETAIL])}if(null==u?void 0:u.prevSection){return d()}return f()},[f,g,w,d,c,u.currentSection,null==u?void 0:u.prevSection]);useKeyboardShortcut(["Escape"],()=>{if("function"==typeof n?n(u.currentSection):n)b();else f()});return React.createElement(Drawer,{visible:i,destroyOnClose:true,onClose:f,navigation:React.createElement(DrawerNavigation,{title:v(Sections.DETAIL===u.currentSection?"browserView.staking.details.title":"browserView.staking.details.titleSecond"),onArrowIconClick:("function"==typeof n?n(u.currentSection):n)?b:void 0,onCloseIconClick:("function"==typeof a?a(u.currentSection):a)?f:void 0}),footer:t,popupView:s},i&&e)};var p=s("../../node_modules/classnames/index.js");var g=s("../../packages/cardano/dist/index.esm.js");var w=s("./src/hooks/index.ts");var S=s("./src/views/browser-view/components/index.ts");var y=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var f=s.n(y);var b=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var E=s.n(b);var C=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var T=s.n(C);var k=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var h=s.n(k);var R=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var A=s.n(R);var x=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var P=s.n(x);var I=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakePoolDetails/StakePoolDetail.module.scss");var _={};_.styleTagTransform=P();_.setAttributes=h();_.insert=T().bind(null,"head");_.domAPI=E();_.insertStyleElement=A();var D=f()(I["default"],_);const N=I["default"]&&I["default"].locals?I["default"].locals:void 0;var B=s("../../packages/staking/dist/index.js");function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const O=null;const StakePoolDetail_StakePoolDetail=({popupView:e,setIsStaking:t})=>{const{delegators:s,description:a,id:n,hexId:o,owners:r=[],ros:i,saturation:l,activeStake:c,liveStake:d,logo:u,name:m,ticker:v,status:p,contact:g,blocks:w,fee:S,pledge:y,margin:f}=useDelegationStore(stakePoolDetailsSelector)||{};const b=useDelegationDetails();const{walletUI:{cardanoCoin:E}}=useWalletStore();const C=b&&Wallet.util.stakePoolTransformer({stakePool:b,cardanoCoin:E});const{t:T}=useTranslation();const k=[{name:SocialNetwork.RSS_FEED,href:null==g?void 0:g.feed},{name:SocialNetwork.WEBSITE,href:null==g?void 0:g.primary},{name:SocialNetwork.FACEBOOK,href:null==g?void 0:g.facebook},{name:SocialNetwork.TELEGRAM,href:null==g?void 0:g.telegram},{name:SocialNetwork.GITHUB,href:null==g?void 0:g.github},{name:SocialNetwork.TWITTER,href:null==g?void 0:g.twitter}];const h=(null==C?void 0:C.id)===n;useEffect(()=>{t(h)},[t,h]);const R={activeStake:T("cardano.stakePoolMetricsBrowser.activeStake"),liveStake:T("cardano.stakePoolMetricsBrowser.liveStake"),saturation:T("cardano.stakePoolMetricsBrowser.saturation"),delegators:T("cardano.stakePoolMetricsBrowser.delegators"),ros:T("cardano.stakePoolMetricsBrowser.ros"),blocks:T("cardano.stakePoolMetricsBrowser.blocks"),cost:T("cardano.stakePoolMetricsBrowser.cost"),margin:T("cardano.stakePoolMetricsBrowser.margin"),pledge:T("cardano.stakePoolMetricsBrowser.pledge")};const A={delegating:T("cardano.stakePoolStatusLogo.delegating"),saturated:T("cardano.stakePoolStatusLogo.saturated"),retiring:T("cardano.stakePoolStatusLogo.retiring"),retired:T("cardano.stakePoolStatusLogo.retired")};const x=getNumberWithUnit(y);const P=getNumberWithUnit(S);const I=useMemo(()=>{const t=[{t:R.activeStake,testId:"active-stake",unit:null==c?void 0:c.unit,value:null==c?void 0:c.number},{t:R.liveStake,testId:"live-stake",unit:null==d?void 0:d.unit,value:null==d?void 0:d.number},{t:R.delegators,testId:"delegators",value:s},{t:R.ros,testId:"ros",unit:"%",value:i},{t:R.blocks,testId:"blocks",value:w},{t:R.cost,testId:"cost",unit:null==P?void 0:P.unit,value:null==P?void 0:P.number},{t:R.pledge,testId:"pledge",unit:null==x?void 0:x.unit,value:null==x?void 0:x.number},{t:R.margin,testId:"margin",unit:"%",value:f}];if(e)t.push({t:R.saturation,testId:"saturation",unit:"%",value:l});return t},[c.number,c.unit,i,w,s,P.number,P.unit,x.number,x.unit,d.number,d.unit,f,R.activeStake,R.blocks,R.cost,R.delegators,R.liveStake,R.margin,R.pledge,R.ros,R.saturation,e,l]);return React.createElement(React.Fragment,null,React.createElement("div",{className:cn(styles.contentWrapper,styles.nameWrapper,{[styles.popupView]:e})},React.createElement(StakePoolNameBrowser,_extends({},{logo:u,name:m,ticker:v,id:n,status:p,isDelegated:h,isOversaturated:void 0!==l&&isOversaturated(Number(l))},{translations:A})),!e&&React.createElement("div",{className:styles.saturationContainer},React.createElement("div",{className:styles.saturationTitle,"data-testid":"saturation-title"},R.saturation),React.createElement("div",{className:styles.saturationProgressContainer},React.createElement("div",{className:styles.saturationProgress},React.createElement(StakePoolCardProgressBar,{percentage:l}))))),React.createElement("div",{className:cn(styles.container,{[styles.popupView]:e}),"data-testid":"stake-pool-details"},React.createElement("div",{className:cn(styles.contentWrapper,{[styles.popupView]:e})},React.createElement("div",{className:styles.row},React.createElement("div",{className:styles.title,"data-testid":"stake-pool-details-title"},T("browserView.staking.details.statistics.title")),React.createElement(StakePoolMetricsBrowser,{popupView:e,data:I})),h&&React.createElement(Banner,{className:styles.banner,withIcon:true,message:T("browserView.staking.details.unstakingIsNotYetAvailableFollowTheseStepsIfYouWishToChangeStakePool"),description:React.createElement("ul",{className:styles.descriptionList},O.map((e,t)=>React.createElement("li",{key:`list-item-${t}`},T(e))))}),React.createElement("div",{className:styles.row,"data-testid":"stake-pool-details-information"},React.createElement("div",{className:styles.title,style:{marginBottom:"24px"},"data-testid":"stake-pool-details-information-title"},T("browserView.staking.details.information.title")),React.createElement("div",{className:styles.body,"data-testid":"stake-pool-details-information-description"},a)),k.some(e=>e.href)&&React.createElement("div",{className:styles.row,style:{marginBottom:"5px"},"data-testid":"stake-pool-details-social"},React.createElement("div",{className:styles.title,style:{marginBottom:"24px"},"data-testid":"stake-pool-details-social-title"},T("browserView.staking.details.social.title")),React.createElement("div",{className:styles.social,"data-testid":"stake-pool-details-social-icons"},k.map(e=>e.href&&React.createElement(SocialNetworkIcon,_extends({key:e.name},e))))),React.createElement("div",{className:styles.row,"data-testid":"stake-pool-details-pool-ids"},React.createElement("div",{className:styles.title,"data-testid":"stake-pool-details-pool-ids-title"},T("browserView.staking.details.poolIds.title")),React.createElement("div",null,React.createElement("div",{className:styles.id,"data-testid":"stake-pool-details-pool-id"},n),React.createElement("div",{className:styles.id,"data-testid":"stake-pool-details-pool-id-hex"},o))),React.createElement("div",{className:styles.row,style:{marginBottom:"40px"},"data-testid":"stake-pool-details-owners"},React.createElement("div",{className:styles.title,"data-testid":"stake-pool-details-owners-title"},`${T("browserView.staking.details.owners.title")} (${r.length})`),r.map(e=>React.createElement("div",{key:e.toString(),className:styles.owner,"data-testid":"stake-pool-details-owner"},React.createElement("span",{className:styles.ownerAddress},React.createElement(Ellipsis,{text:e.toString(),textClassName:styles.addressEllipsis,className:styles.addressEllipsisParent,ellipsisInTheMiddle:true}))))))))};const StakePoolDetail_StakePoolDetailFooter=({onStake:e,canDelegate:t,popupView:s})=>{const{t:a}=useTranslation();const{setNoFundsVisible:n}=useStakePoolDetails();const{id:o}=useDelegationStore(stakePoolDetailsSelector)||{};const{walletUI:{cardanoCoin:r},isInMemoryWallet:i}=useWalletStore();const l=useAnalyticsContext();const c=useCallback(()=>{if(t){l.sendEventToPostHog(PostHogAction.StakingStakePoolDetailStakeOnThisPoolClick);e()}else{n(true)}},[l,t,e,n]);const d=useDelegationDetails();const u=d&&Wallet.util.stakePoolTransformer({stakePool:d,cardanoCoin:r});const m=(null==u?void 0:u.id)===o;useEffect(()=>{if(i)return;if(s)return;const e=!!localStorage.getItem("TEMP_POOLID");if(!e)return;c();localStorage.removeItem("TEMP_POOLID")},[i,c,s]);return React.createElement("div",{className:cn(styles.footer,{[styles.popupView]:s})},!m&&React.createElement(Button,{"data-testid":"stake-pool-details-stake-btn",onClick:c,className:styles.stakeBtn},React.createElement("span",null,a("browserView.staking.details.stakeButtonText"))))};var j=s("../../node_modules/lodash/isNil.js");var V=s("./src/assets/images/cardano-blue-bg.png");var W=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakePoolDetails/StakePoolConfirmation.module.scss");var M={};M.styleTagTransform=P();M.setAttributes=h();M.insert=T().bind(null,"head");M.domAPI=E();M.insertStyleElement=A();var L=f()(W["default"],M);const F=W["default"]&&W["default"].locals?W["default"].locals:void 0;var H=s("./src/assets/icons/arrow-down.component.svg");var $=s("./src/views/browser-view/features/staking/hooks.ts");var U=s("./src/lib/scripts/types/index.ts");var K=s("./src/components/ContinueInBrowserDialog/index.ts");var G=s("./src/providers/BackgroundServiceAPI/index.ts");var q=s("./src/assets/icons/exclamation-circle-small.svg");const StakePoolConfirmation_StakePoolConfirmation=({popupView:e})=>{var t,s,a,n,o,r;const{t:i}=useTranslation();const{stakingError:l}=useStakePoolDetails();const{inMemoryWallet:c,walletUI:{cardanoCoin:d}}=useWalletStore();const{priceResult:u}=useFetchCoinPrice();const{balance:m}=useBalances(null==u?void 0:null===(t=u.cardano)||void 0===t?void 0:t.price);const{delegationTxFee:v}=useDelegationStore();const{buildDelegation:p}=useBuildDelegation();useEffect(()=>{p()},[p]);const{logo:g,id:w,ticker:S,name:y}=useDelegationStore(stakePoolDetailsSelector)||{};const{fiatCurrency:f}=useCurrencyStore();const b=useMemo(()=>y||(e?"-":y),[y,e]);const E=useObservable(null==c?void 0:c.protocolParameters$);const C=useObservable(c.delegation.rewardAccounts$);const T=C&&(null===(s=C[0])||void 0===s?void 0:s.credentialStatus)!==Wallet.Cardano.StakeCredentialStatus.Registered?null==E?void 0:E.stakeKeyDeposit:void 0;const k={[StakingErrorType.UTXO_FULLY_DEPLETED]:i("browserView.staking.details.errors.utxoFullyDepleted"),[StakingErrorType.UTXO_BALANCE_INSUFFICIENT]:i("browserView.staking.details.errors.utxoBalanceInsufficient")};const ItemStatRenderer=({img:e,text:t,subText:s})=>React.createElement("div",null,e&&React.createElement("img",{"data-testid":"sp-confirmation-item-logo",src:e,alt:"confirmation item"}),React.createElement("div",{className:styles.itemData},React.createElement("div",{className:styles.dataTitle,"data-testid":"sp-confirmation-item-text"},t),React.createElement("div",{className:styles.dataSubTitle,"data-testid":"sp-confirmation-item-subtext"},s)));const h=isNil(c.protocolParameters$)||isNil(c.delegation.rewardAccounts$);const R=React.createElement(Ellipsis,{beforeEllipsis:10,afterEllipsis:8,text:w,ellipsisInTheMiddle:!e});var A;return React.createElement(React.Fragment,null,React.createElement("div",{className:cn(styles.header,{[styles.popupView]:e})},React.createElement("div",{"data-testid":"staking-confirmation-title",className:styles.title},i("browserView.staking.details.confirmation.title")),React.createElement("div",{"data-testid":"staking-confirmation-subtitle",className:styles.subTitle},i("browserView.staking.details.confirmation.subTitle"))),l&&l.type!==StakingErrorType.REWARDS_LOCKED&&React.createElement("div",null,React.createElement(Banner,{customIcon:ExclamationMarkIcon,withIcon:true,message:k[l.type]})),React.createElement("div",{className:cn(styles.container,{[styles.popupView]:e}),"data-testid":"sp-confirmation-container"},React.createElement(Skeleton,{loading:h},React.createElement("div",{className:cn(styles.body,{[styles.popupView]:e})},React.createElement("div",{className:styles.item,"data-testid":"sp-confirmation-delegate-from-container"},React.createElement(ItemStatRenderer,{img:Cardano,text:i("browserView.staking.details.confirmation.cardanoName"),subText:d.symbol}),React.createElement(ItemStatRenderer,{text:null==m?void 0:null===(a=m.total)||void 0===a?void 0:a.coinBalance,subText:`${null!==(A=null==m?void 0:null===(n=m.total)||void 0===n?void 0:n.fiatBalance)&&void 0!==A?A:"-"} ${null==f?void 0:f.code}`})),React.createElement(Icon,{style:{fontSize:"24px",color:"#702BED",margin:e?"initial":"12px 0px"},component:ArrowDown}),React.createElement("div",{className:styles.item,"data-testid":"sp-confirmation-delegate-to-container"},React.createElement(ItemStatRenderer,{img:g,text:b,subText:React.createElement(React.Fragment,null,React.createElement("span",null,S),e&&React.createElement("span",null,R))}),React.createElement("div",{className:styles.itemData},e?React.createElement(React.Fragment,null):R))),e&&React.createElement("div",{className:styles.divider}),React.createElement("h1",{className:styles.totalCostTitle},i("browserView.staking.details.confirmation.transactionCost.title")),React.createElement("div",{className:styles.txCostContainer,"data-testid":"summary-fee-container"},T&&React.createElement(RowContainer,null,renderLabel({label:i("staking.confirmation.stakingDeposit"),dataTestId:"sp-confirmation-staking-deposit",tooltipContent:i("staking.confirmation.theAmountYoullBeChargedForRegisteringYourStakeKey")}),React.createElement("div",null,renderAmountInfo(Wallet.util.getFormattedAmount({amount:T.toString(),cardanoCoin:d}),`${Wallet.util.convertAdaToFiat({ada:Wallet.util.lovelacesToAdaString(T.toString()),fiat:(null==u?void 0:null===(o=u.cardano)||void 0===o?void 0:o.price)||0})} ${null==f?void 0:f.symbol}`))),React.createElement(RowContainer,null,renderLabel({label:i("staking.confirmation.transactionFee"),dataTestId:"sp-confirmation-staking-fee",tooltipContent:i("send.theAmountYoullBeChargedToProcessYourTransaction")}),React.createElement("div",null,renderAmountInfo(Wallet.util.getFormattedAmount({amount:v,cardanoCoin:d}),`${Wallet.util.convertAdaToFiat({ada:Wallet.util.lovelacesToAdaString(v),fiat:(null==u?void 0:null===(r=u.cardano)||void 0===r?void 0:r.price)||0})} ${null==f?void 0:f.symbol}`)))))))};const StakePoolConfirmation_StakePoolConfirmationFooter=({popupView:e})=>{const{t}=useTranslation();const{isBuildingTx:s,stakingError:a}=useStakePoolDetails();const[n,o]=useState(false);const{isInMemoryWallet:r,inMemoryWallet:i,walletType:l}=useWalletStore();const c=useAnalyticsContext();const{setIsRestaking:d}=useSubmitingState();const u=useObservable(i.delegation.rewardAccounts$);const m=useDelegationDetails();const[v,p]=useState(false);const g=useCallback(()=>p(!v),[v]);const w=useBackgroundServiceAPIContext();const S=useCallback(({poolId:e})=>{localStorage.setItem("TEMP_POOLID",e);return w.handleOpenBrowser({section:BrowserViewSections.STAKING})},[w]);const{setSection:y}=useStakePoolDetails();const{id:f}=useDelegationStore(stakePoolDetailsSelector);const{signAndSubmitTransaction:b}=useDelegationTransaction();const E=useCallback(()=>{c.sendEventToPostHog(PostHogAction.StakingManageDelegationStakePoolConfirmationNextClick)},[c]);const C=useCallback(async()=>{E();o(false);if(!r){o(true);try{if(e)return g();await b();const t=!!(u&&m);d(t);return y(sectionsConfig[Sections.SUCCESS_TX])}catch{return y(sectionsConfig[Sections.FAIL_TX])}finally{o(false)}}return y(sectionsConfig[Sections.SIGN])},[E,r,y,e,g,b,d,u,m]);const T=useMemo(()=>{if(!r){const s=e?t("browserView.staking.details.confirmation.button.continueInAdvancedView"):t("browserView.staking.details.confirmation.button.confirmWithDevice",{hardwareWallet:l});return n?t("browserView.staking.details.confirmation.button.signing"):s}return e?t("staking.details.confirmation.button.confirm"):t("browserView.staking.details.confirmation.button.confirm")},[n,r,t,e,l]);return React.createElement(React.Fragment,null,React.createElement(ContinueInBrowserDialog,{visible:v,onConfirm:()=>S({poolId:f}),onClose:g,title:t("browserView.onboarding.hardwareWalletStakingTransition.title"),description:t("browserView.onboarding.hardwareWalletStakingTransition.description"),okLabel:t("browserView.onboarding.hardwareWalletStakingTransition.ok"),cancelLabel:t("browserView.onboarding.hardwareWalletStakingTransition.cancel")}),React.createElement("div",{className:cn({[styles.popupView]:e})},React.createElement("div",{className:styles.actions},React.createElement(Button,{"data-testid":"stake-pool-confirmation-btn",disabled:s||!!a,loading:n||s,onClick:C,className:styles.confirmBtn,size:"large"},T))))};var Y=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakePoolDetails/SignConfirmation.module.scss");var z={};z.styleTagTransform=P();z.setAttributes=h();z.insert=T().bind(null,"head");z.domAPI=E();z.insertStyleElement=A();var X=f()(Y["default"],z);const Q=Y["default"]&&Y["default"].locals?Y["default"].locals:void 0;const J=null;const SignConfirmation_SignConfirmation=({popupView:e})=>{const{t}=useTranslation();const{setPassword:s}=useSecrets();const{isPasswordValid:a}=useSubmitingState();const handleChange=e=>s(e);useAutoFocus(J,true);return React.createElement(React.Fragment,null,React.createElement("div",{className:cn(styles.header,{[styles.popupView]:e})},React.createElement("div",{className:styles.title,"data-testid":"staking-confirmation-title"},t("browserView.staking.details.confirmation.title")),React.createElement("div",{className:styles.subTitle,"data-testid":"staking-confirmation-subtitle"},t("browserView.transaction.send.enterWalletPasswordToConfirmTransaction"))),React.createElement("div",{className:cn(styles.container,{[styles.popupView]:e})},React.createElement("div",{className:styles.password},React.createElement(Password,{className:styles.passwordInput,onChange:handleChange,error:false===a,errorMessage:t("browserView.transaction.send.error.invalidPassword"),label:t("browserView.transaction.send.password.placeholder"),id:J,autoFocus:true}))))};const SignConfirmation_SignConfirmationFooter=()=>{const{t:e}=useTranslation();const{password:t,clearSecrets:s}=useSecrets();const{signAndSubmitTransaction:a}=useDelegationTransaction();const{setSubmitingTxState:n,isSubmitingTx:o,setIsRestaking:r}=useSubmitingState();const{setSection:i}=useStakePoolDetails();const l=useAnalyticsContext();const{inMemoryWallet:c}=useWalletStore();const d=useObservable(c.delegation.rewardAccounts$);const u=useDelegationDetails();const m=!!(d&&u);const v=o||!t.value;const p=useCallback(()=>{s()},[s]);const g=useCallback(()=>{l.sendEventToPostHog(PostHogAction.StakingManageDelegationPasswordConfirmationConfirmClick)},[l]);const w=useCallback(async()=>{n({isPasswordValid:true,isSubmitingTx:true});try{await a();p();g();r(m);i(sectionsConfig[Sections.SUCCESS_TX]);n({isPasswordValid:true,isSubmitingTx:false})}catch(t){var e;if(null===(e=t.message)||void 0===e?void 0:e.includes("Authentication failure"))n({isPasswordValid:false,isSubmitingTx:false});else{i(sectionsConfig[Sections.FAIL_TX]);n({isSubmitingTx:false})}}},[n,a,p,g,i,r,m]);return React.createElement("div",{className:styles.footer},React.createElement(Button,{"data-testid":"stake-sign-confirmation-btn",onClick:w,disabled:v,loading:o,className:styles.confirmBtn,size:"large"},e("general.button.confirm")))};var Z=s("./src/components/ResultMessage/index.ts");var ee=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakePoolDetails/TransactionComplete.module.scss");var et={};et.styleTagTransform=P();et.setAttributes=h();et.insert=T().bind(null,"head");et.domAPI=E();et.insertStyleElement=A();var es=f()(ee["default"],et);const ea=ee["default"]&&ee["default"].locals?ee["default"].locals:void 0;var en=s("./src/assets/icons/success-staking.svg");const TransactionSuccess_TransactionSuccess=({popupView:e})=>{const{t}=useTranslation();const{isRestaking:s}=useSubmitingState();const a=useAnalyticsContext();useEffect(()=>{a.sendEventToPostHog(PostHogAction.StakingManageDelegationHurrayView)},[]);return React.createElement("div",{className:cn(styles.container,{[styles.popupView]:e})},React.createElement(ResultMessage,{customBgImg:Success,title:t(s?"browserView.staking.details.switchedPools.title":"browserView.staking.details.success.title"),description:t(s?"browserView.staking.details.switchedPools.subTitle":"browserView.staking.details.success.subTitle")}))};const TransactionSuccess_TransactionSuccessFooter=()=>{const{t:e}=useTranslation();const{setIsDrawerVisible:t,resetStates:s}=useStakePoolDetails();const{setDelegationTxBuilder:a}=useDelegationStore();const n=useAnalyticsContext();const{isInMemoryWallet:o}=useWalletStore();const closeDrawer=()=>{n.sendEventToPostHog(PostHogAction.StakingManageDelegationHurrayCloseClick);a();t(false);s();if(!o)window.location.reload()};return React.createElement("div",{className:styles.footer},React.createElement(Button,{onClick:()=>closeDrawer(),className:styles.confirmBtn,size:"large","data-testid":"transaction-success-footer-close-button"},e("general.button.close")))};var eo=s("./src/assets/images/Exclamation.png");const TransactionFail_TransactionFail=({popupView:e})=>{const{t}=useTranslation();return React.createElement("div",{className:cn(styles.container,styles.fail,{[styles.popupView]:e})},React.createElement("div",{className:styles.containerFail},React.createElement(ResultMessage,{customBgImg:e?Exclamation:void 0,status:"error",title:t("browserView.staking.details.fail.title"),description:t("browserView.staking.details.fail.subTitle")})))};const TransactionFail_TransactionFailFooter=({popupView:e})=>{const{t}=useTranslation();const[s,a]=useState(false);const{setIsDrawerVisible:n,resetStates:o,setSection:r}=useStakePoolDetails();const{setDelegationTxBuilder:i}=useDelegationStore();const{clearSecrets:l}=useSecrets();const c=useAnalyticsContext();const closeDrawer=()=>{c.sendEventToPostHog(PostHogAction.StakingManageDelegationSomethingWentWrongCancelClick);i();n(false);o()};const{signAndSubmitTransaction:d}=useDelegationTransaction();const onSubmit=async()=>{a(true);try{await d();a(false);r(sectionsConfig[Sections.SUCCESS_TX]);l()}catch(e){logger.error("failed to sign or submit tx due to:",e);a(false)}};return React.createElement("div",{className:styles.footerFail},React.createElement(Button,{onClick:()=>{c.sendEventToPostHog(PostHogAction.StakingManageDelegationSomethingWentWrongCancelClick);closeDrawer()},color:"secondary",className:styles.btn,size:"large","data-testid":"staking-fail-close-button"},t("browserView.staking.details.fail.btn.close")),e?React.createElement(Button,{onClick:()=>{c.sendEventToPostHog(PostHogAction.StakingManageDelegationSomethingWentWrongBackClick);r(sectionsConfig[sectionsConfig.fail_tx.prevSection])},color:"primary",className:styles.btn,size:"large"},t("browserView.staking.details.fail.btn.back")):React.createElement(Button,{onClick:onSubmit,className:styles.btn,size:"large",loading:s,disabled:s,"data-testid":"staking-fail-retry-button"},t("browserView.staking.details.fail.btn.retry")))};const StakePoolDetails=({onStake:e,canDelegate:t,popupView:s,showCloseIcon:a,showBackIcon:n,showExitConfirmation:o})=>{const{inMemoryWallet:r}=useWalletStore();const i=useObservable(r.transactions.outgoing.inFlight$);const{simpleSendConfig:l}=useStakePoolDetails();const[c,d]=useState();const u=null==i?void 0:i.some(({body:e})=>{var t;return(null==e?void 0:null===(t=e.certificates)||void 0===t?void 0:t.length)>0});const m=useMemo(()=>({[Sections.DETAIL]:React.createElement(StakePoolDetail,{setIsStaking:e=>d(e),popupView:s}),[Sections.CONFIRMATION]:React.createElement(StakePoolConfirmation,{popupView:s}),[Sections.SIGN]:React.createElement(SignConfirmation,{popupView:s}),[Sections.SUCCESS_TX]:React.createElement(TransactionSuccess,{popupView:s}),[Sections.FAIL_TX]:React.createElement(TransactionFail,{popupView:s})}),[s]);const v=useMemo(()=>({[Sections.DETAIL]:React.createElement(StakePoolDetailFooter,{popupView:s,canDelegate:t,onStake:e}),[Sections.CONFIRMATION]:React.createElement(StakePoolConfirmationFooter,{popupView:s}),[Sections.SIGN]:React.createElement(SignConfirmationFooter,null),[Sections.SUCCESS_TX]:React.createElement(TransactionSuccessFooter,null),[Sections.FAIL_TX]:React.createElement(TransactionFailFooter,{popupView:s})}),[e,t,s]);const p=useMemo(()=>m[l.currentSection],[l,m]);const g=c||u&&l.currentSection===Sections.DETAIL?void 0:v[l.currentSection];return React.createElement(StakePoolDetailsDrawer,{showExitConfirmation:o,showCloseIcon:a,showBackIcon:n,popupView:s,footer:g},p)}},"./src/views/browser-view/features/staking/components/StakingInfo/index.ts":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/classnames/index.js");var o=s("../../node_modules/react-i18next/dist/es/index.js");var r=s("../../packages/cardano/dist/index.esm.js");var i=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var y=s.n(S);var f=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakingInfo/StakingInfo.module.scss");var b={};b.styleTagTransform=y();b.setAttributes=p();b.insert=m().bind(null,"head");b.domAPI=d();b.insertStyleElement=w();var E=l()(f["default"],b);const C=f["default"]&&f["default"].locals?f["default"].locals:void 0;var T=s("../../packages/common/dist/index.esm.js");var k=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakingInfo/StakePoolInfo.module.scss");var h={};h.styleTagTransform=y();h.setAttributes=p();h.insert=m().bind(null,"head");h.domAPI=d();h.insertStyleElement=w();var R=l()(k["default"],h);const A=k["default"]&&k["default"].locals?k["default"].locals:void 0;const StakePoolInfo_StakePoolInfo=({logo:e,name:t,ticker:s,id:a,onClick:n,popupView:o})=>{var r;const i=null!==(r=null!=t?t:s)&&void 0!==r?r:"-";const l=null!=s?s:React.createElement(Ellipsis,{className:styles.id,text:a,beforeEllipsis:6,afterEllipsis:8});return React.createElement("div",{"data-testid":"staking-pool-info",onClick:n,className:cn(styles.stakePool,{[styles.popupView]:o})},React.createElement("img",{className:styles.logo,src:e,alt:"pool-logo","data-testid":"stake-pool-logo"}),React.createElement("div",{className:styles.body},React.createElement("div",{className:styles.title,"data-testid":"stake-pool-name"},React.createElement("div",null,i)),React.createElement("div",{className:styles.subTitle,"data-testid":"stake-pool-ticker"},React.createElement("div",null,l))))};var x=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakingInfo/Stats.module.scss");var P={};P.styleTagTransform=y();P.setAttributes=p();P.insert=m().bind(null,"head");P.domAPI=d();P.insertStyleElement=w();var I=l()(x["default"],P);const _=x["default"]&&x["default"].locals?x["default"].locals:void 0;const Stats_Stats=({text:e,value:t="-",popupView:s,dataTestid:a})=>React.createElement("div",{"data-testid":`${a}-container`,className:cn(styles.stat,{[styles.popupView]:s})},React.createElement("div",{"data-testid":"stats-title",className:styles.title},e),React.createElement("div",{"data-testid":"stats-value",className:styles.value},t));const StatsTooltip_Tooltip=({title:e,content:t,children:s})=>{const{t:a}=useTranslation();return React.createElement(AntdTooltip,{placement:"top",className:styles.tooltipWrapper,title:t||React.createElement("div",{"data-testid":"tooltip"},React.createElement("div",null,a("browserView.staking.stakingInfo.tooltip.title")),React.createElement("div",null,e))},s)};var D=s("./src/utils/format-number.ts");const formatNumericValue=(e,t)=>React.createElement(React.Fragment,null,e?formatLocaleNumber(String(e)):"-",void 0!==e&&React.createElement("span",{className:styles.suffix},t));const StakingInfo=({className:e,coinBalance:t,fee:s,fiat:a,id:n,logo:o,margin:r,name:i,totalRewards:l,lastReward:c,ros:d,ticker:u,rewardAccount:m,onStakePoolSelect:v,popupView:p,cardanoCoin:g})=>{const{t:w}=useTranslation();const S=useRef();return React.createElement("div",{ref:S,"data-testid":"staking-info-container",className:cn(styles.stakingInfo,{[styles.popupView]:p})},React.createElement("div",{className:styles.header,"data-testid":"staking-info-title"},w("browserView.staking.stakingInfo.title")),React.createElement("div",{className:cn(styles.panel,{className:e})},React.createElement("div",{className:styles.row},React.createElement("div",{className:styles.col},React.createElement(StakePoolInfo,{logo:null!=o?o:getRandomIcon({id:n.toString(),size:30}),name:i,ticker:u,id:n,onClick:v,popupView:true})),React.createElement("div",{className:cn(styles.col,styles.justifyContentSpaceAround)},React.createElement(Stats,{text:w("browserView.staking.stakingInfo.stats.ros"),value:formatNumericValue(d,"%"),popupView:true,dataTestid:"stats-ros"}),React.createElement(Stats,{text:w("browserView.staking.stakingInfo.stats.Fee"),value:formatNumericValue(s,g.symbol),popupView:true,dataTestid:"stats-fee"}),React.createElement(Stats,{text:w("browserView.staking.stakingInfo.stats.Margin"),value:formatNumericValue(r,"%"),popupView:true,dataTestid:"stats-margin"}))),React.createElement("div",{className:styles.row},React.createElement("div",{className:styles.col},t&&React.createElement(Stats,{text:w("browserView.staking.stakingInfo.totalStaked.title"),value:React.createElement(Tooltip,{title:Wallet.util.convertAdaToFiat({ada:t.toString(),fiat:a})},React.createElement("span",null,t),React.createElement("span",{className:styles.suffix},g.symbol)),dataTestid:"stats-total-staked"})),!p&&React.createElement("div",{className:styles.col},React.createElement(Stats,{text:w("browserView.staking.stakingInfo.totalRewards.title"),value:React.createElement(Tooltip,{title:Wallet.util.convertAdaToFiat({ada:l.toString(),fiat:a})},React.createElement("span",null,l),React.createElement("span",{className:styles.suffix},g.symbol)),dataTestid:"stats-total-rewards"})),React.createElement("div",{className:styles.col},React.createElement(Stats,{text:w("browserView.staking.stakingInfo.lastReward.title"),value:React.createElement(Tooltip,{title:Wallet.util.convertAdaToFiat({ada:c.toString(),fiat:a})},React.createElement("span",null,c),React.createElement("span",{className:styles.suffix},g.symbol)),dataTestid:"stats-last-reward"}))),m&&React.createElement("div",{className:styles.row},React.createElement("div",{className:styles.col},React.createElement(Stats,{text:w("browserView.staking.stakingInfo.stats.stakeKey"),value:React.createElement(Tooltip,{content:m.address},React.createElement("div",{className:styles.colContent},p?addEllipsis(m.address,14,9):m.address)),dataTestid:"stats-stake-key"})))))}},"./src/views/browser-view/features/staking/components/StakingModals/StakingModal.module.scss":(e,t,s)=>{var a=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var n=s.n(a);var o=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var r=s.n(o);var i=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var p=s.n(v);var g=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/staking/components/StakingModals/StakingModal.module.scss");var w={};w.styleTagTransform=p();w.setAttributes=d();w.insert=l().bind(null,"head");w.domAPI=r();w.insertStyleElement=m();var S=n()(g["default"],w);var y=g["default"]&&g["default"].locals?g["default"].locals:void 0},"./src/views/browser-view/features/staking/components/StakingModals/StakingModal.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/classnames/index.js");var o=s.n(n);var r=s("../../packages/common/dist/index.esm.js");var i=s("./src/views/browser-view/features/staking/components/StakingModals/StakingModal.module.scss");var l=s("./src/views/browser-view/features/staking/store/index.ts");function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const c=312;const d=479;const StakingModal=({title:e,description:t,visible:s,actions:a,popupView:n})=>{const{setStakeConfirmationVisible:o,setExitStakingVisible:r,setNoFundsVisible:i}=useStakePoolDetails();const handleCancelModal=()=>{o(false);r(false);i(false)};return React.createElement(Modal,{destroyOnClose:true,centered:true,className:cn(styles.modal,{[styles.popupView]:n}),onCancel:handleCancelModal,footer:null,open:s,width:n?c:d},React.createElement("div",{"data-testid":"stake-modal-title",className:styles.header},e),React.createElement("div",{"data-testid":"stake-modal-description",className:styles.content},t),React.createElement("div",{"data-testid":"stake-modal-actions",className:styles.footer},a.map(({dataTestId:e,body:t,...s})=>React.createElement(Button,_extends({key:e,"data-testid":e},s,{block:true}),t))))}},"./src/views/browser-view/features/staking/components/StakingModals/StakingWarningModals.tsx":(e,t,s)=>{var a=s("../../node_modules/react/index.js");var n=s("../../node_modules/react-i18next/dist/es/index.js");var o=s("./src/stores/selectors/staking-selectors.ts");var r=s("./src/stores/index.ts");var i=s("./src/routes/wallet-paths.ts");var l=s("./src/hooks/index.ts");var c=s("../../packages/cardano/dist/index.esm.js");var d=s("./src/views/browser-view/features/staking/components/StakingModals/StakingModal.tsx");const u=100;const m="lastStaking";const StakingWarningModals=({popupView:e})=>{const{t}=useTranslation();const s=useHistory();const[a,n]=useState(false);const[o,r]=useState(false);const[i,{updateLocalStorage:l}]=useLocalStorage(m);const{networkInfo:c,fetchNetworkInfo:d}=useWalletStore(stakingInfoSelector);const{walletUI:{cardanoCoin:v}}=useWalletStore();useEffect(()=>{d()},[d]);const p=useDelegationDetails();const{saturation:g,retired:w,id:S}=p&&Wallet.util.stakePoolTransformer({stakePool:p,cardanoCoin:v})||{};useEffect(()=>{if(void 0!==p&&S!==(null==i?void 0:i.poolId))l({})},[S,l,null==i?void 0:i.poolId,null==i?void 0:i.epoch,p]);useEffect(()=>{if(!(null==c?void 0:c.currentEpoch)||!S||c.currentEpoch===(null==i?void 0:i.epoch))return;if(w){r(true);l({epoch:c.currentEpoch,poolId:S})}else if(Number(g)>u){n(true);l({epoch:c.currentEpoch,poolId:S})}},[g,w,l,null==c?void 0:c.currentEpoch,null==i?void 0:i.epoch,S]);return React.createElement(React.Fragment,null,React.createElement(StakingModal,{visible:a,title:t("browserView.staking.details.poolOversaturatedModal.title"),description:t("browserView.staking.details.poolOversaturatedModal.description"),actions:[{body:t("browserView.staking.details.poolOversaturatedModal.buttons.confirm"),dataTestId:"stake-oversaturated-modal-confirm",onClick:()=>{s.push(walletRoutePaths.staking);n(false)}}],popupView:e}),React.createElement(StakingModal,{visible:o,title:t("browserView.staking.details.poolRetiredModal.title"),description:t("browserView.staking.details.poolRetiredModal.description"),actions:[{body:t("browserView.staking.details.poolRetiredModal.buttons.confirm"),dataTestId:"stake-retired-modal-confirm",onClick:()=>{s.push(walletRoutePaths.staking);r(false)}}],popupView:e}))}},"./src/views/browser-view/features/staking/components/StakingModals/index.tsx":(e,t,s)=>{var a=s("./src/views/browser-view/features/staking/components/StakingModals/StakingModals.tsx");var n=s("./src/views/browser-view/features/staking/components/StakingModals/StakingWarningModals.tsx")},"./src/views/browser-view/features/staking/hooks.ts":(e,t,s)=>{s.d(t,{useRewardAccountsData:()=>useRewardAccountsData});var a=s("../../node_modules/react/index.js");var n=s("./src/features/delegation/stores/index.ts");var o=s("./src/stores/index.ts");var r=s("./src/lib/wallet-api-ui.ts");var i=s("../../packages/core/dist/index.esm.js");var l=s("../../packages/common/dist/index.esm.js");var c=s("../../packages/cardano/dist/index.esm.js");var d=s("../../node_modules/lodash/groupBy.js");var u=s.n(d);const useDelegationTransaction=()=>{const{clearSecrets:e,password:t}=useSecrets();const{inMemoryWallet:s}=useWalletStore();const{delegationTxBuilder:a}=useDelegationStore();const signAndSubmitTransaction=async()=>{const n=a.build();const o=await withSignTxConfirmation(()=>n.sign(),t.value);await s.submitTx(o);e()};return{signAndSubmitTransaction}};const getPoolIdToRewardAccountsMap=e=>{return new Map(Object.entries(u()(e,({delegatee:e})=>{const t=(null==e?void 0:e.nextNextEpoch)||(null==e?void 0:e.nextEpoch)||(null==e?void 0:e.currentEpoch);var s;return null!==(s=null==t?void 0:t.id.toString())&&void 0!==s?s:""})).filter(([e])=>!!e))};const useRewardAccountsData=()=>{const{inMemoryWallet:e}=(0,o.useWalletStore)();const t=(0,l.useObservable)(e.delegation.rewardAccounts$);var s;const n=(0,a.useMemo)(()=>{return null!==(s=null==t?void 0:t.filter(({credentialStatus:e})=>c.Wallet.Cardano.StakeCredentialStatus.Registered===e))&&void 0!==s?s:[]},[t]);const r=(0,a.useMemo)(()=>n.length>0&&!n.some(({dRepDelegatee:e})=>e),[n]);const i=(0,a.useMemo)(()=>n.filter(({dRepDelegatee:e})=>!e||e&&"active"in e.delegateRepresentative&&!e.delegateRepresentative.active),[n]);const d=(0,a.useMemo)(()=>BigInt(i?c.Wallet.BigIntMath.sum(i.map(({rewardBalance:e})=>e)):0),[i]);const u=(0,a.useMemo)(()=>getPoolIdToRewardAccountsMap(n),[n]);return{areAllRegisteredStakeKeysWithoutVotingDelegation:r,lockedStakeRewards:d,poolIdToRewardAccountsMap:u}}},"./src/views/browser-view/features/staking/index.ts":(e,t,s)=>{var a=s("./src/views/browser-view/features/staking/components/StakingContainer.tsx");var n=s("../../packages/cardano/dist/index.esm.js");var o;(function(e){e[e["MAJOR"]=6]="MAJOR";e[e["MINOR"]=1]="MINOR";e[e["PATCH"]=2]="PATCH"})(o||(o={}));var r;(function(e){e[e["MAJOR"]=2]="MAJOR";e[e["MINOR"]=6]="MINOR";e[e["PATCH"]=4]="PATCH"})(r||(r={}));const isMultidelegationSupportedByDevice=async e=>{const t=await Wallet.initConnectionAndGetSoftwareVersion(e);const s=e===WalletType.Ledger?o:r;const a=t.major>s.MAJOR;const n=t.major===s.MAJOR&&t.minor>s.MINOR;const i=t.major===s.MAJOR&&t.minor===s.MINOR&&t.patch>=s.PATCH;return a||n||i}},"./src/views/browser-view/features/staking/store/index.ts":(e,t,s)=>{var a=s("./src/views/browser-view/features/staking/store/stakingStore.ts")},"./src/views/browser-view/features/staking/store/stakingStore.ts":(e,t,s)=>{var a=s("../../node_modules/zustand/esm/index.js");var n=s("./src/views/browser-view/features/staking/types/index.ts");const o={[n.Sections.DETAIL]:{currentSection:n.Sections.DETAIL,nextSection:n.Sections.CONFIRMATION},[n.Sections.CONFIRMATION]:{currentSection:n.Sections.CONFIRMATION,nextSection:n.Sections.SIGN,prevSection:n.Sections.DETAIL},[n.Sections.SIGN]:{currentSection:n.Sections.SIGN,prevSection:n.Sections.CONFIRMATION},[n.Sections.SUCCESS_TX]:{currentSection:n.Sections.SUCCESS_TX,prevSection:n.Sections.SIGN},[n.Sections.FAIL_TX]:{currentSection:n.Sections.FAIL_TX,prevSection:n.Sections.SIGN}};const r={simpleSendConfig:o[n.Sections.DETAIL]};const i=(0,a["default"])((e,t)=>({...r,setSection:s=>e({simpleSendConfig:null!=s?s:o[t().simpleSendConfig.nextSection]}),setPrevSection:()=>e({simpleSendConfig:o[t().simpleSendConfig.prevSection]}),resetStates:()=>e(e=>({...e,...r})),isDrawerVisible:false,setIsDrawerVisible:t=>e({isDrawerVisible:t}),isStakeConfirmationVisible:false,setStakeConfirmationVisible:t=>e({isStakeConfirmationVisible:t}),isExitStakingVisible:false,setExitStakingVisible:t=>e({isExitStakingVisible:t}),isNoFundsVisible:false,setNoFundsVisible:t=>e({isNoFundsVisible:t}),isBuildingTx:false,setIsBuildingTx:t=>e({isBuildingTx:t}),stakingError:void 0,setStakingError:t=>e({stakingError:t})}))},"./src/views/browser-view/features/voting-beta/components/VotingCenterBanner/VotingCenterBanner.tsx":(e,t,s)=>{var a=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var n=s("../../node_modules/classnames/index.js");var o=s("../../node_modules/react/index.js");var r=s("../../node_modules/react-i18next/dist/es/index.js");var i=s("./src/assets/images/register-drep-bg-popup.png");var l=s("./src/assets/images/register-drep-bg.png");var c=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var p=s.n(v);var g=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var w=s.n(g);var S=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var y=s.n(S);var f=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var b=s.n(f);var E=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/views/browser-view/features/voting-beta/components/VotingCenterBanner/VotingCenterBanner.module.scss");var C={};C.styleTagTransform=b();C.setAttributes=w();C.insert=p().bind(null,"head");C.domAPI=m();C.insertStyleElement=y();var T=d()(E["default"],C);const k=E["default"]&&E["default"].locals?E["default"].locals:void 0;const VotingCenterBanner=({popupView:e,openExternalLink:t,govToolUrl:s})=>{const{t:a}=useTranslation();const n=e?"$fill":"$auto";return React.createElement("div",{className:cn(styles.container,{[styles.popupView]:e}),"data-testid":"voting-center-banner"},React.createElement("img",{className:styles.bg,src:e?bgPopup:BG}),React.createElement(Flex,{flexDirection:"column",justifyContent:"center",className:styles.content},React.createElement("div",{className:styles.title,"data-testid":"voting-center-banner-title"},a("browserView.voting-beta.modal.title")),React.createElement("div",{className:styles.description,"data-testid":"voting-center-banner-description"},e?React.createElement(Trans,{components:{br:React.createElement("br",null)},i18nKey:"browserView.voting-beta.modal.description-popup"}):a("browserView.voting-beta.modal.description")),React.createElement(Box,{w:n,mt:"$20",h:"$48"},React.createElement(Button.CallToAction,{w:n,onClick:()=>t(s),"data-testid":"voting-center-gov-tool-button",label:a("browserView.voting-beta.modal.cta")}))))}},"./src/views/browser-view/features/voting-beta/components/VotingCenterBanner/index.ts":(e,t,s)=>{var a=s("./src/views/browser-view/features/voting-beta/components/VotingCenterBanner/VotingCenterBanner.tsx")},"./src/views/nami-mode/indexInternal.tsx":(e,t,s)=>{s.d(t,{NamiDappConnector:()=>H});var a=s("../../node_modules/react/index.js");var n=s("./src/stores/index.ts");var o=s("./src/hooks/index.ts");var r=s("./src/components/MainLoader/index.ts");var i=s("./src/features/dapp/context/index.ts");var l=s("../../packages/nami/dist/index.js");var c=s("./src/providers/index.ts");var d=s("./src/lib/wallet-api-ui.ts");var u=s("../../packages/cardano/dist/index.esm.js");const m={[u.Wallet.Cardano.NetworkId.Mainnet]:"₳",[u.Wallet.Cardano.NetworkId.Testnet]:"t₳"};const v=5;var p=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/messaging/index.js");var g=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/messaging/types.js");var w=s("./src/utils/constants.ts");var S=s("../../node_modules/webextension-polyfill/dist/browser-polyfill.js");var y=s("../../node_modules/rxjs/dist/esm5/internal/observable/of.js");var f=s("../../node_modules/rxjs/dist/esm5/internal/firstValueFrom.js");var b=s("../../node_modules/rxjs/dist/esm5/internal/operators/map.js");var E=s("../../node_modules/rxjs/dist/esm5/internal/operators/finalize.js");var C=s("./src/utils/senderToDappInfo.ts");var T=s("./src/views/nami-mode/hooks.ts");var k=s("../../node_modules/@cardano-sdk/core/dist/esm/util/time.js");var h=s("../../node_modules/@cardano-sdk/wallet/dist/esm/services/WalletAssetProvider.js");var R=s("./src/views/nami-mode/utils.ts");var A=s("./src/hooks/useNetworkError.ts");var x=s("../../packages/core/dist/index.esm.js");var P=s("./src/lib/scripts/background/storage.ts");var I=s("./src/providers/TxWitnessRequestProvider/index.ts");var _=s("./src/features/dapp/components/confirm-transaction/hooks.ts");var D=s("../../packages/common/dist/index.esm.js");var N=s("../../node_modules/buffer/index.js")["Buffer"];function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a))e[a]=s[a]}return e};return _extends.apply(this,arguments)}const B=100;const O={getDappInfo:()=>{const e=(0,p.consumeRemoteApi)({baseChannel:w.DAPP_CHANNELS.dappData,properties:{getDappInfo:g.RemoteApiPropertyType.MethodReturningPromise}},{logger:D.logger,runtime:S.runtime});return e.getDappInfo()},authorizeDapp:(e,t,s)=>{const a=(0,y.of)({allowOrigin(s){if(!t.startsWith(s)){return Promise.reject()}return Promise.resolve(e)}});const n=(0,p.exposeApi)({api$:a,baseChannel:w.DAPP_CHANNELS.userPrompt,properties:{allowOrigin:g.RemoteApiPropertyType.MethodReturningPromise}},{logger:D.logger,runtime:S.runtime});setTimeout(()=>{n.shutdown();s()},B)},getSignTxRequest:async e=>({dappInfo:await (0,C.senderToDappInfo)(e.signContext.sender),request:{data:{tx:e.transaction.toCbor(),addresses:e.signContext.knownAddresses},reject:async t=>{await e.reject("User declined to sign");setTimeout(()=>{t()},B)},sign:async t=>{const s=N.from(t,"utf8");await e.sign(s,{willRetryOnFailure:true}).finally(()=>s.fill(0))}}}),getSignDataRequest:async()=>{const e=(0,p.exposeApi)({api$:(0,y.of)({async readyToSignData(){return Promise.resolve(true)}}),baseChannel:w.DAPP_CHANNELS.userPrompt,properties:{readyToSignData:g.RemoteApiPropertyType.MethodReturningPromise}},{logger:D.logger,runtime:S.runtime});return(0,f.firstValueFrom)(d.signingCoordinator.signDataRequest$.pipe((0,b.map)(async e=>({dappInfo:await (0,C.senderToDappInfo)(e.signContext.sender),request:{data:{payload:e.signContext.payload,address:e.signContext.signWith},reject:async t=>{await e.reject("User rejected to sign");setTimeout(()=>{t()},B)},sign:async t=>{const s=N.from(t,"utf8");return e.sign(s,{willRetryOnFailure:true}).finally(()=>s.fill(0))}}})),(0,E.finalize)(()=>e.shutdown())))}};const j=(0,i.withDappContext)(()=>{const{sendEventToPostHog:e}=(0,T.useAnalytics)();const[t,s]=(0,a.useState)();const r=(0,c.useBackgroundServiceAPIContext)();const{walletRepository:i}=(0,o.useWalletManager)();const{walletUI:u,inMemoryWallet:v,walletType:p,currentChain:g,environmentName:w,blockchainProvider:{assetProvider:S}}=(0,n.useWalletStore)();const y=(0,x.useSecrets)();const{theme:f}=(0,c.useTheme)();const b=(0,a.useMemo)(()=>({...u.cardanoCoin,symbol:m[g.networkId]}),[g.networkId,u.cardanoCoin]);const getAssetInfos=async({assetIds:e,tx:t})=>{const s=new Map;if(e.length>0){const a=await (0,R.tryGetAssetInfos)({assetIds:e,assetProvider:(0,h.createWalletAssetProvider)({assetProvider:S,assetInfo$:v.assetInfo$,tx:t,logger:D.logger}),timeout:(0,k.Milliseconds)(6e3)});for(const n of a)s.set(n.assetId,n)}return s};const E=(0,a.useCallback)(e=>{r.handleOpenNamiBrowser({path:e})},[r]);const C=(0,o.useHandleResolver)();(0,a.useEffect)(()=>{(0,P.getBackgroundStorage)().then(e=>s(e.namiMigration)).catch(D.logger.error)},[]);const N=(0,a.useCallback)(async()=>{const e="lace";const a={...t,mode:e};s(a);r.handleChangeMode({mode:e});await (0,P.setBackgroundStorage)({namiMigration:a})},[r,t]);const B=(0,I.useTxWitnessRequest)();return a.createElement(l.DappOutsideHandlesProvider,_extends({},{theme:f.name,walletManager:d.walletManager,walletRepository:i,environmentName:w,dappConnector:{...O,txWitnessRequest:B,getAssetInfos},switchWalletMode:N,secretsUtil:y,useOnUnload:_.useOnUnload}),a.createElement(l.CommonOutsideHandlesProvider,_extends({},{cardanoCoin:b,walletType:p,openHWFlow:E,inMemoryWallet:v,withSignTxConfirmation:d.withSignTxConfirmation,sendEventToPostHog:e,handleResolver:C,useNetworkError:A.useNetworkError,networkConnection:u.networkConnection}),a.createElement(l.DApp,null)))});var V=s("./src/lib/scripts/keep-alive-ui.ts");var W=s("./src/views/nami-mode/index.scss");var M=s("./src/hooks/useFatalError.ts");var L=s("./src/components/ErrorBoundary/index.ts");var F=s("./src/utils/remove-reloader-if-exists.ts");const H=(0,i.withDappContext)(()=>{const{hdDiscoveryStatus:e}=(0,n.useWalletStore)();const t=(0,a.useMemo)(()=>"Idle"===e,[e]);const s=(0,M.useFatalError)();(0,a.useEffect)(()=>{if(t)(0,F.removePreloaderIfExists)()},[t]);(0,o.useAppInit)();if(s){return a.createElement(L.Crash,null)}return a.createElement("div",{id:"nami-mode"},t?a.createElement(j,null):a.createElement(r.MainLoader,null))})},"./src/views/nami-mode/utils.ts":(e,t,s)=>{s.d(t,{isNamiWallet:()=>isNamiWallet,tryGetAssetInfos:()=>tryGetAssetInfos});var a=s("../../node_modules/@cardano-sdk/core/dist/esm/errors.js");var n=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/types.js");var o=s("../../packages/cardano/dist/index.esm.js");var r=s("../../packages/common/dist/index.esm.js");const isNamiWallet=e=>{if(!e||e.source.wallet.type!==n.WalletType.InMemory)return false;return!e.source.wallet.encryptedSecrets.keyMaterial.toString()};const promiseTimeout=async(e,t)=>{let s;try{return await Promise.race([e,new Promise((e,n)=>s=setTimeout(()=>n(new a.TimeoutError("Failed to resolve the promise in time")),t))])}finally{if(s)clearTimeout(s)}};const tryGetAssetInfos=async({assetIds:e,assetProvider:t,timeout:s})=>{try{return await promiseTimeout(t.getAssets({assetIds:e,extraData:{nftMetadata:true,tokenMetadata:true}}),s)}catch(a){r.logger.error("Error: Failed to retrieve assets",a);return e.map(e=>{const t=o.Wallet.Cardano.AssetId.getPolicyId(e);const s=o.Wallet.Cardano.AssetId.getAssetName(e);return{assetId:e,fingerprint:o.Wallet.Cardano.AssetFingerprint.fromParts(t,s),name:s,policyId:t,quantity:BigInt(0),supply:BigInt(0)}})}}}}]);
//# sourceMappingURL=691.js.map
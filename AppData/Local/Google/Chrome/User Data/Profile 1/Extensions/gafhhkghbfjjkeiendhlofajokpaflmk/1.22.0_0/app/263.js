!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3819daa6-0494-426b-ab6c-f82ed5ab5cde",e._sentryDebugIdIdentifier="sentry-dbid-3819daa6-0494-426b-ab6c-f82ed5ab5cde")}catch(s){}}();var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"1.22.0-2d3a946"};"use strict";(self["webpackChunk_lace_browser_extension_wallet"]=self["webpackChunk_lace_browser_extension_wallet"]||[]).push([[263],{"./src/components/AssetSelectionButton/AssetCounter.tsx":(e,t,s)=>{s.d(t,{AssetsCounter:()=>AssetsCounter});var n=s("../../node_modules/react/index.js");var o=s("./src/components/AssetSelectionButton/AssetCounter.modules.scss");const AssetsCounter=({count:e})=>n.createElement("div",{className:o["default"].container,"data-testid":"assets-counter"},n.createElement("p",null,e))},"./src/components/AssetSelectionButton/SelectTokensButton.tsx":(e,t,s)=>{s.d(t,{SelectTokenButton:()=>SelectTokenButton});var n=s("../../node_modules/react/index.js");var o=s("../../packages/common/dist/index.esm.js");var a=s("./src/components/AssetSelectionButton/AssetCounter.tsx");var r=s("./src/components/AssetSelectionButton/SelectTokensButton.module.scss");const SelectTokenButton=({label:e,onClick:t,count:s=0,btnStyle:i,testId:l})=>n.createElement("div",{className:r["default"].container},s>0&&n.createElement(a.AssetsCounter,{count:s}),n.createElement(o.Button,{"data-testid":l,style:i,onClick:t,color:"secondary",variant:"outlined",className:r["default"].selectMultipleBtn},e))},"./src/components/ErrorBoundary/Crash.tsx":(e,t,s)=>{s.d(t,{Crash:()=>Crash});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/classnames/index.js");var a=s.n(o);var r=s("../../node_modules/react-i18next/dist/es/index.js");var i=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var g=s.n(v);var S=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=s.n(S);var w=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var f=s.n(w);var E=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/components/ErrorBoundary/Crash.module.scss");var k={};k.styleTagTransform=f();k.setAttributes=g();k.insert=m().bind(null,"head");k.domAPI=d();k.insertStyleElement=p();var C=l()(E["default"],k);const T=E["default"]&&E["default"].locals?E["default"].locals:void 0;var h=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var b=s("../../node_modules/webextension-polyfill/dist/browser-polyfill.js");const useRuntime=()=>({reload:b.runtime.reload});const Crash=()=>{const{t:e}=(0,r.useTranslation)();const t=useRuntime();return n.createElement("div",{className:a()([T.crashContainer]),"data-testid":"crash"},n.createElement("p",{className:T.crashText,"data-testid":"crash-text"},e("general.errors.crash")),n.createElement(h.Button.CallToAction,{onClick:()=>t.reload(),label:e("general.errors.reloadExtension"),"data-testid":"crash-reload"}))}},"./src/components/ResultMessage/index.ts":(e,t,s)=>{s.d(t,{ResultMessage:()=>n.ResultMessage});var n=s("./src/components/ResultMessage/ResultMessage.tsx")},"./src/components/TransactionHashBox/index.ts":(e,t,s)=>{s.d(t,{TransactionHashBox:()=>n.TransactionHashBox});var n=s("./src/components/TransactionHashBox/TransactionHashBox.tsx")},"./src/components/TransitionAcknowledgmentDialog/index.ts":(e,t,s)=>{s.d(t,{TransitionAcknowledgmentDialog:()=>TransitionAcknowledgmentDialog});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var a=s.n(o);var r=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var i=s.n(r);var l=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var v=s.n(m);var g=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var S=s.n(g);var p=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/components/TransitionAcknowledgmentDialog/TransitionAcknowledgmentDialog.module.scss");var w={};w.styleTagTransform=S();w.setAttributes=u();w.insert=c().bind(null,"head");w.domAPI=i();w.insertStyleElement=v();var f=a()(p["default"],w);const E=p["default"]&&p["default"].locals?p["default"].locals:void 0;var k=s("../../packages/common/dist/index.esm.js");var C=s("../../node_modules/antd/es/typography/index.js");var T=s("../../node_modules/antd/es/modal/index.js");var h=s("../../node_modules/antd/es/checkbox/index.js");var b=s("./src/utils/constants.ts");var A=s("../../node_modules/react-i18next/dist/es/index.js");const{Title:x,Text:y}=C["default"];const TransitionAcknowledgmentDialog=({visible:e,onClose:t,title:s,description:o,confirmationLabel:a,storageMemoEntryName:r})=>{const{t:i}=(0,A.useTranslation)();const[l,c]=(0,n.useState)(false);const onCheckboxChange=e=>{const t=e.target.checked;c(t);localStorage.setItem(r,String(t))};return n.createElement(T["default"],{centered:true,closable:false,footer:null,open:e,width:b.HW_POPUPS_WIDTH,className:E.transitionAcknowledgment,zIndex:1001},n.createElement(x,{level:3,className:E.title},s),n.createElement(y,{className:E.description},o),n.createElement("div",{className:E.buttons},n.createElement(k.Button,{onClick:t,block:true},a),n.createElement(h["default"],{checked:l,onChange:onCheckboxChange},n.createElement("span",{className:E.checkboxLabel},i("browserView.onboarding.sendTransitionAcknowledgment.dontShowAgain")))))}},"./src/features/address-book/store/index.tsx":(e,t,s)=>{s.d(t,{useAddressBookStore:()=>n.useAddressBookStore});var n=s("./src/features/address-book/store/addressBookStore.tsx")},"./src/features/settings/components/Settings.tsx":(e,t,s)=>{var n=s("../../node_modules/react/index.js");var o=s("./src/components/Layout/index.ts");var a=s("../../node_modules/react-i18next/dist/es/index.js");var r=s("./src/features/settings/index.ts");var i=s("./src/views/browser-view/features/settings/components/SettingsRemoveWallet.tsx");const Settings=({defaultPassphraseVisible:e,defaultMnemonic:t})=>{const{t:s}=useTranslation();return React.createElement(ContentLayout,{title:s("settings.title"),"data-testid":"settings-page-title"},React.createElement("div",null,React.createElement(SettingsWallet,{popupView:true}),React.createElement(SettingsPreferences,{popupView:true}),React.createElement(SettingsSecurity,{popupView:true,defaultPassphraseVisible:e,defaultMnemonic:t}),React.createElement(SettingsHelp,{popupView:true}),React.createElement(SettingsLegal,null),React.createElement(SettingsRemoveWallet,{popupView:true})))}},"./src/features/unlock-wallet/components/UnlockWallet.tsx":(e,t,s)=>{s.d(t,{UnlockWallet:()=>UnlockWallet});var n=s("../../node_modules/react/index.js");var o=s("./src/components/Layout/index.ts");var a=s("./src/assets/branding/lace-logo-mark.svg");var r=s("../../packages/common/dist/index.esm.js");var i=s("../../packages/core/dist/index.esm.js");var l=s("./src/features/unlock-wallet/components/UnlockWallet.module.scss");var c=s("../../node_modules/react-i18next/dist/es/index.js");var d=s("./src/features/unlock-wallet/components/ForgotPassword.tsx");const UnlockWallet=({onUnlock:e,onForgotPasswordClick:t,passwordInput:s,unlockButtonDisabled:u,showForgotPassword:m=true})=>{const{t:v}=(0,c.useTranslation)();return n.createElement(o.ContentLayout,null,n.createElement("form",{onSubmit:e,className:l["default"].lockWalletContent},n.createElement("div",{className:l["default"].content,"data-testid":"unlock-screen"},n.createElement("img",{src:a["default"],alt:"LACE",className:l["default"].image,"data-testid":"unlock-screen-img"}),n.createElement("h1",{className:l["default"].title,"data-testid":"unlock-screen-title"},v("unlock.sectionTitle")),n.createElement(i.Password,{errorMessage:v("general.errors.invalidPassword"),error:s.invalidPass,onChange:s.handleChange,onPressEnter:t=>{t.preventDefault();e()},label:v("unlock.input.placeholder")})),n.createElement("div",{className:l["default"].blockButton},n.createElement(r.Button,{color:"gradient",onClick:e,disabled:u,"data-testid":"unlock-button"},v("unlock.button"))),m&&n.createElement(d.ForgotPassword,{onForgotPasswordClick:t})))}},"./src/providers/PostHogClientProvider/context.tsx":(e,t,s)=>{s.d(t,{PostHogClientProvider:()=>PostHogClientProvider,usePostHogClientContext:()=>usePostHogClientContext});var n=s("../../node_modules/zustand/esm/shallow.js");var o=s("../../node_modules/react/index.js");var a=s("./src/stores/index.ts");var r=s("./src/providers/PostHogClientProvider/client/index.ts");var i=s("./src/providers/AnalyticsProvider/getUserIdService.ts");var l=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var c=s("./src/providers/BackgroundServiceAPI/index.ts");const d=(0,i.getUserIdService)();const u=(0,o.createContext)(null);const usePostHogClientContext=()=>{const e=(0,o.useContext)(u);if(null===e)throw new Error("PostHogClientContext not defined");return e};const PostHogClientProvider=({children:e,postHogCustomClient:t})=>{const{getBackgroundStorage:s,setBackgroundStorage:i}=(0,c.useBackgroundServiceAPIContext)();const{currentChain:m,view:v}=(0,a.useWalletStore)(e=>{return{currentChain:null==e?void 0:e.currentChain,view:e.walletUI.appMode}},n["default"]);const g=(0,o.useMemo)(()=>t||r.PostHogClient.getInstance(m,d,{getBackgroundStorage:s,setBackgroundStorage:i},"popup"===v?l.ExtensionViews.Popup:l.ExtensionViews.Extended),[m,s,t,i,v]);(0,o.useEffect)(()=>()=>g.shutdown(),[g]);return o.createElement(u.Provider,{value:g},e)}},"./src/providers/UIThemeProvider/context.tsx":(e,t,s)=>{s.d(t,{UIThemeProvider:()=>UIThemeProvider});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var a=s.n(o);var r=s("./src/providers/ThemeProvider/index.ts");const UIThemeProvider=({children:e})=>{const{theme:t}=(0,r.useTheme)();return n.createElement(o.ThemeProvider,{colorScheme:"light"===t.name?o.ThemeColorScheme.Light:o.ThemeColorScheme.Dark},e)}},"./src/routes/PopupView.tsx":(e,t,s)=>{var n=s("../../node_modules/react/index.js");var o=s("../../packages/core/dist/index.esm.js");var a=s("../../packages/common/dist/index.esm.js");var r=s("../../node_modules/react-i18next/dist/es/index.js");var i=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var g=s.n(v);var S=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=s.n(S);var w=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var f=s.n(w);var E=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/receive-info/components/ReceiveInfo.module.scss");var k={};k.styleTagTransform=f();k.setAttributes=g();k.insert=m().bind(null,"head");k.domAPI=d();k.insertStyleElement=p();var C=l()(E["default"],k);const T=E["default"]&&E["default"].locals?E["default"].locals:void 0;var h=s("./src/providers/ThemeProvider/index.ts");var b=s("./src/providers/index.ts");var A=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var x=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var y=s("./src/lib/scripts/types/index.ts");var R=s("./src/views/browser-view/components/index.ts");var P=s("./src/hooks/index.ts");const D=null;const ReceiveInfo_ReceiveInfo=({name:e,address:t,handles:s,goBack:n})=>{const o=useAnalyticsContext();const{t:a}=useTranslation();const{theme:r}=useTheme();const i=useBackgroundServiceAPIContext();const[l,c]=useState(false);const[,{updateLocalStorage:d}]=useLocalStorage("isReceiveInAdvancedMode",false);const handleOnClose=()=>{n();o.sendEventToPostHog(PostHogAction.ReceiveYourWalletAddressXClick)};const handleCopyAdaHandle=()=>{o.sendEventToPostHog(PostHogAction.ReceiveCopyADAHandleIconClick)};const handleCopyAddress=()=>{o.sendEventToPostHog(PostHogAction.ReceiveCopyAddressIconClick)};const openTabExtensionReceiveFlow=()=>{d(true);i.handleOpenBrowser({section:BrowserViewSections.RECEIVE_ADVANCED})};return React.createElement(React.Fragment,null,React.createElement(Drawer,{open:true,onClose:handleOnClose,title:React.createElement(DrawerHeader,{title:a("qrInfo.receive"),subtitle:React.createElement(Box,{className:styles.subTitle},a("qrInfo.scanQRCodeToConnectWallet"),D&&React.createElement(Flex,{mt:"$20",justifyContent:"space-between"},React.createElement("span",null,a("qrInfo.advancedMode.toggle.label")),React.createElement(ToggleSwitch,{icon:React.createElement(Tooltip,{title:a("qrInfo.advancedMode.toggle.description")},React.createElement(InfoCircleOutlined,null)),defaultChecked:l,checked:l,onCheckedChange:()=>c(true),testId:"advanced-mode-"})))}),navigation:React.createElement(DrawerNavigation,{onCloseIconClick:handleOnClose}),popupView:true},React.createElement(Flex,{className:styles.container,testId:"receive-address-qr",flexDirection:"column",gap:"$16"},React.createElement(AddressCard,{name:e,isPopupView:true,address:null==t?void 0:t.toString(),getQRCodeOptions:useCallback(()=>getQRCodeOptions(r,ADDRESS_CARD_QR_CODE_SIZE_POPUP),[r]),onCopyClick:handleCopyAddress}),null==s?void 0:s.map(({nftMetadata:e,image:t})=>React.createElement(HandleAddressCard,{key:e.name,name:e.name,image:getAssetImageUrl(t||e.image),copiedMessage:a("core.infoWallet.handleCopied"),onCopyClick:handleCopyAdaHandle})))),React.createElement(WarningModal,{header:a("qrInfo.advancedMode.modal.title"),content:React.createElement("span",{className:styles.removeWalletContent},a("qrInfo.advancedMode.modal.description")),visible:l,onCancel:()=>c(false),onConfirm:openTabExtensionReceiveFlow,cancelLabel:a("qrInfo.advancedMode.modal.cancel"),confirmLabel:a("qrInfo.advancedMode.modal.confirm"),confirmCustomClassName:styles.settingsConfirmButton,isPopupView:true}))};var _=s("./src/routes/index.ts");var I=s("./src/stores/index.ts");var N=s("./src/hooks/useGetHandles.ts");const ReceiveInfoContainer_ReceiveInfoContainer=()=>{const e=useRedirection(walletRoutePaths.assets);const{walletInfo:t}=useWalletStore();const s=useGetHandles();const n=useMemo(()=>{const e=[...t.addresses];return e.sort((e,t)=>e.index-t.index)},[t.addresses]);return React.createElement(ReceiveInfo,{name:null==t?void 0:t.name,address:n[0].address,handles:s,goBack:e})};var M=s("../../node_modules/lodash/debounce.js");var V=s("./src/components/Layout/index.ts");var W=s("./src/views/browser-view/features/activity/index.ts");var F=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/activity/components/Activity.module.scss");var B={};B.styleTagTransform=f();B.setAttributes=g();B.insert=m().bind(null,"head");B.domAPI=d();B.insertStyleElement=p();var j=l()(F["default"],B);const H=F["default"]&&F["default"].locals?F["default"].locals:void 0;var L=s("./src/hooks/useWalletActivities.ts");const O=300;const Activity_Activity=()=>{const{t:e}=useTranslation();const{priceResult:t}=useFetchCoinPrice();const{walletInfo:s,activityDetail:n,resetActivityState:o}=useWalletStore();const a=`${e("browserView.activity.title")}`;const r=useRedirection(walletRoutePaths.assets);const i=useAnalyticsContext();const l=useCallback(()=>{i.sendEventToPostHog(PostHogAction.ActivityActivityActivityRowClick)},[i]);const{walletActivities:c,mightHaveMore:d,loadedTxLength:u,loadMore:m,retry:v,error:g}=useWalletActivitiesPaginated({sendAnalytics:l});const S=useMemo(()=>debounce(m,O),[m]);return React.createElement(ContentLayout,{title:a,isLoading:void 0===c},React.createElement(Drawer,{open:!!n,onClose:o,navigation:React.createElement(DrawerNavigation,{onArrowIconClick:o,onCloseIconClick:()=>{i.sendEventToPostHog(PostHogAction.ActivityActivityDetailXClick);o();r()}}),popupView:true},n&&t&&React.createElement(ActivityDetail,{price:t})),React.createElement("div",{className:styles.activitiesContainer},(null==c?void 0:c.length)>0&&React.createElement(GroupedAssetActivityList,{hasMore:d,loadMore:S,lists:c,scrollableTarget:"contentLayout",dataLength:u,loadingError:g,retryLoading:v}),(null==c?void 0:c.length)===0&&React.createElement("div",{className:styles.emptyState},React.createElement(FundWalletBanner,{title:e("browserView.assets.welcome"),subtitle:e("browserView.activity.fundWalletBanner.title"),prompt:e("browserView.fundWalletBanner.prompt"),walletAddress:s.addresses[0].address.toString()}))))};const PopupAssets_PopupAssets=()=>React.createElement(AssetsView,null);var U=s("./src/views/browser-view/features/assets/index.ts");var Z=s("./src/views/browser-view/features/send-transaction/index.ts");var G=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/index.ts");var X=s("./src/components/ContinueInBrowserDialog/index.ts");var K=s("./src/providers/BackgroundServiceAPI/index.ts");var $=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/HeaderView.tsx");var q=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/send/components/Send.module.scss");var Y={};Y.styleTagTransform=f();Y.setAttributes=g();Y.insert=m().bind(null,"head");Y.domAPI=d();Y.insertStyleElement=p();var z=l()(q["default"],Y);const Q=q["default"]&&q["default"].locals?q["default"].locals:void 0;var J=s("./src/views/browser-view/features/send-transaction/helpers.ts");const ee="output1";const Send_Send=()=>{const{t:e}=useTranslation();const[t,s]=useState(false);const toggleContinueDialog=()=>s(!t);const{currentSection:{currentSection:n},setSection:o}=useSections();const a=useBackgroundServiceAPIContext();const[r]=useMultipleSelection();const{uiOutputs:i}=useCoinStateSelector(ee);const{address:l}=useAddressState(ee);const openTabExtensionSendFlow=()=>{saveTemporaryTxDataInStorage({tempAddress:l,tempOutputs:i,tempSource:"hardware-wallet"});return a.handleOpenBrowser({section:BrowserViewSections.SEND_ADVANCED})};const c=r&&n===Sections.ASSET_PICKER;const d=![Sections.ADDRESS_LIST,Sections.ADDRESS_FORM,Sections.ASSET_PICKER].includes(n)||c;return React.createElement(React.Fragment,null,React.createElement(ContinueInBrowserDialog,{visible:t,onConfirm:openTabExtensionSendFlow,onClose:toggleContinueDialog,title:e("browserView.onboarding.hardwareWalletSendTransition.title"),description:e("browserView.onboarding.hardwareWalletSendTransition.description"),okLabel:e("browserView.onboarding.hardwareWalletSendTransition.ok"),cancelLabel:e("browserView.onboarding.hardwareWalletSendTransition.cancel")}),React.createElement(Drawer,{visible:true,navigation:React.createElement(HeaderNavigation,{isPopupView:true}),title:React.createElement("div",{className:styles.headerTitleContainer},React.createElement(HeaderTitle,{popup:true})),footer:d&&React.createElement(Footer,{isPopupView:true,openContinueDialog:toggleContinueDialog,onHandleChangeConfirm:()=>o({currentSection:Sections.FORM,nextSection:Sections.SUMMARY})}),popupView:true},React.createElement(Transaction,{flow:"send",isPopupView:true})))};var et=s("./src/routes/wallet-paths.ts");var es=s("./src/hooks/useMultiDelegationEnabled.ts");var en=s("../../packages/staking/dist/index.js");var eo=s("./src/features/delegation/stores/index.ts");var ea=s("./src/utils/format-number.ts");var er=s("./src/components/Layout/SectionTitle.tsx");var ei=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/delegation/components/DelegationLayout.module.scss");var el={};el.styleTagTransform=f();el.setAttributes=g();el.insert=m().bind(null,"head");el.domAPI=d();el.insertStyleElement=p();var ec=l()(ei["default"],el);const ed=ei["default"]&&ei["default"].locals?ei["default"].locals:void 0;var eu=s("./src/utils/constants.ts");var em=s("./src/lib/wallet-api-ui.ts");var ev=s("./src/views/browser-view/features/staking/index.ts");var eg=s("./src/views/browser-view/features/staking/hooks.ts");var eS=s("./src/config.ts");var ep=s("./src/lib/scripts/background/util.ts");function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return _extends.apply(this,arguments)}const MultiDelegationStakingPopup_MultiDelegationStakingPopup=()=>{var e,t,s,n;const{t:o}=useTranslation();const{theme:a}=useTheme();const{handleOpenBrowser:r}=useBackgroundServiceAPIContext();const{delegationTxBuilder:i,setDelegationTxBuilder:l,delegationTxFee:c,setDelegationTxFee:d}=useDelegationStore();const u=useExternalLinkOpener();const m=useSecrets();const v=useSubmitingState();const{priceResult:g}=useFetchCoinPrice();const{balance:S}=useBalances(null==g?void 0:null===(e=g.cardano)||void 0===e?void 0:e.price);const p=useStakingRewards();const{walletRepository:w}=useWalletManager();const{getCustomSubmitApiForNetwork:f}=useCustomSubmitApi();const{walletType:E,inMemoryWallet:k,walletUI:{cardanoCoin:C},stakePoolSearchResults:T,stakePoolSearchResultsStatus:h,fetchStakePools:b,fetchNetworkInfo:A,networkInfo:x,blockchainProvider:y,walletInfo:R,currentChain:P,environmentName:D,isSharedWallet:_}=useWalletStore(e=>({walletType:e.walletType,inMemoryWallet:e.inMemoryWallet,walletUI:{cardanoCoin:e.walletUI.cardanoCoin},stakePoolSearchResults:e.stakePoolSearchResults,stakePoolSearchResultsStatus:e.stakePoolSearchResultsStatus,fetchStakePools:e.fetchStakePools,networkInfo:e.networkInfo,fetchNetworkInfo:e.fetchNetworkInfo,blockchainProvider:e.blockchainProvider,walletInfo:e.walletInfo,currentChain:e.currentChain,environmentName:e.environmentName,isSharedWallet:e.isSharedWallet}));const I=useCurrentWallet();const N=useObservable(w.wallets$);const M=getParentWalletCIP1854Account({wallets:N,activeWallet:I});const V=useSignPolicy(I,"staking");const W=useCallback(()=>{const e={sendEvent:()=>{}};e.sendEvent({action:"AnalyticsEventActions.CLICK_EVENT",category:"AnalyticsEventCategories.STAKING",name:"AnalyticsEventNames.Staking.STAKING_MULTI_DELEGATION_POPUP"})},[]);const{walletActivities:F,walletActivitiesStatus:B}=useWalletActivities({sendAnalytics:W});const{fiatCurrency:j}=useCurrencyStore();const H=useWalletStore(networkInfoStatusSelector);const[L,{updateLocalStorage:O}]=useLocalStorage(MULTIDELEGATION_FIRST_VISIT_LS_KEY,true);const[U,{updateLocalStorage:Z}]=useLocalStorage(MULTIDELEGATION_DAPP_COMPATIBILITY_LS_KEY,true);const[G,{updateLocalStorage:X}]=useLocalStorage(STAKING_BROWSER_PREFERENCES_LS_KEY,DEFAULT_STAKING_BROWSER_PREFERENCES);const K=null===(s=null===(t=R.addresses)||void 0===t?void 0:t[0].address)||void 0===s?void 0:s.toString();const $=R.name;const q=useAnalyticsContext();useEffect(()=>{A()},[A,y]);const{GOV_TOOLS_URLS:Y}=config();return React.createElement(OutsideHandlesProvider,_extends({},{analytics:q,stakingBrowserPreferencesPersistence:G,setStakingBrowserPreferencesPersistence:X,multidelegationFirstVisit:L,triggerMultidelegationFirstVisit:()=>{O(false)},multidelegationDAppCompatibility:U,triggerMultidelegationDAppCompatibility:()=>Z(false),expandStakingView:e=>r({section:BrowserViewSections.STAKING,urlSearchParams:e}).then(()=>window.close()),balancesBalance:S,delegationStoreSetDelegationTxBuilder:l,delegationStoreDelegationTxBuilder:i,delegationStoreSetDelegationTxFee:d,delegationStoreDelegationTxFee:c,fetchCoinPricePriceResult:g,openExternalLink:u,password:m,stakingRewards:p,submittingState:v,walletManagerExecuteWithPassword:withSignTxConfirmation,walletStoreWalletType:E,walletStoreInMemoryWallet:k,walletStoreWalletUICardanoCoin:C,currencyStoreFiatCurrency:j,walletStoreStakePoolSearchResults:T,walletStoreStakePoolSearchResultsStatus:h,walletStoreFetchStakePools:b,walletStoreFetchNetworkInfo:A,walletStoreNetworkInfo:x,walletStoreBlockchainProvider:y,walletStoreWalletActivities:F,walletStoreWalletActivitiesStatus:B,compactNumber:compactNumberWithUnit,walletAddress:K,walletName:$,currentChain:P,isMultidelegationSupportedByDevice,isCustomSubmitApiEnabled:f(D).status,isSharedWallet:_,signPolicy:V,sharedWalletKey:null==M?void 0:M.extendedAccountPublicKey,coSigners:null==I?void 0:null===(n=I.metadata)||void 0===n?void 0:n.coSigners,useRewardAccountsData,govToolUrl:Y[D],parseError}),React.createElement(ContentLayout,{title:React.createElement(SectionTitle,{title:o("staking.sectionTitle"),classname:styles.sectionTilte}),isLoading:H},React.createElement(StakingPopup,{theme:a.name})))};var ew=s("../../node_modules/lodash/isNumber.js");var ef=s("../../packages/cardano/dist/index.esm.js");var eE=s("./src/stores/selectors/staking-selectors.ts");var ek=s("./src/api/transformers.ts");var eC=s("./src/views/browser-view/features/staking/components/StakePoolDetails/index.tsx");var eT=s("./src/views/browser-view/features/staking/components/StakingModals/index.tsx");var eh=s("./src/views/browser-view/features/staking/types/index.ts");var eb=s("./src/features/stake-pool-details/store/index.ts");var eA=s("../../node_modules/antd/es/typography/index.js");var ex=s("./src/views/browser-view/features/staking/components/StakeFundsBanner/index.ts");var ey=s("./src/views/browser-view/features/staking/components/StakingInfo/index.ts");var eR,eP;function expand_gradient_component_extends(){expand_gradient_component_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return expand_gradient_component_extends.apply(this,arguments)}var SvgExpandGradientcomponent=function SvgExpandGradientcomponent(e){return React.createElement("svg",expand_gradient_component_extends({width:"1em",height:"1em",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),eR||(eR=React.createElement("path",{d:"M3.5 8a1 1 0 0 0 2 0h-2Zm1-4V3a1 1 0 0 0-1 1h1Zm4 1a1 1 0 0 0 0-2v2Zm11 3a1 1 0 1 0 2 0h-2Zm1-4h1a1 1 0 0 0-1-1v1Zm-4-1a1 1 0 1 0 0 2V3Zm-11 13a1 1 0 1 0-2 0h2Zm-1 4h-1a1 1 0 0 0 1 1v-1Zm4 1a1 1 0 1 0 0-2v2Zm1.707-5.293a1 1 0 0 0-1.414-1.414l1.414 1.414Zm4.586-7.414a1 1 0 0 0 1.414 1.414l-1.414-1.414Zm-6 1.414a1 1 0 0 0 1.414-1.414L8.793 9.707ZM20.5 20v1a1 1 0 0 0 1-1h-1Zm-4.293-5.707a1 1 0 0 0-1.414 1.414l1.414-1.414ZM21.5 16a1 1 0 1 0-2 0h2Zm-5 3a1 1 0 1 0 0 2v-2ZM5.5 8V4h-2v4h2Zm-1-3h4V3h-4v2Zm17 3V4h-2v4h2Zm-1-5h-4v2h4V3Zm-17 13v4h2v-4h-2Zm1 5h4v-2h-4v2Zm.707-.293 5-5-1.414-1.414-5 5 1.414 1.414Zm11-11 5-5-1.414-1.414-5 5 1.414 1.414Zm-6-1.414-5-5-1.414 1.414 5 5 1.414-1.414Zm11 11-5-5-1.414 1.414 5 5 1.414-1.414ZM19.5 16v4h2v-4h-2Zm1 3h-4v2h4v-2Z",fill:"url(#expand-gradient_component_svg__a)"})),eP||(eP=React.createElement("defs",null,React.createElement("linearGradient",{id:"expand-gradient_component_svg__a",x1:1.572,y1:1.072,x2:25.014,y2:2.801,gradientUnits:"userSpaceOnUse"},React.createElement("stop",{stopColor:"#FF92E1"}),React.createElement("stop",{offset:1,stopColor:"#FDC300"})))))};const eD=null;var e_=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/delegation/components/ExpandViewBanner/ExpandViewBanner.module.scss");var eI={};eI.styleTagTransform=f();eI.setAttributes=g();eI.insert=m().bind(null,"head");eI.domAPI=d();eI.insertStyleElement=p();var eN=l()(e_["default"],eI);const eM=e_["default"]&&e_["default"].locals?e_["default"].locals:void 0;const ExpandViewBanner_ExpandViewBanner=()=>{const{t:e}=useTranslation();const t=useBackgroundServiceAPIContext();return React.createElement("div",{className:styles.wrapper},React.createElement("div",{className:styles.container},React.createElement("div",{className:styles.title},e("staking.expandView.title")),React.createElement("div",{className:styles.description},e("staking.expandView.description")),React.createElement(Button,{onClick:()=>t.handleOpenBrowser({section:BrowserViewSections.STAKING}),className:styles.button,size:"large",color:"gradient"},React.createElement(Icon,{component:ExpandIcon,className:styles.icon}),e("staking.expandView.button"))))};function DelegationLayout_extends(){DelegationLayout_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return DelegationLayout_extends.apply(this,arguments)}const{Text:eV}=eA["default"];const DelegationLayout_DelegationLayout=({searchedPools:e,handleSearchChange:t,coinBalance:s,currentStakePool:n,fiat:o,isLoading:a,isSearching:r,hasNoFunds:i,isDelegating:l,canDelegate:c,walletAddress:d,totalRewards:u,lastReward:m,onStakePoolSelect:v,onStakePoolClick:g,cardanoCoin:S})=>{var p;const{t:w}=useTranslation();const{environmentName:f}=useWalletStore();const E=useWalletStore(({stakePoolSearchResults:e})=>{return null==e?void 0:e.totalResultCount});const k=useExternalLinkOpener();const{GOV_TOOLS_URLS:C}=config();const T=i||!i&&!l||l;const h={gettingSaturated:w("cardano.stakePoolSearch.gettingSaturated"),saturated:w("cardano.stakePoolSearch.saturated"),overSaturation:w("cardano.stakePoolSearch.overSaturated"),staking:w("cardano.stakePoolSearch.staking"),searchPlaceholder:w("cardano.stakePoolSearch.searchPlaceholder")};const{areAllRegisteredStakeKeysWithoutVotingDelegation:b,poolIdToRewardAccountsMap:A}=useRewardAccountsData();const x=!i&&b;return React.createElement(ContentLayout,{title:React.createElement(SectionTitle,{title:w("staking.sectionTitle"),classname:styles.sectionTilte}),isLoading:a},React.createElement("div",{className:styles.content},React.createElement(Skeleton,{loading:!isNumber(s)},React.createElement("div",{className:styles.contentWrapper},x&&React.createElement(Box,{mt:"$16"},React.createElement(RegisterAsDRepBanner,{openExternalLink:k,govToolUrl:C[f],popupView:true})),c&&React.createElement(StakeFundsBanner,{balance:s,popupView:true}),i&&React.createElement(FundWalletBanner,{title:w("browserView.assets.welcome"),subtitle:w("browserView.staking.fundWalletBanner.subtitle"),prompt:w("browserView.staking.fundWalletBanner.prompt"),walletAddress:null==d?void 0:d.toString(),shouldHaveVerticalContent:true}),l&&React.createElement(StakingInfo,DelegationLayout_extends({},{...n,rewardAccount:null===(p=A.get(n.id))||void 0===p?void 0:p[0],coinBalance:s,fiat:o,totalRewards:u,lastReward:m,cardanoCoin:S},{onStakePoolSelect:v,popupView:true})),React.createElement("div",null,React.createElement("div",{className:styles.title},React.createElement("h1",{className:styles.subHeader},w("staking.stakePools.sectionTitle")),React.createElement(eV,{"data-testid":"section-title-counter",className:styles.sideText},"(",E||0,")")),React.createElement(StakePoolSearch,{value:null,pools:e,onChange:t,isSearching:r,onStakePoolClick:g,translations:h,withSuggestions:true})),T&&React.createElement(ExpandViewBanner,null)))))};var eW=s("./src/components/TransitionAcknowledgmentDialog/index.ts");const eF="hideStakingHwDialog";const eB=3;const ej=3;const eH=new Set([eh.Sections.CONFIRMATION,eh.Sections.SIGN,eh.Sections.FAIL_TX,eh.Sections.SUCCESS_TX]);const eL=new Set([eh.Sections.CONFIRMATION,eh.Sections.SIGN]);const eO=new Set([eh.Sections.DETAIL,eh.Sections.CONFIRMATION,eh.Sections.SIGN]);const DelegationContent_DelegationContent=()=>{var e,t,s,n;const{t:o}=useTranslation();const{isInMemoryWallet:a,walletUI:{cardanoCoin:r},blockchainProvider:i}=useWalletStore();const[l,c]=useState();const d=useRedirection(walletRoutePaths.receive);const u="true"===localStorage.getItem(eF);const m=!u&&!a;const[v,g]=useState(m);const toggleisTransitionAcknowledgmentDialog=()=>g(!v);const S=useWalletStore(networkInfoStatusSelector);const{stakePoolSearchResults:p,isSearching:w,fetchStakePools:f}=useWalletStore(stakePoolResultsSelector);const{setSelectedStakePool:E}=useDelegationStore();const{setStakeConfirmationVisible:k,setIsDrawerVisible:C,setSection:T}=useStakePoolDetails();const{inMemoryWallet:h,walletInfo:b}=useWalletStore();const{totalRewards:A,lastReward:x}=useStakingRewards();const y=useObservable(h.delegation.rewardAccounts$);const R=useObservable(null==h?void 0:h.protocolParameters$);const{coinBalance:P}=walletBalanceTransformer(null==R?void 0:R.stakeKeyDeposit.toString());const{priceResult:D}=useFetchCoinPrice();const{balance:_}=useBalances(null==D?void 0:null===(e=D.cardano)||void 0===e?void 0:e.price);const I=useAnalyticsContext();const N=useDelegationDetails();const M=y&&y[0].credentialStatus===Wallet.Cardano.StakeCredentialStatus.Registered;const V=(null==_?void 0:null===(t=_.total)||void 0===t?void 0:t.coinBalance)&&Number(null==_?void 0:null===(s=_.total)||void 0===s?void 0:s.coinBalance);const W=V<Number(P)&&!M||0===V&&M;const F=!!(y&&N);const B=!F&&isNumber(V)&&!W;const handleSearch=e=>c(null!=e?e:"");const onStakePoolSelect=e=>{E(e);C(true)};const parseStakePools=()=>{return null==p?void 0:p.pageResults.map(e=>{var t;return e?Wallet.util.stakePoolTransformer({stakePool:e,delegatingPoolId:null==N?void 0:null===(t=N.id)||void 0===t?void 0:t.toString(),cardanoCoin:r}):void 0})};useEffect(()=>{if((null==l?void 0:l.length)!==0&&(null==l?void 0:l.length)<eB)return;f({searchString:l||"",limit:ej})},[l,f,a,i]);const j=useCallback(()=>{T()},[T]);const H=useCallback(()=>{if(F){k(true);return}j();C(true)},[F,k,j,C]);const sendAnalytics=()=>{I.sendEventToPostHog(PostHogAction.StakingStakePoolClick)};return React.createElement(React.Fragment,null,React.createElement(TransitionAcknowledgmentDialog,{visible:v,onClose:toggleisTransitionAcknowledgmentDialog,title:o("browserView.onboarding.stakingTransitionAcknowledgment.title"),description:o("browserView.onboarding.stakingTransitionAcknowledgment.description"),confirmationLabel:o("browserView.onboarding.stakingTransitionAcknowledgment.iUnderstand"),storageMemoEntryName:"hideStakingHwDialog"}),React.createElement(DelegationLayout,{searchedPools:(null==l?void 0:l.length)&&!((null==l?void 0:l.length)>=eB)?[]:parseStakePools(),coinBalance:V,searchValue:l,handleSearchChange:handleSearch,handleAddFunds:d,currentStakePool:N&&Wallet.util.stakePoolTransformer({stakePool:N,cardanoCoin:r}),isLoading:S,totalRewards:Wallet.util.lovelacesToAdaString(A.toString()),lastReward:Wallet.util.lovelacesToAdaString(x.toString()),isSearching:w,hasNoFunds:W,isDelegating:F,canDelegate:B,walletAddress:null==b?void 0:b.addresses[0].address,fiat:null==D?void 0:null===(n=D.cardano)||void 0===n?void 0:n.price,onStakePoolSelect:()=>onStakePoolSelect(N),onStakePoolClick:e=>{sendAnalytics();c("");E(p.pageResults.find(t=>{var s;return(null==t?void 0:null===(s=t.id)||void 0===s?void 0:s.toString())===e}));C(true)},cardanoCoin:r}),React.createElement(StakePoolDetails,{showCloseIcon:e=>eH.has(e),showBackIcon:e=>eO.has(e),showExitConfirmation:e=>eL.has(e),canDelegate:!W,onStake:H,popupView:true}),React.createElement(StakingModals,{popupView:true}))};const DelegationContainer_DelegationContainer=()=>{const e=useMultiDelegationEnabled();return React.createElement(React.Fragment,null,e?React.createElement(MultiDelegationStakingPopup,null):React.createElement(DelegationContent,null))};var eU=s("./src/views/browser-view/features/adress-book/components/AddressBookEmpty/index.tsx");var eZ=s("./src/features/address-book/context/index.ts");var eG=s("./src/features/address-book/components/AddressDetailDrawer/index.ts");var eX=s("./src/features/address-book/store/index.tsx");var eK=s("./src/features/address-book/components/AddressBook.modules.scss");var e$=s("./src/assets/icons/delete-icon.component.svg");var eq=s("./src/assets/icons/plus-icon.svg");var eY=s("./src/features/address-book/components/AddressDetailDrawer/types/index.ts");var ez=s("./src/features/ada-handle/config.ts");const eQ="popupAddressBookContainerId";const eJ=(0,eZ.withAddressBookContext)(()=>{var e,t,s,i;const[l,c]=(0,n.useState)(false);const{list:d,count:u,utils:m}=(0,eZ.useAddressBookContext)();const{extendLimit:v,deleteRecord:g}=m;const{setIsEditAddressVisible:S,isEditAddressVisible:p,setAddressToEdit:w,addressToEdit:f}=(0,eX.useAddressBookStore)();const{t:E}=(0,r.useTranslation)();const k=(0,b.useAnalyticsContext)();const C=(0,P.useHandleResolver)();const T=(0,P.useUpdateAddressStatus)(d,C);const{onSaveAddressActions:h}=(0,P.useOnAddressSave)();const{setSection:x}=(0,Z.useSections)();const y={name:E("core.walletAddressList.name"),address:E("core.walletAddressList.address")};const onAddressSave=e=>h(e,f);var R;const D=(0,n.useMemo)(()=>{return(null==d?void 0:d.map(e=>{var t;return{id:e.id,address:e.address,name:e.name,onClick:e=>{var t;k.sendEventToPostHog(A.PostHogAction.AddressBookAddressRecordClick);w(e);if(ez.isAdaHandleEnabled&&(null===(t=T[e.address])||void 0===t?void 0:t.isValid)===false)c(true);else S(true)},isSmall:true,isAddressWarningVisible:null!==(R=ez.isAdaHandleEnabled&&(null===(t=T[e.address])||void 0===t?void 0:t.isValid)===false)&&void 0!==R&&R}}))||[]},[d,k,w,S,T]);const _=(0,n.useCallback)(()=>{v()},[v]);const handleAddAddressClick=()=>{S(true);k.sendEventToPostHog(A.PostHogAction.AddressBookAddAddressClick)};const I=(null==f?void 0:f.id)?eY.AddressDetailsSteps.DETAILS:eY.AddressDetailsSteps.CREATE;const onHandleDeleteContact=e=>{g(e,{text:E("browserView.addressBook.toast.deleteAddress"),icon:e$["default"]});w({})};var N,M;return n.createElement(n.Fragment,null,n.createElement(V.ContentLayout,{title:n.createElement("div",{className:eK["default"].title},n.createElement("h1",{"data-testid":"page-title"},E("addressBook.sectionTitle")," ",n.createElement("span",{className:eK["default"].subTitle,"data-testid":"counter"},"(",u,")"))),id:eQ},n.createElement("div",{className:eK["default"].btnContainer},n.createElement(a.Button,{"data-testid":"add-address-button",color:"gradient",block:true,onClick:handleAddAddressClick},n.createElement("img",{src:eq["default"],alt:"plus-icon"}),E("addressBook.empty.addNewAddress"))),0===u?n.createElement("div",{className:eK["default"].emptyScreen,"data-testid":"empty-address-book"},n.createElement(eU.AddressBookEmpty,null)):n.createElement("div",{className:eK["default"].listContainer,"data-testid":"address-book-list"},n.createElement(o.WalletAddressList,{scrollableTargetId:eQ,className:eK["default"].addressList,items:D,loadMoreData:_,locale:{emptyText:true},total:u,withHeader:false,popupView:true,translations:y}))),ez.isAdaHandleEnabled&&n.createElement(eG.AddressChangeDetailDrawer,{visible:l,onCancelClick:()=>{w({});c(false);x({currentSection:Z.Sections.FORM})},expectedAddress:null!==(N=null===(e=T[f.address])||void 0===e?void 0:null===(t=e.error)||void 0===t?void 0:t.expectedAddress)&&void 0!==N?N:"",actualAddress:null!==(M=null===(s=T[f.address])||void 0===s?void 0:null===(i=s.error)||void 0===i?void 0:i.actualAddress)&&void 0!==M?M:"",initialValues:f,popupView:true}),n.createElement(eG.AddressDetailDrawer,{initialStep:I,initialValues:f,onCancelClick:()=>{w({});S(false)},onConfirmClick:async e=>{await onAddressSave(e);w({})},onDelete:e=>onHandleDeleteContact(e),visible:p,popupView:true}))});var e0=s("./src/features/settings/index.ts");var e1=s("./src/views/browser-view/features/sign-message/SignMessageDrawer.tsx");var e4=s("../../node_modules/lodash/flatten.js");var e2=s.n(e4);var e5=s("../../node_modules/antd/es/skeleton/index.js");var e3=s("../../node_modules/lodash/isNil.js");var e8=s.n(e3);var e6=s("./src/features/nfts/components/Nfts.module.scss");var e7=s("./src/utils/get-token-list.ts");var e9=s("./src/assets/icons/new-folder-icon.component.svg");var te=s("./src/views/browser-view/features/nfts/components/CreateFolder/CreateFolderDrawer.tsx");var tt=s("./src/features/nfts/context/index.ts");var ts=s("./src/views/browser-view/features/nfts/components/RenameFolderDrawer.tsx");var tn=s("./src/views/browser-view/features/nfts/components/NftFolderConfirmationModal.tsx");var to=s("./src/assets/icons/remove-folder.component.svg");var ta=s("./src/hooks/useNftSearch.ts");const tr="contentLayout";const ti=10;const tl=(0,tt.withNftsFoldersContext)(()=>{const e=(0,P.useRedirection)(_.walletRoutePaths.nftDetail);const[t,s]=(0,n.useState)(false);const{environmentName:i}=(0,I.useWalletStore)();const[l,c]=(0,n.useState)();const{walletInfo:d,inMemoryWallet:u}=(0,I.useWalletStore)();const{t:m}=(0,r.useTranslation)();const v=(0,P.useAssetInfo)();const{isSearching:g,handleSearch:S,filteredResults:p}=(0,ta.useNftSearch)(v);const w=(0,a.useObservable)(u.balance.utxo.total$,eu.DEFAULT_WALLET_BALANCE.utxo.total$);const f=(0,b.useAnalyticsContext)();const{fiatCurrency:E}=(0,b.useCurrencyStore)();const[k,C]=(0,n.useState)();const[T,h]=(0,n.useState)();const[y,D]=(0,n.useState)(false);const[N,M]=(0,n.useState)(false);const{utils:{deleteRecord:W}}=(0,tt.useNftsFoldersContext)();const[F,B]=(0,n.useState)("");const[j,H]=(0,n.useState)(false);const L=(0,n.useCallback)(t=>{f.sendEventToPostHog(A.PostHogAction.NFTsImageClick);e({params:{id:t.assetId.toString()}})},[f,e]);const O=(0,n.useMemo)(()=>{const{nftList:e}=(0,e7.getTokenList)({assetsInfo:v,balance:null==w?void 0:w.assets,environmentName:i,fiatCurrency:E});return e.map(e=>({...e,type:o.NftsItemsTypes.NFT,onClick:()=>L(e)}))},[null==w?void 0:w.assets,v,i,E,L]);const U=(0,n.useCallback)((e,t)=>[{label:m("browserView.nfts.contextMenu.rename"),onClick:()=>{D(true);C({id:e,name:t})}},{label:m("browserView.nfts.contextMenu.delete"),onClick:()=>{h(e);M(true)}}],[m]);const{list:Z}=(0,tt.useNftsFoldersContext)();const G=(0,n.useMemo)(()=>{return(null==Z?void 0:Z.map(({name:e,assets:t,id:n})=>({id:n,name:e,type:o.NftsItemsTypes.FOLDER,nfts:t.map(e=>O.find(({assetId:t})=>t.toString()===e)).filter(e=>!!e),contextMenuItems:U(n,e),onClick:()=>{c(n);s(true)}})))||[]},[Z,O,U]);const X=(0,n.useMemo)(()=>G.find(({id:e})=>l===e),[l,G]);const K=e2()(null==Z?void 0:Z.map(({assets:e})=>e));const $=O.filter(({assetId:e})=>!K.includes(e));const q=[...G,...$];const Y=e8()(w)||e8()(Z);const onDeleteFolderConfirm=()=>{M(false);W(T,{text:m("browserView.nfts.deleteFolderSuccess"),icon:to["default"]})};const z=(0,n.useCallback)(()=>{s(false);c(void 0)},[]);const handleNftSearch=(e,t)=>{B(t);if(!j){f.sendEventToPostHog(A.PostHogAction.NFTsSearchType);H(true)}S(e,t)};const Q=(0,n.useRef)(null);const J=""!==F?p:q;return n.createElement(n.Fragment,null,n.createElement(V.ContentLayout,{id:tr,title:n.createElement(e5["default"],{loading:Y},n.createElement("div",{className:e6["default"].sectionTitle},n.createElement(er.SectionTitle,{classname:e6["default"].title,title:m("browserView.nfts.pageTitle"),sideText:`(${O.length})`,isPopup:true}),O.length>0&&true&&n.createElement(a.Button,{className:e6["default"].newFolderBtn,color:"gradient",onClick:()=>{s(true);f.sendEventToPostHog(A.PostHogAction.NFTsCreateFolderClick)},"data-testid":"create-folder-button"},n.createElement(e9["default"],{className:e6["default"].newFolderIcon})))),mainClassName:e6["default"].nftsLayout},n.createElement("div",{className:e6["default"].nfts},n.createElement("div",{ref:Q,className:e6["default"].content,"data-testid":"nft-list-container"},n.createElement(e5["default"],{loading:Y},q.length>0?n.createElement(n.Fragment,null,q.length>=ti&&n.createElement(x.SearchBox,{placeholder:m("browserView.nfts.searchPlaceholder"),onChange:e=>handleNftSearch(q,e),"data-testid":"nft-search-input",value:F,onClear:()=>B("")}),!g&&""!==F&&0===p.length&&n.createElement(o.ListEmptyState,{message:m("core.assetSelectorOverlay.noMatchingResult"),icon:"sad-face"})):n.createElement(R.FundWalletBanner,{title:m("browserView.nfts.fundWalletBanner.title"),prompt:m("browserView.nfts.fundWalletBanner.prompt"),walletAddress:d.addresses[0].address.toString()})),n.createElement(o.NftGrid,{columns:2,scrollableTargetId:tr,items:Y?[]:J,gridClassName:e6["default"].grid}))),n.createElement(te.NFTFolderDrawer,{selectedFolder:X,onSelectNft:L,visible:t,onClose:z,isPopupView:true}),n.createElement(ts.RenameFolderDrawer,{folderToRename:k,visible:y,onClose:()=>D(false),isPopupView:true})),n.createElement(tn.NftFolderConfirmationModal,{onCancel:()=>M(false),visible:N,title:m("browserView.nfts.deleteFolderModal.header"),description:n.createElement(n.Fragment,null,n.createElement("div",null,m("browserView.nfts.deleteFolderModal.description1")),n.createElement("div",{className:"mt-3"},m("browserView.nfts.deleteFolderModal.description2"))),actions:[{body:m("browserView.nfts.deleteFolderModal.cancel"),dataTestId:"delete-folder-modal-cancel",color:"secondary",onClick:()=>M(false)},{dataTestId:"delete-folder-modal-confirm",onClick:onDeleteFolderConfirm,body:m("browserView.nfts.deleteFolderModal.confirm")}]}))});var tc=s("../../node_modules/react-router/esm/react-router.js");var td=s("./src/views/browser-view/features/nfts/selectors.ts");var tu=s("./src/hooks/useEnterKeyPress.ts");function NftDetail_extends(){NftDetail_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return NftDetail_extends.apply(this,arguments)}const tm=(0,tt.withNftsFoldersContext)(()=>{var e;const{inMemoryWallet:t,walletUI:{appMode:s}}=(0,I.useWalletStore)();const{t:i}=(0,r.useTranslation)();const l=(0,b.useAnalyticsContext)();const{setAvatar:c}=(0,P.useWalletAvatar)();const d=(0,P.useRedirection)(_.walletRoutePaths.nfts);const u=(0,P.useRedirection)(_.walletRoutePaths.send);const{id:m}=(0,tc.useParams)();const v=(0,P.useAssetInfo)();const g=(0,Z.useOutputInitialState)();const S=ef.Wallet.Cardano.AssetId(m);const p=null==v?void 0:v.get(S);const w=(0,a.useObservable)(t.balance.utxo.total$,eu.DEFAULT_WALLET_BALANCE.utxo.total$);const f=(null==w?void 0:null===(e=w.assets)||void 0===e?void 0:e.get(S))||BigInt(1);const E=(0,n.useMemo)(()=>ef.Wallet.util.calculateAssetBalance(f,p),[p,f]);const handleOpenSend=()=>{l.sendEventToPostHog(A.PostHogAction.SendClick,{trigger_point:Z.SendFlowTriggerPoints.NFTS});g(m,eu.SEND_NFT_DEFAULT_AMOUNT);u({params:{id:m}})};const handleSetAsAvatar=e=>{c(e);a.toast.notify({text:i("core.nftDetail.avatarUpdated")});l.sendEventToPostHog(A.PostHogAction.NFTDetailSetAsAvatarClick)};return n.createElement(a.Drawer,{popupView:true,className:e6["default"].drawer,visible:true,navigation:n.createElement(a.DrawerNavigation,{onArrowIconClick:()=>d()}),dataTestId:"nft-details-drawer",footer:n.createElement("div",{className:e6["default"].footer},n.createElement(a.Button,{id:tu.buttonIds.nftDetailsBtnId,className:e6["default"].sendBtn,onClick:handleOpenSend},i("core.nftDetail.sendNFT")))},p&&n.createElement(o.NftDetail,NftDetail_extends({},(0,td.nftDetailSelector)(p),{isPopup:s===eu.APP_MODE_POPUP,amount:E,title:n.createElement("h2",{className:e6["default"].secondaryTitle},(0,td.nftNameSelector)(p)),onSetAsAvatar:handleSetAsAvatar})))});var tv=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/voting-beta/components/Voting.module.scss");var tg={};tg.styleTagTransform=f();tg.setAttributes=g();tg.insert=m().bind(null,"head");tg.domAPI=d();tg.insertStyleElement=p();var tS=l()(tv["default"],tg);const tp=tv["default"]&&tv["default"].locals?tv["default"].locals:void 0;var tw=s("./src/views/browser-view/features/voting-beta/components/VotingCenterBanner/index.ts");const Voting_Voting=()=>{const e=useExternalLinkOpener();const{environmentName:t}=useWalletStore();const{GOV_TOOLS_URLS:s}=config();const n=useAnalyticsContext();const o=useCallback(async t=>{await n.sendEventToPostHog(PostHogAction.VotingBannerButtonClick);e(t)},[n,e]);return React.createElement(ContentLayout,null,React.createElement("div",{className:styles.activitiesContainer},React.createElement("div",{className:styles.emptyState},React.createElement(VotingCenterBanner,{openExternalLink:o,govToolUrl:s[t],popupView:true}))))};const{GOV_TOOLS_URLS:tf}=(0,eS.config)();const ExtensionRoutes_ExtensionRoutes=()=>{const{isSharedWallet:e,environmentName:t}=useWalletStore();const s=!!tf[t];return React.createElement(MainLayout,null,React.createElement(Switch,null,React.createElement(Route,{exact:true,path:walletRoutePaths.assets,component:PopupAssets}),React.createElement(Route,{exact:true,path:walletRoutePaths.receive,component:ReceiveInfoContainer}),React.createElement(Route,{exact:true,path:walletRoutePaths.activity,component:Activity}),React.createElement(Route,{exact:true,path:walletRoutePaths.send,component:Send}),React.createElement(Route,{exact:true,path:walletRoutePaths.nftDetail,component:NftDetail}),!e&&React.createElement(Route,{exact:true,path:walletRoutePaths.earn,component:DelegationContainer}),React.createElement(Route,{exact:true,path:walletRoutePaths.addressBook,component:AddressBook}),React.createElement(Route,{exact:true,path:walletRoutePaths.settings,component:Settings}),React.createElement(Route,{exact:true,path:walletRoutePaths.signMessage,component:SignMessageDrawer}),React.createElement(Route,{exact:true,path:walletRoutePaths.nfts,component:Nfts}),s&&React.createElement(Route,{exact:true,path:walletRoutePaths.voting,component:Voting}),React.createElement(Route,{path:"*",render:()=>React.createElement(Redirect,{to:walletRoutePaths.assets})})),React.createElement(StakingWarningModals,{popupView:true}))};var tE=s("./src/providers/AppSettings/index.ts");var tk=s("./src/features/unlock-wallet/index.ts");var tC=s("../../node_modules/dayjs/dayjs.min.js");var tT=s.n(tC);var th=s("../../node_modules/dayjs/plugin/duration.js");var tb=s.n(th);var tA=s("./src/utils/local-storage.ts");var tx=s("./src/components/MainLoader/index.ts");var ty=s("./src/hooks/useFatalError.ts");var tR=s("./src/components/ErrorBoundary/index.ts");tT().extend(tb());const isLastValidationExpired=(e,t)=>{const s=dayjs(Number(e));const n=s.add(dayjs.duration({days:Number(t)}));return n.isBefore(dayjs())};const PopupView=()=>{const{cardanoWallet:e,walletDisplayInfo:t,inMemoryWallet:s,currentChain:n,walletInfo:o,isWalletLocked:a,walletLock:r,walletState:i,initialHdDiscoveryCompleted:l}=useWalletStore();const[{lastMnemonicVerification:c,mnemonicVerificationFrequency:d,chainName:u}]=useAppSettingsContext();const m=useBackgroundServiceAPIContext();useAppInit();useEnterKeyPress();useEffect(()=>{const t=getValueFromLocalStorage("isForgotPasswordFlow");if(null===e&&!a()&&!t)null==m?void 0:m.handleOpenBrowser({section:BrowserViewSections.HOME}).then(()=>window.close())},[a,m,n,u,e]);const v=useFatalError();const g=useMemo(()=>!!e&&!!t&&o&&i&&s&&l,[e,o,i,s,l,t]);useEffect(()=>{if(g||v)removePreloaderIfExists()},[g,v]);const checkMnemonicVerificationFrequency=()=>d&&isLastValidationExpired(c,d);if(v){return React.createElement(Crash,null)}if(checkMnemonicVerificationFrequency()&&r){return React.createElement(UnlockWalletContainer,{validateMnemonic:true})}if(a()){return React.createElement(UnlockWalletContainer,null)}if(g){return React.createElement(ExtensionRoutes,null)}return React.createElement(MainLoader,null)}},"./src/stores/selectors/index.ts":(e,t,s)=>{s.d(t,{useSyncStatus:()=>o.useSyncStatus});var n=s("./src/stores/selectors/staking-selectors.ts");var o=s("./src/stores/selectors/sync-status-selector.ts")},"./src/stores/slices/activity-detail-slice.ts":(e,t,s)=>{s.d(t,{activityDetailSlice:()=>activityDetailSlice});var n=s("../../node_modules/lodash/isEmpty.js");var o=s.n(n);var a=s("./src/api/transformers.ts");var r=s("../../packages/cardano/dist/index.esm.js");var i=s("./src/utils/get-transaction-total-output.ts");var l=s("./src/utils/tx-inspection.ts");var c=s("../../node_modules/rxjs/dist/esm5/internal/firstValueFrom.js");var d=s("./src/utils/get-assets-information.ts");var u=s("../../packages/staking/dist/index.js");var m=s.n(u);var v=s("../../packages/core/dist/index.esm.js");var g=s("./src/utils/format-date.ts");var S=s("../../node_modules/@cardano-sdk/core/dist/esm/util/transactionSummaryInspector.js");var p=s("./src/utils/phase2-validation.ts");var w=s("./src/utils/era-slot-datetime.ts");var f=s("../../packages/common/dist/index.esm.js");const isConfirmedTransaction=e=>void 0!==e.blockHeader;const getTransactionAssetsId=(e,t)=>{const s=new Set;var n;const o=null!==(n=e.map(e=>e.value.assets))&&void 0!==n?n:[];if((null==t?void 0:t.size)>0)o.push(t);for(const a of o)if(a){for(const r of a.keys())s.has(r)||s.add(r)}return[...s.values()]};const transactionMetadataTransformer=e=>[...e.entries()].map(([e,t])=>({key:e.toString(),value:r.Wallet.cardanoMetadatumToObj(t)}));const shouldIncludeFee=(e,t,s)=>{if((0,p.hasPhase2ValidationFailed)(e)){return false}return!(t===v.DelegationActivityType.delegationRegistration||t===v.ConwayEraCertificatesTypes.Registration||(t===v.DelegationActivityType.delegationDeregistration||t===v.ConwayEraCertificatesTypes.Unregistration)&&!!(null==s?void 0:s.length))};const E=new Map;const getPoolInfos=async(e,t)=>{const s=[...e];const n=[];for(const o of e){const a=E.get(o);if(a){n.push(a);s.splice(s.indexOf(o),1)}}if(s.length>0){const r={filters:{identifier:{_condition:"or",values:s.map(e=>({id:e}))}},pagination:{startAt:0,limit:u.MAX_POOLS_COUNT}};const{pageResults:i}=await t.queryStakePools(r);i.forEach(e=>E.set(e.id,e));n.push(...i)}return n};const computeCollateral=async({addresses:e},t,s)=>await (0,S.getCollateral)(t,s,e.map(e=>e.address));const buildGetActivityDetail=({set:e,get:t})=>{return async({coinPrices:s,fiatCurrency:n})=>{var u,m,S;const{blockchainProvider:{chainHistoryProvider:p,stakePoolProvider:E,assetProvider:k,inputResolver:C},inMemoryWallet:T,activityDetail:h,walletInfo:b,walletState:A}=t();e({fetchingActivityInfo:true});if(h.type===v.TransactionActivityType.rewards){var x;const{activity:y,status:R,type:P}=h;const D=y.rewards.map(({poolId:e})=>e).filter(e=>!!e);const _=await getPoolInfos(D,E);e({fetchingActivityInfo:false});return{activity:{includedUtcDate:(0,g.formatDate)({date:y.spendableDate,format:"MM/DD/YYYY",type:"utc"}),includedUtcTime:`${(0,g.formatTime)({date:y.spendableDate,type:"utc"})} UTC`,rewards:{totalAmount:r.Wallet.util.lovelacesToAdaString(r.Wallet.BigIntMath.sum((null===(x=y.rewards)||void 0===x?void 0:x.map(({rewards:e})=>e))||[]).toString()),spendableEpoch:y.spendableEpoch,rewards:y.rewards.map(e=>{var t,s;const n=_.find(t=>t.id===e.poolId);return{amount:r.Wallet.util.lovelacesToAdaString(e.rewards.toString()),pool:e.poolId?{id:e.poolId,name:(null==n?void 0:null===(t=n.metadata)||void 0===t?void 0:t.name)||"-",ticker:(null==n?void 0:null===(s=n.metadata)||void 0===s?void 0:s.ticker)||"-"}:void 0}})}},status:R,type:P}}const{activity:I,status:N,type:M,direction:V}=h;const W=await (0,c.firstValueFrom)(T.assetInfo$);const F=await (0,c.firstValueFrom)(T.protocolParameters$);const B=getTransactionAssetsId(I.body.outputs);const j=await (0,d.getAssetsInformation)(B,W,{assetProvider:k,extraData:{nftMetadata:true,tokenMetadata:true}});const H=await (0,l.inspectTxValues)({addresses:b.addresses,tx:I,direction:V});const L=(null==H?void 0:null===(u=H.assets)||void 0===u?void 0:u.size)||0;const O=L+1;const U=await r.Wallet.getTxInputsValueAndAddress(I.body.inputs,p,T);const Z=U.map(e=>(0,a.inputOutputTransformer)(e,j,s,n));const G=I.body.outputs.map(e=>(0,a.inputOutputTransformer)(e,j,s,n));const X=(0,i.getTransactionTotalOutput)(I.body.outputs).minus(I.body.fee.toString());const K=r.Wallet.util.lovelacesToAdaString(X.toString());const $=o()(null===(m=I.auxiliaryData)||void 0===m?void 0:m.blob)?void 0:transactionMetadataTransformer(I.auxiliaryData.blob);const q=r.Wallet.Cardano.util.computeImplicitCoin(F,I.body);const Y=q.deposit&&(M===v.DelegationActivityType.delegationRegistration||M===v.ConwayEraCertificatesTypes.Registration)?r.Wallet.util.lovelacesToAdaString(q.deposit.toString()):void 0;const z=r.Wallet.util.calculateDepositReclaim(q);const Q=z&&(M===v.DelegationActivityType.delegationDeregistration||M===v.ConwayEraCertificatesTypes.Unregistration)?r.Wallet.util.lovelacesToAdaString(z.toString()):void 0;const J=r.Wallet.util.lovelacesToAdaString(I.body.fee.toString());const ee=await computeCollateral(A,I,C);const et=ee>0?r.Wallet.util.lovelacesToAdaString(ee.toString()):void 0;const es=null===(S=I.body.certificates)||void 0===S?void 0:S.filter(e=>e.__typename===r.Wallet.Cardano.CertificateType.StakeDelegation);let en;let eo;if(isConfirmedTransaction(I)){var ea;const er=await (0,c.firstValueFrom)(T.eraSummaries$);const ei=(0,w.eraSlotDateTime)(er,null===(ea=I.blockHeader)||void 0===ea?void 0:ea.slot);en=ei.utcDate;eo=ei.utcTime}let el={hash:I.id.toString(),totalOutput:K,fee:shouldIncludeFee(I,M,es)?J:void 0,deposit:Y,depositReclaim:Q,addrInputs:Z,addrOutputs:G,metadata:$,includedUtcDate:en,includedUtcTime:eo,collateral:et,votingProcedures:I.body.votingProcedures,proposalProcedures:I.body.proposalProcedures,certificates:I.body.certificates};if(M===v.DelegationActivityType.delegation&&es){const ec=await getPoolInfos(es.map(({poolId:e})=>e),E);if(0===ec.length)f.logger.error("Stake pool was not found for delegation tx");else el={...el,pools:ec.map(e=>{var t,s;return{name:(null===(t=e.metadata)||void 0===t?void 0:t.name)||"-",ticker:(null===(s=e.metadata)||void 0===s?void 0:s.ticker)||"-",id:e.id.toString()}})}}e({fetchingActivityInfo:false});return{activity:el,status:N,assetAmount:O,type:M}}};const activityDetailSlice=({set:e,get:t})=>({activityDetail:void 0,fetchingActivityInfo:true,getActivityDetail:buildGetActivityDetail({set:e,get:t}),setTransactionActivityDetail:({activity:t,direction:s,status:n,type:o})=>e({activityDetail:{activity:t,direction:s,status:n,type:o}}),setRewardsActivityDetail:({activity:t})=>e({activityDetail:{activity:t,status:v.ActivityStatus.SPENDABLE,type:v.TransactionActivityType.rewards}}),resetActivityState:()=>e({activityDetail:void 0,fetchingActivityInfo:false})})},"./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Footer.tsx":(e,t,s)=>{s.d(t,{Footer:()=>M});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/react-i18next/dist/es/index.js");var a=s("../../packages/common/dist/index.esm.js");var r=s("../../packages/cardano/dist/index.esm.js");var i=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Footer.module.scss");var l=s("./src/assets/icons/edit.component.svg");var c=s("./src/assets/icons/delete-icon.component.svg");var d=s("./src/views/browser-view/features/send-transaction/types.ts");var u=s("./src/views/browser-view/features/send-transaction/store/index.ts");var m=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.tsx");var v=s("./src/stores/index.ts");var g=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/AddressFormFooter.tsx");var S=s("./src/views/browser-view/features/send-transaction/constants.ts");var p=s("./src/hooks/index.ts");var w=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var f=s("./src/hooks/useEnterKeyPress.ts");var E=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/AssetPickerFooter.tsx");var k=s("./src/views/browser-view/features/send-transaction/helpers.ts");var C=s("./src/features/address-book/components/AddressActionsModal.tsx");var T=s("./src/features/address-book/store/index.tsx");var h=s("./src/features/address-book/context/index.ts");var b=s("./src/utils/validators/index.ts");var A=s("./src/providers/index.ts");var x=s("./src/providers/AnalyticsProvider/onChain.ts");var y=s("./src/lib/wallet-api-ui.ts");var R=s("../../node_modules/@cardano-sdk/core/dist/esm/Serialization/Transaction.js");var P=s("../../packages/core/dist/index.esm.js");var D=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/types.js");var _=s("./src/utils/parse-error.ts");var I=s("./src/lib/scripts/background/util.ts");const N={[d.Sections.FORM]:"browserView.transaction.send.footer.review",[d.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON]:"browserView.transaction.send.coSign.footer.continue",[d.Sections.SUMMARY]:"browserView.transaction.send.footer.confirm",[d.Sections.CONFIRMATION]:"browserView.transaction.send.footer.confirm",[d.Sections.SUCCESS_TX]:"browserView.transaction.send.footer.viewTransaction",[d.Sections.FAIL_TX]:"browserView.transaction.send.footer.fail",[d.Sections.UNAUTHORIZED_TX]:"browserView.transaction.send.footer.unauthorized",[d.Sections.ADDRESS_FORM]:"browserView.transaction.send.footer.save",[d.Sections.ADDRESS_CHANGE]:"addressBook.reviewModal.confirmUpdate.button"};const hasTempTxData=()=>{const{tempOutputs:e,tempAddress:t}=(0,k.getTemporaryTxDataFromStorage)();return null!==e||null!==t};const M=(0,h.withAddressBookContext)(({isPopupView:e,openContinueDialog:t,onHandleChangeConfirm:s})=>{const M=(0,n.useRef)();const triggerSubmit=()=>{var e;return null===(e=M.current)||void 0===e?void 0:e.click()};const{t:V}=(0,o.useTranslation)();const{triggerPoint:W}=(0,u.useAnalyticsSendFlowTriggerPoint)();const{hasInvalidOutputs:F}=(0,u.useTransactionProps)();const{builtTxData:B,setBuiltTxData:j}=(0,u.useBuiltTxState)();const{setSection:H,currentSection:L}=(0,u.useSections)();const{setSubmitingTxState:O,isSubmitingTx:U,isPasswordValid:Z}=(0,u.useSubmitingState)();const{inMemoryWallet:G,isInMemoryWallet:X,walletType:K,isSharedWallet:$,currentChain:q}=(0,v.useWalletStore)();const{password:Y,clearSecrets:z}=(0,P.useSecrets)();const[Q]=(0,u.useMetadata)();const{onClose:J,onCloseSubmitedTransaction:ee}=(0,m.useHandleClose)();const et=(0,A.useAnalyticsContext)();const es=(0,p.useNetwork)();const[en,eo]=(0,n.useState)();const[ea,er]=(0,n.useState)();const{addressToEdit:ei}=(0,T.useAddressBookStore)();const{list:el,utils:ec}=(0,h.useAddressBookContext)();const{updateRecord:ed,deleteRecord:eu}=ec;const em=(0,p.useHandleResolver)();const{walletRepository:ev}=(0,p.useWalletManager)();const eg=(0,a.useObservable)(ev.wallets$);const eS=(0,p.useCurrentWallet)();const ep=(0,I.getParentWalletCIP1854Account)({wallets:eg,activeWallet:eS});const ew=null==ep?void 0:ep.extendedAccountPublicKey;const ef=(0,P.useSignPolicy)(eS,"payment");const eE=L.currentSection===d.Sections.SUMMARY;const sendEventToPostHog=e=>et.sendEventToPostHog(e,{trigger_point:W,[w.TX_CREATION_TYPE_KEY]:w.TxCreationType.Internal});const ek=(0,n.useCallback)(()=>{switch(L.currentSection){case d.Sections.FORM:{const e=$?"SharedWalletsSendTxDataReviewTxClick":"SendTransactionDataReviewTransactionClick";sendEventToPostHog(w.PostHogAction[e]);break}case d.Sections.SUMMARY:{const t=$?"SharedWalletsSendTxSummaryConfirmClick":"SendTransactionSummaryConfirmClick";B.importedSharedWalletTx?sendEventToPostHog(w.PostHogAction.SharedWalletsCosignTxSummaryConfirmClick):sendEventToPostHog(w.PostHogAction[t]);break}case d.Sections.CONFIRMATION:{const s=$?"SharedWalletsSendTxConfirmationConfirmClick":"SendTransactionConfirmationConfirmClick";B.importedSharedWalletTx?sendEventToPostHog(w.PostHogAction.SharedWalletsCosignTxConfirmationClick):sendEventToPostHog(w.PostHogAction[s]);break}case d.Sections.SUCCESS_TX:{const n=$?"SharedWalletsSendAllDoneViewTxClick":"SendAllDoneViewTransactionClick";sendEventToPostHog(w.PostHogAction[n]);break}case d.Sections.UNAUTHORIZED_TX:case d.Sections.FAIL_TX:{const o=$?"SharedWalletsSendSomethingWentWrongBackClick":"SendSomethingWentWrongBackClick";sendEventToPostHog(w.PostHogAction[o]);break}case d.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON:sendEventToPostHog(w.PostHogAction.SharedWalletsCosignTxContinueClick);break}},[L.currentSection,e,$]);const eC=(0,n.useCallback)(e=>{const t=el.find(e=>e.address===ei.address);eo(t.id);er(e);ek()},[el,ei.address,ek]);const onHandleCancel=()=>{eo(null)};const onHandleConfirm=async()=>{eo(null);if("DELETE"===ea)eu(en,{text:V("browserView.addressBook.toast.deleteAddress"),icon:c["default"]});else{const e=await (0,b.getAddressToSave)({address:ei,handleResolver:em});await ed(en,e,{text:V("browserView.addressBook.toast.editAddress"),icon:l["default"]})}s(ea)};const eT=eE&&!X&&!$;const eh=(0,n.useCallback)(async()=>{if($){let e;try{if(B.importedSharedWalletTx){e=R.Transaction.fromCbor(await G.addSignatures({tx:B.importedSharedWalletTx.toCbor()}));B.importedSharedWalletTx.setWitnessSet(e.witnessSet())}else{const{auxiliaryData:t,body:s,hash:n}=await B.tx.inspect();const o=await G.finalizeTx({tx:{body:s,hash:n},auxiliaryData:t});e=R.Transaction.fromCore(o)}}catch(r){a.logger.error("Shared wallet TX sign error",r);j({...B,error:(0,_.parseError)(r)});throw r}const i=(null==ef?void 0:ef.requiredCosigners)===e.toCore().witness.signatures.size;if(i){try{await G.submitTx(e.toCbor())}catch(l){a.logger.error("Shared wallet TX submit error",l);j({...B,error:(0,_.parseError)(l)});throw l}}else{await (0,P.exportMultisigTransaction)({cborHex:e.toCbor(),publicKey:ew,chainId:q})}j({...B,collectedEnoughSharedWalletTxSignatures:i})}else{let c;try{c=await B.tx.sign();await G.submitTx(c)}catch(d){a.logger.error("TX submit error",d);j({...B,error:(0,_.parseError)(d)});throw d}x.txSubmitted$.next({id:c.tx.id.toString(),date:new Date().toString(),creationType:w.TxCreationType.Internal})}},[B,q,G,$,null==ef?void 0:ef.requiredCosigners,j,ew]);const eb=(0,n.useCallback)(async e=>{if(U)return;O({isPasswordValid:true,isSubmitingTx:true});try{await (0,y.withSignTxConfirmation)(eh,e.value);H({currentSection:d.Sections.SUCCESS_TX});O({isPasswordValid:true,isSubmitingTx:false})}catch(t){if(t instanceof r.Wallet.KeyManagement.errors.AuthenticationError)if(eT){H({currentSection:d.Sections.UNAUTHORIZED_TX});O({isSubmitingTx:false})}else{O({isPasswordValid:false,isSubmitingTx:false})}else{H({currentSection:d.Sections.FAIL_TX});O({isSubmitingTx:false})}}finally{z()}},[U,z,H,O,eh,eT]);(0,n.useEffect)(()=>{var e;const t=[D.WalletType.Ledger,D.WalletType.Trezor].includes(K);if(!t||"function"!=typeof(null==navigator?void 0:null===(e=navigator.hid)||void 0===e?void 0:e.addEventListener))return()=>void 0;const onHardwareWalletDisconnect=e=>{if(e.device.opened){H({currentSection:d.Sections.FAIL_TX});O({isSubmitingTx:false})}};navigator.hid.addEventListener("disconnect",onHardwareWalletDisconnect);return()=>{navigator.hid.removeEventListener("disconnect",onHardwareWalletDisconnect)}},[H,O,e,K]);const eA=(0,n.useCallback)(s=>{ek();const n=L.currentSection===d.Sections.CONFIRMATION;const o=L.currentSection===d.Sections.SUCCESS_TX;const a=L.currentSection===d.Sections.FAIL_TX||L.currentSection===d.Sections.UNAUTHORIZED_TX;const r=L.currentSection===d.Sections.ADDRESS_CHANGE;if(hasTempTxData())(0,k.clearTemporaryTxDataFromStorage)();switch(true){case r:return eC("UPDATE");case eE&&!X&&!$:if(e){return t()}return eb(s);case n:return eb(s);case o:return setTimeout(()=>ee(),300);case a:O({isPasswordValid:true});return H(S.sectionsConfig[d.Sections.FORM]);default:return H()}},[L.currentSection,eC,eb,X,e,$,eE,ee,t,ek,H,O]);const handleClose=()=>{switch(L.currentSection){case d.Sections.SUCCESS_TX:{const e=$?"SharedWalletsSendAllDoneCloseClick":"SendAllDoneCloseClick";sendEventToPostHog(w.PostHogAction[e]);break}case d.Sections.FAIL_TX:{const t=$?"SharedWalletsSendSomethingWentWrongCancelClick":"SendSomethingWentWrongCancelClick";sendEventToPostHog(w.PostHogAction[t]);break}case d.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON:sendEventToPostHog(w.PostHogAction.SharedWalletsCosignTxCancelClick);break;case d.Sections.SUMMARY:sendEventToPostHog(w.PostHogAction.SharedWalletsCosignTxSummaryCancelClick);break}setTimeout(()=>{J()},300)};const ex=(0,n.useMemo)(()=>{return!B.importedSharedWalletTx&&(!B.tx||F)||(null==Q?void 0:Q.length)>S.METADATA_MAX_LENGTH},[B.importedSharedWalletTx,B.tx,F,null==Q?void 0:Q.length]);const ey=(0,n.useMemo)(()=>L.currentSection===d.Sections.CONFIRMATION&&(U||!Z||!Y.value||!es),[L.currentSection,U,Z,Y.value,es]);const eR=(0,n.useMemo)(()=>{if(eT){const t=e?V("browserView.transaction.send.footer.continueInAdvancedView"):V("browserView.transaction.send.footer.confirmWithDevice",{hardwareWallet:K});return U?V("browserView.transaction.send.footer.signing"):t}if($&&L.currentSection===d.Sections.SUCCESS_TX){return V("general.button.view-co-signers")}return V(N[L.currentSection])},[eT,$,L.currentSection,V,e,K,U]);const eP=(0,n.useMemo)(()=>{if(L.currentSection===d.Sections.SUCCESS_TX){return V("browserView.transaction.send.footer.close")}if(L.currentSection===d.Sections.ADDRESS_CHANGE){return V("addressBook.reviewModal.cancelUpdate.button")}return V("browserView.transaction.send.footer.cancel")},[V,L.currentSection]);const eD=(ex||ey)&&L.currentSection!==d.Sections.ADDRESS_CHANGE;const e_=(0,n.useCallback)(()=>{triggerSubmit()},[]);(0,n.useEffect)(()=>{const cleanup=()=>{if(hasTempTxData())(0,k.clearTemporaryTxDataFromStorage)()};if(e)return cleanup;if(U)return cleanup;if(eD)return cleanup;const{tempSource:t}=(0,k.getTemporaryTxDataFromStorage)();if(hasTempTxData()&&"hardware-wallet"===t)e_()},[eD,eT,e,U,e_]);if([d.Sections.ADDRESS_LIST,d.Sections.ADDRESS_FORM].includes(L.currentSection))return null;if(L.currentSection===d.Sections.ASSET_PICKER)return n.createElement(E.AssetPickerFooter,null);if(L.currentSection===d.Sections.ADDRESS_FORM)return n.createElement(g.AddressFormFooter,null);return n.createElement(n.Fragment,null,n.createElement("div",{className:i["default"].footer},n.createElement(a.Button,{size:"large",block:true,disabled:eD,loading:U,onClick:()=>eA(Y),ref:M,id:f.buttonIds.sendNextBtnId,"data-testid":"send-next-btn"},eR),n.createElement(a.Button,{color:"secondary",size:"large",block:true,onClick:L.currentSection===d.Sections.ADDRESS_CHANGE?()=>eC("DELETE"):handleClose,"data-testid":"send-cancel-btn"},eP)),n.createElement(C.AddressActionsModal,{action:ea,onCancel:onHandleCancel,onConfirm:onHandleConfirm,visible:!!en,isPopup:e}))})},"./src/views/browser-view/features/staking/components/StakingModals/StakingModals.tsx":(e,t,s)=>{var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/react-i18next/dist/es/index.js");var a=s("./src/views/browser-view/stores/index.ts");var r=s("./src/views/browser-view/components/Drawer/DrawerUIContent.tsx");var i=s("./src/views/browser-view/features/staking/store/index.ts");var l=s("./src/views/browser-view/features/staking/types/index.ts");var c=s("./src/views/browser-view/features/staking/components/StakingModals/StakingModal.tsx");var d=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var u=s("./src/providers/index.ts");var m=s("../../packages/common/dist/index.esm.js");const StakingModals=({popupView:e})=>{const{t}=useTranslation();const{isNoFundsVisible:s,setNoFundsVisible:n,isExitStakingVisible:o,setExitStakingVisible:a,setStakeConfirmationVisible:r,isStakeConfirmationVisible:i,setIsDrawerVisible:l,setSection:c,resetStates:d}=useStakePoolDetails();const[,u]=useDrawer();const m=useAnalyticsContext();return React.createElement(React.Fragment,null,React.createElement(StakingModal,{visible:i,title:t("browserView.staking.details.switchingPoolsModal.title"),description:t("browserView.staking.details.switchingPoolsModal.description"),actions:[{body:t("browserView.staking.details.switchingPoolsModal.buttons.cancel"),dataTestId:"switch-pools-modal-cancel",color:"secondary",onClick:()=>r(false)},{dataTestId:"switch-pools-modal-confirm",onClick:()=>{m.sendEventToPostHog(PostHogAction.StakingSwitchingPoolFineByMeClick);r(false);c(sectionsConfig[Sections.CONFIRMATION]);l(true)},body:t("browserView.staking.details.switchingPoolsModal.buttons.confirm")}],popupView:e}),React.createElement(StakingModal,{visible:o,title:t("browserView.staking.details.exitStakingModal.title"),description:t("browserView.staking.details.exitStakingModal.description"),actions:[{body:t("browserView.staking.details.exitStakingModal.buttons.cancel"),dataTestId:"exit-staking-modal-cancel",onClick:()=>a(false),color:"secondary"},{body:t("browserView.staking.details.exitStakingModal.buttons.confirm"),dataTestId:"exit-staking-modal-confirm",onClick:()=>{a(false);l(false);d()}}],popupView:e}),React.createElement(StakingModal,{visible:s,title:t("browserView.staking.details.noFundsModal.title"),description:t("browserView.staking.details.noFundsModal.description"),actions:[{body:t("browserView.staking.details.noFundsModal.buttons.cancel"),dataTestId:"no-funds-modal-cancel",onClick:()=>n(false),color:"secondary"},{body:t("browserView.staking.details.noFundsModal.buttons.confirm"),dataTestId:"no-funds-modal-confirm",onClick:()=>{n(false);u({content:DrawerContent.RECEIVE_TRANSACTION,renderHeader:()=>React.createElement(DrawerNavigation,{title:t("qrInfo.receive"),onCloseIconClick:()=>u()}),renderTitle:()=>React.createElement(DrawerHeader,{title:t("qrInfo.title"),subtitle:t("qrInfo.scanQRCodeToConnectWallet")})});l(false)}}],popupView:e}))}},"./src/views/browser-view/features/staking/types/index.ts":(e,t,s)=>{s.d(t,{Sections:()=>n.Sections,StakingErrorType:()=>n.StakingErrorType});var n=s("./src/views/browser-view/features/staking/types/stakingStore.ts")}}]);
//# sourceMappingURL=263.js.map